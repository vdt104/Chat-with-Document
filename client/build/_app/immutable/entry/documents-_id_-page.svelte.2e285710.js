var tr=Object.defineProperty;var er=(x,t,e)=>t in x?tr(x,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):x[t]=e;var Dt=(x,t,e)=>(er(x,typeof t!="symbol"?t+"":t,e),e),he=(x,t,e)=>{if(!t.has(x))throw TypeError("Cannot "+e)};var z=(x,t,e)=>(he(x,t,"read from private field"),e?e.call(x):t.get(x)),ft=(x,t,e)=>{if(t.has(x))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(x):t.set(x,e)},vt=(x,t,e,r)=>(he(x,t,"write to private field"),r?r.call(x,e):t.set(x,e),e),se=(x,t,e,r)=>({set _(s){vt(x,t,s,e)},get _(){return z(x,t,r)}}),gt=(x,t,e)=>(he(x,t,"access private method"),e);import{S as SvelteComponent,i as init,s as safe_not_equal,k as element,l as claim_element,m as children,h as detach,n as attr,p as set_style,b as insert_hydration,E as append_hydration,C as noop,o as onMount,Y as onDestroy,w as binding_callbacks,I as destroy_each,a as space,c as claim_space,q as text,r as claim_text,u as set_data,e as empty,g as transition_in,d as transition_out,y as create_component,z as claim_component,A as mount_component,B as destroy_component}from"../chunks/index.b8ab26f5.js";import{b as beforeNavigate}from"../chunks/navigation.3574d0e5.js";import{r as resetAll,C as ChatPanel,s as sendMessage}from"../chunks/ChatPanel.6a2381c2.js";import{b as getAugmentedNamespace,c as commonjsGlobal,d as getDefaultExportFromCjs}from"../chunks/axios.44236252.js";function commonjsRequire(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(t,e){module.exports=e()})(globalThis,()=>(()=>{var __webpack_modules__=[,(x,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMode=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=at,t.bytesToString=W,t.createPromiseCapability=wt,t.createValidAbsoluteUrl=O,t.getModificationDate=yt,t.getVerbosityLevel=J,t.info=ct,t.isArrayBuffer=mt,t.isArrayEqual=At,t.objectFromMap=A,t.objectSize=P,t.setVerbosityLevel=lt,t.shadow=D,t.string32=v,t.stringToBytes=n,t.stringToPDFString=ht,t.stringToUTF8String=st,t.unreachable=pt,t.utf8StringToString=dt,t.warn=et;const e=[1,0,0,1,0,0];t.IDENTITY_MATRIX=e;const r=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=r;const s=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=s;const i=1.35;t.LINE_FACTOR=i;const p=.35;t.LINE_DESCENT_FACTOR=p;const g=p/i;t.BASELINE_FACTOR=g;const m={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=m;const C={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=C;const b="pdfjs_internal_editor_";t.AnnotationEditorPrefix=b;const M={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};t.AnnotationEditorType=M;const S={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};t.AnnotationEditorParamsType=S;const d={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=d;const f={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=f;const c={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=c;const a={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=a;const o={MARKED:"Marked",REVIEW:"Review"};t.AnnotationStateModelType=o;const R={MARKED:"Marked",UNMARKED:"Unmarked"};t.AnnotationMarkedState=R;const L={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};t.AnnotationReviewState=L;const F={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=F;const u={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=u;const w={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=w;const y={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=y;const l={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=l;const h={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=h;const I={O:"PageOpen",C:"PageClose"};t.PageActionEventType=I;const k={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=k;const T={NONE:0,BINARY:1};t.CMapCompressionType=T;const U={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=U;const _={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=_;let V=k.WARNINGS;function lt(q){Number.isInteger(q)&&(V=q)}function J(){return V}function ct(q){V>=k.INFOS&&console.log(`Info: ${q}`)}function et(q){V>=k.WARNINGS&&console.log(`Warning: ${q}`)}function pt(q){throw new Error(q)}function at(q,nt){q||pt(nt)}function B(q){if(!q)return!1;switch(q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function O(q,nt=null,tt=null){if(!q)return null;try{if(tt&&typeof q=="string"){if(tt.addDefaultProtocol&&q.startsWith("www.")){const Et=q.match(/\./g);Et&&Et.length>=2&&(q=`http://${q}`)}if(tt.tryConvertEncoding)try{q=st(q)}catch{}}const _t=nt?new URL(q,nt):new URL(q);if(B(_t))return _t}catch{}return null}function D(q,nt,tt,_t=!1){return Object.defineProperty(q,nt,{value:tt,enumerable:!_t,configurable:!0,writable:!1}),tt}const N=function(){function nt(tt,_t){this.constructor===nt&&pt("Cannot initialize BaseException."),this.message=tt,this.name=_t}return nt.prototype=new Error,nt.constructor=nt,nt}();t.BaseException=N;class G extends N{constructor(nt,tt){super(nt,"PasswordException"),this.code=tt}}t.PasswordException=G;class H extends N{constructor(nt,tt){super(nt,"UnknownErrorException"),this.details=tt}}t.UnknownErrorException=H;class Z extends N{constructor(nt){super(nt,"InvalidPDFException")}}t.InvalidPDFException=Z;class $ extends N{constructor(nt){super(nt,"MissingPDFException")}}t.MissingPDFException=$;class ot extends N{constructor(nt,tt){super(nt,"UnexpectedResponseException"),this.status=tt}}t.UnexpectedResponseException=ot;class it extends N{constructor(nt){super(nt,"FormatError")}}t.FormatError=it;class Y extends N{constructor(nt){super(nt,"AbortException")}}t.AbortException=Y;function W(q){(typeof q!="object"||q===null||q.length===void 0)&&pt("Invalid argument for bytesToString");const nt=q.length,tt=8192;if(nt<tt)return String.fromCharCode.apply(null,q);const _t=[];for(let Et=0;Et<nt;Et+=tt){const ut=Math.min(Et+tt,nt),bt=q.subarray(Et,ut);_t.push(String.fromCharCode.apply(null,bt))}return _t.join("")}function n(q){typeof q!="string"&&pt("Invalid argument for stringToBytes");const nt=q.length,tt=new Uint8Array(nt);for(let _t=0;_t<nt;++_t)tt[_t]=q.charCodeAt(_t)&255;return tt}function v(q){return String.fromCharCode(q>>24&255,q>>16&255,q>>8&255,q&255)}function P(q){return Object.keys(q).length}function A(q){const nt=Object.create(null);for(const[tt,_t]of q)nt[tt]=_t;return nt}function E(){const q=new Uint8Array(4);return q[0]=1,new Uint32Array(q.buffer,0,1)[0]===1}function j(){try{return new Function(""),!0}catch{return!1}}class Q{static get isLittleEndian(){return D(this,"isLittleEndian",E())}static get isEvalSupported(){return D(this,"isEvalSupported",j())}static get isOffscreenCanvasSupported(){return D(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?D(this,"platform",{isWin:!1,isMac:!1}):D(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}t.FeatureTest=Q;const K=[...Array(256).keys()].map(q=>q.toString(16).padStart(2,"0"));class X{static makeHexColor(nt,tt,_t){return`#${K[nt]}${K[tt]}${K[_t]}`}static scaleMinMax(nt,tt){let _t;nt[0]?(nt[0]<0&&(_t=tt[0],tt[0]=tt[1],tt[1]=_t),tt[0]*=nt[0],tt[1]*=nt[0],nt[3]<0&&(_t=tt[2],tt[2]=tt[3],tt[3]=_t),tt[2]*=nt[3],tt[3]*=nt[3]):(_t=tt[0],tt[0]=tt[2],tt[2]=_t,_t=tt[1],tt[1]=tt[3],tt[3]=_t,nt[1]<0&&(_t=tt[2],tt[2]=tt[3],tt[3]=_t),tt[2]*=nt[1],tt[3]*=nt[1],nt[2]<0&&(_t=tt[0],tt[0]=tt[1],tt[1]=_t),tt[0]*=nt[2],tt[1]*=nt[2]),tt[0]+=nt[4],tt[1]+=nt[4],tt[2]+=nt[5],tt[3]+=nt[5]}static transform(nt,tt){return[nt[0]*tt[0]+nt[2]*tt[1],nt[1]*tt[0]+nt[3]*tt[1],nt[0]*tt[2]+nt[2]*tt[3],nt[1]*tt[2]+nt[3]*tt[3],nt[0]*tt[4]+nt[2]*tt[5]+nt[4],nt[1]*tt[4]+nt[3]*tt[5]+nt[5]]}static applyTransform(nt,tt){const _t=nt[0]*tt[0]+nt[1]*tt[2]+tt[4],Et=nt[0]*tt[1]+nt[1]*tt[3]+tt[5];return[_t,Et]}static applyInverseTransform(nt,tt){const _t=tt[0]*tt[3]-tt[1]*tt[2],Et=(nt[0]*tt[3]-nt[1]*tt[2]+tt[2]*tt[5]-tt[4]*tt[3])/_t,ut=(-nt[0]*tt[1]+nt[1]*tt[0]+tt[4]*tt[1]-tt[5]*tt[0])/_t;return[Et,ut]}static getAxialAlignedBoundingBox(nt,tt){const _t=X.applyTransform(nt,tt),Et=X.applyTransform(nt.slice(2,4),tt),ut=X.applyTransform([nt[0],nt[3]],tt),bt=X.applyTransform([nt[2],nt[1]],tt);return[Math.min(_t[0],Et[0],ut[0],bt[0]),Math.min(_t[1],Et[1],ut[1],bt[1]),Math.max(_t[0],Et[0],ut[0],bt[0]),Math.max(_t[1],Et[1],ut[1],bt[1])]}static inverseTransform(nt){const tt=nt[0]*nt[3]-nt[1]*nt[2];return[nt[3]/tt,-nt[1]/tt,-nt[2]/tt,nt[0]/tt,(nt[2]*nt[5]-nt[4]*nt[3])/tt,(nt[4]*nt[1]-nt[5]*nt[0])/tt]}static singularValueDecompose2dScale(nt){const tt=[nt[0],nt[2],nt[1],nt[3]],_t=nt[0]*tt[0]+nt[1]*tt[2],Et=nt[0]*tt[1]+nt[1]*tt[3],ut=nt[2]*tt[0]+nt[3]*tt[2],bt=nt[2]*tt[1]+nt[3]*tt[3],St=(_t+bt)/2,kt=Math.sqrt((_t+bt)**2-4*(_t*bt-ut*Et))/2,Rt=St+kt||1,Tt=St-kt||1;return[Math.sqrt(Rt),Math.sqrt(Tt)]}static normalizeRect(nt){const tt=nt.slice(0);return nt[0]>nt[2]&&(tt[0]=nt[2],tt[2]=nt[0]),nt[1]>nt[3]&&(tt[1]=nt[3],tt[3]=nt[1]),tt}static intersect(nt,tt){const _t=Math.max(Math.min(nt[0],nt[2]),Math.min(tt[0],tt[2])),Et=Math.min(Math.max(nt[0],nt[2]),Math.max(tt[0],tt[2]));if(_t>Et)return null;const ut=Math.max(Math.min(nt[1],nt[3]),Math.min(tt[1],tt[3])),bt=Math.min(Math.max(nt[1],nt[3]),Math.max(tt[1],tt[3]));return ut>bt?null:[_t,ut,Et,bt]}static bezierBoundingBox(nt,tt,_t,Et,ut,bt,St,kt){const Rt=[],Tt=[[],[]];let xt,Ct,Ft,Pt,Nt,Mt,Ot,Lt;for(let Xt=0;Xt<2;++Xt){if(Xt===0?(Ct=6*nt-12*_t+6*ut,xt=-3*nt+9*_t-9*ut+3*St,Ft=3*_t-3*nt):(Ct=6*tt-12*Et+6*bt,xt=-3*tt+9*Et-9*bt+3*kt,Ft=3*Et-3*tt),Math.abs(xt)<1e-12){if(Math.abs(Ct)<1e-12)continue;Pt=-Ft/Ct,0<Pt&&Pt<1&&Rt.push(Pt);continue}Ot=Ct*Ct-4*Ft*xt,Lt=Math.sqrt(Ot),!(Ot<0)&&(Nt=(-Ct+Lt)/(2*xt),0<Nt&&Nt<1&&Rt.push(Nt),Mt=(-Ct-Lt)/(2*xt),0<Mt&&Mt<1&&Rt.push(Mt))}let Bt=Rt.length,It;const jt=Bt;for(;Bt--;)Pt=Rt[Bt],It=1-Pt,Tt[0][Bt]=It*It*It*nt+3*It*It*Pt*_t+3*It*Pt*Pt*ut+Pt*Pt*Pt*St,Tt[1][Bt]=It*It*It*tt+3*It*It*Pt*Et+3*It*Pt*Pt*bt+Pt*Pt*Pt*kt;return Tt[0][jt]=nt,Tt[1][jt]=tt,Tt[0][jt+1]=St,Tt[1][jt+1]=kt,Tt[0].length=Tt[1].length=jt+2,[Math.min(...Tt[0]),Math.min(...Tt[1]),Math.max(...Tt[0]),Math.max(...Tt[1])]}}t.Util=X;const rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ht(q){if(q[0]>="ï"){let tt;if(q[0]==="þ"&&q[1]==="ÿ"?tt="utf-16be":q[0]==="ÿ"&&q[1]==="þ"?tt="utf-16le":q[0]==="ï"&&q[1]==="»"&&q[2]==="¿"&&(tt="utf-8"),tt)try{const _t=new TextDecoder(tt,{fatal:!0}),Et=n(q);return _t.decode(Et)}catch(_t){et(`stringToPDFString: "${_t}".`)}}const nt=[];for(let tt=0,_t=q.length;tt<_t;tt++){const Et=rt[q.charCodeAt(tt)];nt.push(Et?String.fromCharCode(Et):q.charAt(tt))}return nt.join("")}function st(q){return decodeURIComponent(escape(q))}function dt(q){return unescape(encodeURIComponent(q))}function mt(q){return typeof q=="object"&&q!==null&&q.byteLength!==void 0}function At(q,nt){if(q.length!==nt.length)return!1;for(let tt=0,_t=q.length;tt<_t;tt++)if(q[tt]!==nt[tt])return!1;return!0}function yt(q=new Date){return[q.getUTCFullYear().toString(),(q.getUTCMonth()+1).toString().padStart(2,"0"),q.getUTCDate().toString().padStart(2,"0"),q.getUTCHours().toString().padStart(2,"0"),q.getUTCMinutes().toString().padStart(2,"0"),q.getUTCSeconds().toString().padStart(2,"0")].join("")}function wt(){const q=Object.create(null);let nt=!1;return Object.defineProperty(q,"settled",{get(){return nt}}),q.promise=new Promise(function(tt,_t){q.resolve=function(Et){nt=!0,tt(Et)},q.reject=function(Et){nt=!0,_t(Et)}}),q}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var x,e,r,s,Vt,p,ie,m,C,b,M,S,d,f,c,ue,o,R,de,F,u;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:y,NodeCMapReaderFactory:l,NodeFilterFactory:h,NodeStandardFontDataFactory:I}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=y,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=l,exports.DefaultFilterFactory=DefaultFilterFactory=h,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=I}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:y}=__w_pdfjs_require__(21);createPDFNetworkStream=l=>new y(l)}else{const{PDFNetworkStream:y}=__w_pdfjs_require__(24),{PDFFetchStream:l}=__w_pdfjs_require__(25);createPDFNetworkStream=h=>(0,_display_utils.isValidFetchUrl)(h.url)?new l(h):new y(h)}function getDocument(y){if(typeof y=="string"||y instanceof URL?y={url:y}:(0,_util.isArrayBuffer)(y)&&(y={data:y}),typeof y!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!y.url&&!y.data&&!y.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:h}=l,I=y.url?getUrlProp(y.url):null,k=y.data?getDataProp(y.data):null,T=y.httpHeaders||null,U=y.withCredentials===!0,_=y.password??null,V=y.range instanceof PDFDataRangeTransport?y.range:null,lt=Number.isInteger(y.rangeChunkSize)&&y.rangeChunkSize>0?y.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let J=y.worker instanceof PDFWorker?y.worker:null;const ct=y.verbosity,et=typeof y.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(y.docBaseUrl)?y.docBaseUrl:null,pt=typeof y.cMapUrl=="string"?y.cMapUrl:null,at=y.cMapPacked!==!1,B=y.CMapReaderFactory||DefaultCMapReaderFactory,O=typeof y.standardFontDataUrl=="string"?y.standardFontDataUrl:null,D=y.StandardFontDataFactory||DefaultStandardFontDataFactory,N=y.stopAtErrors!==!0,G=Number.isInteger(y.maxImageSize)&&y.maxImageSize>-1?y.maxImageSize:-1,H=y.isEvalSupported!==!1,Z=typeof y.isOffscreenCanvasSupported=="boolean"?y.isOffscreenCanvasSupported:!_is_node.isNodeJS,$=Number.isInteger(y.canvasMaxAreaInBytes)?y.canvasMaxAreaInBytes:-1,ot=typeof y.disableFontFace=="boolean"?y.disableFontFace:_is_node.isNodeJS,it=y.fontExtraProperties===!0,Y=y.enableXfa===!0,W=y.ownerDocument||globalThis.document,n=y.disableRange===!0,v=y.disableStream===!0,P=y.disableAutoFetch===!0,A=y.pdfBug===!0,E=V?V.length:y.length??NaN,j=typeof y.useSystemFonts=="boolean"?y.useSystemFonts:!_is_node.isNodeJS&&!ot,Q=typeof y.useWorkerFetch=="boolean"?y.useWorkerFetch:B===_display_utils.DOMCMapReaderFactory&&D===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(pt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(O,document.baseURI),K=y.canvasFactory||new DefaultCanvasFactory({ownerDocument:W}),X=y.filterFactory||new DefaultFilterFactory({docId:h,ownerDocument:W}),rt=null;(0,_util.setVerbosityLevel)(ct);const ht={canvasFactory:K,filterFactory:X};if(Q||(ht.cMapReaderFactory=new B({baseUrl:pt,isCompressed:at}),ht.standardFontDataFactory=new D({baseUrl:O})),!J){const mt={verbosity:ct,port:_worker_options.GlobalWorkerOptions.workerPort};J=mt.port?PDFWorker.fromPort(mt):new PDFWorker(mt),l._worker=J}const st={docId:h,apiVersion:"3.5.141",data:k,password:_,disableAutoFetch:P,rangeChunkSize:lt,length:E,docBaseUrl:et,enableXfa:Y,evaluatorOptions:{maxImageSize:G,disableFontFace:ot,ignoreErrors:N,isEvalSupported:H,isOffscreenCanvasSupported:Z,canvasMaxAreaInBytes:$,fontExtraProperties:it,useSystemFonts:j,cMapUrl:Q?pt:null,standardFontDataUrl:Q?O:null}},dt={ignoreErrors:N,isEvalSupported:H,disableFontFace:ot,fontExtraProperties:it,enableXfa:Y,ownerDocument:W,disableAutoFetch:P,pdfBug:A,styleElement:rt};return J.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const mt=_fetchDocument(J,st),At=new Promise(function(yt){let wt;V?wt=new _transport_stream.PDFDataTransportStream({length:E,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:n,disableStream:v},V):k||(wt=createPDFNetworkStream({url:I,length:E,httpHeaders:T,withCredentials:U,rangeChunkSize:lt,disableRange:n,disableStream:v})),yt(wt)});return Promise.all([mt,At]).then(function([yt,wt]){if(l.destroyed)throw new Error("Loading aborted");const q=new _message_handler.MessageHandler(h,yt,J.port),nt=new WorkerTransport(q,l,wt,dt,ht);l._transport=nt,q.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(y,l){if(y.destroyed)throw new Error("Worker was destroyed");const h=await y.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(y.destroyed)throw new Error("Worker was destroyed");return h}function getUrlProp(y){if(y instanceof URL)return y.href;try{return new URL(y,window.location).href}catch{if(_is_node.isNodeJS&&typeof y=="string")return y}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(y){if(_is_node.isNodeJS&&typeof Buffer<"u"&&y instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(y);if(y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength)return y;if(typeof y=="string")return(0,_util.stringToBytes)(y);if(typeof y=="object"&&!isNaN(y==null?void 0:y.length)||(0,_util.isArrayBuffer)(y))return new Uint8Array(y);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const t=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${se(t,x)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l;this.destroyed=!0,await((l=this._transport)==null?void 0:l.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=t;x=new WeakMap,ft(PDFDocumentLoadingTask,x,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,h,I=!1,k=null){this.length=l,this.initialData=h,this.progressiveDone=I,this.contentDispositionFilename=k,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,h){for(const I of this._rangeListeners)I(l,h)}onDataProgress(l,h){this._readyCapability.promise.then(()=>{for(const I of this._progressListeners)I(l,h)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const h of this._progressiveReadListeners)h(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,h){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,h){this._pdfInfo=l,this._transport=h}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,h,I,k=!1){ft(this,s);ft(this,p);ft(this,e,null);ft(this,r,!1);this._pageIndex=l,this._pageInfo=h,this._transport=I,this._stats=k?new _display_utils.StatTimer:null,this._pdfBug=k,this.commonObjs=I.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:h=this.rotate,offsetX:I=0,offsetY:k=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:h,offsetX:I,offsetY:k,dontFlip:T})}getAnnotations({intent:l="display"}={}){const h=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,h.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:h,intent:I="display",annotationMode:k=_util.AnnotationMode.ENABLE,transform:T=null,background:U=null,optionalContentConfigPromise:_=null,annotationCanvasMap:V=null,pageColors:lt=null,printAnnotationStorage:J=null}){var D,N,G;if((D=arguments[0])!=null&&D.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(N=this._stats)==null||N.time("Overall");const ct=this._transport.getRenderingIntent(I,k,J);vt(this,r,!1),gt(this,p,ie).call(this),_||(_=this._transport.getOptionalContentConfig());let et=this._intentStates.get(ct.cacheKey);et||(et=Object.create(null),this._intentStates.set(ct.cacheKey,et)),et.streamReaderCancelTimeout&&(clearTimeout(et.streamReaderCancelTimeout),et.streamReaderCancelTimeout=null);const pt=!!(ct.renderingIntent&_util.RenderingIntentFlag.PRINT);et.displayReadyCapability||(et.displayReadyCapability=(0,_util.createPromiseCapability)(),et.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(G=this._stats)==null||G.time("Page Request"),this._pumpOperatorList(ct));const at=H=>{var Z,$;et.renderTasks.delete(B),(this._maybeCleanupAfterRender||pt)&&vt(this,r,!0),gt(this,s,Vt).call(this,!pt),H?(B.capability.reject(H),this._abortOperatorList({intentState:et,reason:H instanceof Error?H:new Error(H)})):B.capability.resolve(),(Z=this._stats)==null||Z.timeEnd("Rendering"),($=this._stats)==null||$.timeEnd("Overall")},B=new InternalRenderTask({callback:at,params:{canvasContext:l,viewport:h,transform:T,background:U},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:et.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!pt,pdfBug:this._pdfBug,pageColors:lt});(et.renderTasks||(et.renderTasks=new Set)).add(B);const O=B.task;return Promise.all([et.displayReadyCapability.promise,_]).then(([H,Z])=>{var $;if(z(this,r)){at();return}($=this._stats)==null||$.time("Rendering"),B.initializeGraphics({transparency:H,optionalContentConfig:Z}),B.operatorListChanged()}).catch(at),O}getOperatorList({intent:l="display",annotationMode:h=_util.AnnotationMode.ENABLE,printAnnotationStorage:I=null}={}){var V;function k(){U.operatorList.lastChunk&&(U.opListReadCapability.resolve(U.operatorList),U.renderTasks.delete(_))}const T=this._transport.getRenderingIntent(l,h,I,!0);let U=this._intentStates.get(T.cacheKey);U||(U=Object.create(null),this._intentStates.set(T.cacheKey,U));let _;return U.opListReadCapability||(_=Object.create(null),_.operatorListChanged=k,U.opListReadCapability=(0,_util.createPromiseCapability)(),(U.renderTasks||(U.renderTasks=new Set)).add(_),U.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(T)),U.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0},{highWaterMark:100,size(I){return I.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(I=>_xfa_text.XfaText.textContent(I));const h=this.streamTextContent(l);return new Promise(function(I,k){function T(){U.read().then(function({value:V,done:lt}){if(lt){I(_);return}Object.assign(_.styles,V.styles),_.items.push(...V.items),T()},k)}const U=h.getReader(),_={items:[],styles:Object.create(null)};T()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const h of this._intentStates.values())if(this._abortOperatorList({intentState:h,reason:new Error("Page was destroyed."),force:!0}),!h.opListReadCapability)for(const I of h.renderTasks)l.push(I.completed),I.cancel();return this.objs.clear(),vt(this,r,!1),gt(this,p,ie).call(this),Promise.all(l)}cleanup(l=!1){vt(this,r,!0);const h=gt(this,s,Vt).call(this,!1);return l&&h&&this._stats&&(this._stats=new _display_utils.StatTimer),h}_startRenderPage(l,h){var k,T;const I=this._intentStates.get(h);I&&((k=this._stats)==null||k.timeEnd("Page Request"),(T=I.displayReadyCapability)==null||T.resolve(l))}_renderPageChunk(l,h){for(let I=0,k=l.length;I<k;I++)h.operatorList.fnArray.push(l.fnArray[I]),h.operatorList.argsArray.push(l.argsArray[I]);h.operatorList.lastChunk=l.lastChunk,h.operatorList.separateAnnots=l.separateAnnots;for(const I of h.renderTasks)I.operatorListChanged();l.lastChunk&&gt(this,s,Vt).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:h,annotationStorageMap:I}){const T=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:h,annotationStorage:I}).getReader(),U=this._intentStates.get(h);U.streamReader=T;const _=()=>{T.read().then(({value:V,done:lt})=>{if(lt){U.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(V,U),_())},V=>{if(U.streamReader=null,!this._transport.destroyed){if(U.operatorList){U.operatorList.lastChunk=!0;for(const lt of U.renderTasks)lt.operatorListChanged();gt(this,s,Vt).call(this,!0)}if(U.displayReadyCapability)U.displayReadyCapability.reject(V);else if(U.opListReadCapability)U.opListReadCapability.reject(V);else throw V}})};_()}_abortOperatorList({intentState:l,reason:h,force:I=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!I){if(l.renderTasks.size>0)return;if(h instanceof _display_utils.RenderingCancelledException){let k=RENDERING_CANCELLED_TIMEOUT;h.extraDelay>0&&h.extraDelay<1e3&&(k+=h.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:h,force:!0})},k);return}}if(l.streamReader.cancel(new _util.AbortException(h.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[k,T]of this._intentStates)if(T===l){this._intentStates.delete(k);break}this.cleanup()}}}get stats(){return this._stats}}e=new WeakMap,r=new WeakMap,s=new WeakSet,Vt=function(l=!1){if(gt(this,p,ie).call(this),!z(this,r))return!1;if(l)return vt(this,e,setTimeout(()=>{vt(this,e,null),gt(this,s,Vt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:h,operatorList:I}of this._intentStates.values())if(h.size>0||!I.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),vt(this,r,!1),!0},p=new WeakSet,ie=function(){z(this,e)&&(clearTimeout(z(this,e)),vt(this,e,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){ft(this,m,new Set);ft(this,C,Promise.resolve())}postMessage(l,h){const I={data:structuredClone(l,h?{transfer:h}:null)};z(this,C).then(()=>{for(const k of z(this,m))k.call(this,I)})}addEventListener(l,h){z(this,m).add(h)}removeEventListener(l,h){z(this,m).delete(h)}terminate(){z(this,m).clear()}}m=new WeakMap,C=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const y=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;y&&(PDFWorkerUtil.fallbackWorkerSrc=y.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(y,l){let h;try{if(h=new URL(y),!h.origin||h.origin==="null")return!1}catch{return!1}const I=new URL(l,h);return h.origin===I.origin},PDFWorkerUtil.createCDNWrapper=function(y){const l=`importScripts("${y}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class{constructor({name:y=null,port:l=null,verbosity:h=(0,_util.getVerbosityLevel)()}={}){if(l&&z(_PDFWorker,M).has(l))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=y,this.destroyed=!1,this.verbosity=h,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,l){z(_PDFWorker,M).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(y){this._port=y,this._messageHandler=new _message_handler.MessageHandler("main","worker",y),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:y}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,y)||(y=PDFWorkerUtil.createCDNWrapper(new URL(y,window.location).href));const l=new Worker(y),h=new _message_handler.MessageHandler("main","worker",l),I=()=>{l.removeEventListener("error",k),h.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},k=()=>{this._webWorker||I()};l.addEventListener("error",k),h.on("test",U=>{if(l.removeEventListener("error",k),this.destroyed){I();return}U?(this._messageHandler=h,this._port=l,this._webWorker=l,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),h.destroy(),l.terminate())}),h.on("ready",U=>{if(l.removeEventListener("error",k),this.destroyed){I();return}try{T()}catch{this._setupFakeWorker()}});const T=()=>{const U=new Uint8Array;h.send("test",U,[U.buffer])};T();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(y=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const h=`fake${PDFWorkerUtil.fakeWorkerId++}`,I=new _message_handler.MessageHandler(h+"_worker",h,l);y.setup(I,l);const k=new _message_handler.MessageHandler(h,h+"_worker",l);this._messageHandler=k,this._readyCapability.resolve(),k.send("configure",{verbosity:this.verbosity})}).catch(y=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${y.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),z(_PDFWorker,M).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(y){if(!(y!=null&&y.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return z(this,M).has(y.port)?z(this,M).get(y.port):new _PDFWorker(y)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var y;try{return((y=globalThis.pdfjsWorker)==null?void 0:y.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;M=new WeakMap,ft(PDFWorker,M,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,h,I,k,T){ft(this,c);ft(this,S,new Map);ft(this,d,new Map);ft(this,f,new Map);this.messageHandler=l,this.loadingTask=h,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:k.ownerDocument,styleElement:k.styleElement}),this._params=k,this.canvasFactory=T.canvasFactory,this.filterFactory=T.filterFactory,this.cMapReaderFactory=T.cMapReaderFactory,this.standardFontDataFactory=T.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=I,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,h=_util.AnnotationMode.ENABLE,I=null,k=!1){let T=_util.RenderingIntentFlag.DISPLAY,U=null;switch(l){case"any":T=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":T=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(h){case _util.AnnotationMode.DISABLE:T+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:T+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:T+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,U=(T&_util.RenderingIntentFlag.PRINT&&I instanceof _annotation_storage.PrintAnnotationStorage?I:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${h}`)}return k&&(T+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:T,cacheKey:`${T}_${_annotation_storage.AnnotationStorage.getHash(U)}`,annotationStorageMap:U}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const I of z(this,d).values())l.push(I._destroy());z(this,d).clear(),z(this,f).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const h=this.messageHandler.sendWithPromise("Terminate",null);return l.push(h),Promise.all(l).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),z(this,S).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:h}=this;l.on("GetReader",(I,k)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=T=>{this._lastProgress={loaded:T.loaded,total:T.total}},k.onPull=()=>{this._fullReader.read().then(function({value:T,done:U}){if(U){k.close();return}(0,_util.assert)(T instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),k.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{k.error(T)})},k.onCancel=T=>{this._fullReader.cancel(T),k.ready.catch(U=>{if(!this.destroyed)throw U})}}),l.on("ReaderHeadersReady",I=>{const k=(0,_util.createPromiseCapability)(),T=this._fullReader;return T.headersReady.then(()=>{var U;(!T.isStreamingSupported||!T.isRangeSupported)&&(this._lastProgress&&((U=h.onProgress)==null||U.call(h,this._lastProgress)),T.onProgress=_=>{var V;(V=h.onProgress)==null||V.call(h,{loaded:_.loaded,total:_.total})}),k.resolve({isStreamingSupported:T.isStreamingSupported,isRangeSupported:T.isRangeSupported,contentLength:T.contentLength})},k.reject),k.promise}),l.on("GetRangeReader",(I,k)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const T=this._networkStream.getRangeReader(I.begin,I.end);if(!T){k.close();return}k.onPull=()=>{T.read().then(function({value:U,done:_}){if(_){k.close();return}(0,_util.assert)(U instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),k.enqueue(new Uint8Array(U),1,[U])}).catch(U=>{k.error(U)})},k.onCancel=U=>{T.cancel(U),k.ready.catch(_=>{if(!this.destroyed)throw _})}}),l.on("GetDoc",({pdfInfo:I})=>{this._numPages=I.numPages,this._htmlForXfa=I.htmlForXfa,delete I.htmlForXfa,h._capability.resolve(new PDFDocumentProxy(I,this))}),l.on("DocException",function(I){let k;switch(I.name){case"PasswordException":k=new _util.PasswordException(I.message,I.code);break;case"InvalidPDFException":k=new _util.InvalidPDFException(I.message);break;case"MissingPDFException":k=new _util.MissingPDFException(I.message);break;case"UnexpectedResponseException":k=new _util.UnexpectedResponseException(I.message,I.status);break;case"UnknownErrorException":k=new _util.UnknownErrorException(I.message,I.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}h._capability.reject(k)}),l.on("PasswordRequest",I=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),h.onPassword){const k=T=>{T instanceof Error?this._passwordCapability.reject(T):this._passwordCapability.resolve({password:T})};try{h.onPassword(k,I.code)}catch(T){this._passwordCapability.reject(T)}}else this._passwordCapability.reject(new _util.PasswordException(I.message,I.code));return this._passwordCapability.promise}),l.on("DataLoaded",I=>{var k;(k=h.onProgress)==null||k.call(h,{loaded:I.length,total:I.length}),this.downloadInfoCapability.resolve(I)}),l.on("StartRenderPage",I=>{if(this.destroyed)return;z(this,d).get(I.pageIndex)._startRenderPage(I.transparency,I.cacheKey)}),l.on("commonobj",([I,k,T])=>{var U;if(!this.destroyed&&!this.commonObjs.has(I))switch(k){case"Font":const _=this._params;if("error"in T){const J=T.error;(0,_util.warn)(`Error during font loading: ${J}`),this.commonObjs.resolve(I,J);break}const V=_.pdfBug&&((U=globalThis.FontInspector)!=null&&U.enabled)?(J,ct)=>globalThis.FontInspector.fontAdded(J,ct):null,lt=new _font_loader.FontFaceObject(T,{isEvalSupported:_.isEvalSupported,disableFontFace:_.disableFontFace,ignoreErrors:_.ignoreErrors,inspectFont:V});this.fontLoader.bind(lt).catch(J=>l.sendWithPromise("FontFallback",{id:I})).finally(()=>{!_.fontExtraProperties&&lt.data&&(lt.data=null),this.commonObjs.resolve(I,lt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(I,T);break;default:throw new Error(`Got unknown common object type ${k}`)}}),l.on("obj",([I,k,T,U])=>{var V;if(this.destroyed)return;const _=z(this,d).get(k);if(!_.objs.has(I))switch(T){case"Image":if(_.objs.resolve(I,U),U){let lt;if(U.bitmap){const{width:J,height:ct}=U;lt=J*ct*4}else lt=((V=U.data)==null?void 0:V.length)||0;lt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(_._maybeCleanupAfterRender=!0)}break;case"Pattern":_.objs.resolve(I,U);break;default:throw new Error(`Got unknown object type ${T}`)}}),l.on("DocProgress",I=>{var k;this.destroyed||(k=h.onProgress)==null||k.call(h,{loaded:I.loaded,total:I.total})}),l.on("FetchBuiltInCMap",I=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(I):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",I=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(I):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var l;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((l=this._fullReader)==null?void 0:l.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const h=l-1,I=z(this,f).get(h);if(I)return I;const k=this.messageHandler.sendWithPromise("GetPage",{pageIndex:h}).then(T=>{if(this.destroyed)throw new Error("Transport destroyed");const U=new PDFPageProxy(h,T,this,this._params.pdfBug);return z(this,d).set(h,U),U});return z(this,f).set(h,k),k}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,h){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:h})}getFieldObjects(){return gt(this,c,ue).call(this,"GetFieldObjects")}hasJSActions(){return gt(this,c,ue).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",h=z(this,S).get(l);if(h)return h;const I=this.messageHandler.sendWithPromise(l,null).then(k=>{var T,U;return{info:k[0],metadata:k[1]?new _metadata.Metadata(k[1]):null,contentDispositionFilename:((T=this._fullReader)==null?void 0:T.filename)??null,contentLength:((U=this._fullReader)==null?void 0:U.contentLength)??null}});return z(this,S).set(l,I),I}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const h of z(this,d).values())if(!h.cleanup())throw new Error(`startCleanup: Page ${h.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),z(this,S).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:h}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:h})}}S=new WeakMap,d=new WeakMap,f=new WeakMap,c=new WeakSet,ue=function(l,h=null){const I=z(this,S).get(l);if(I)return I;const k=this.messageHandler.sendWithPromise(l,h);return z(this,S).set(l,k),k};class PDFObjects{constructor(){ft(this,R);ft(this,o,Object.create(null))}get(l,h=null){if(h){const k=gt(this,R,de).call(this,l);return k.capability.promise.then(()=>h(k.data)),null}const I=z(this,o)[l];if(!(I!=null&&I.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return I.data}has(l){const h=z(this,o)[l];return(h==null?void 0:h.capability.settled)||!1}resolve(l,h=null){const I=gt(this,R,de).call(this,l);I.data=h,I.capability.resolve()}clear(){var l;for(const h in z(this,o)){const{data:I}=z(this,o)[h];(l=I==null?void 0:I.bitmap)==null||l.close()}vt(this,o,Object.create(null))}}o=new WeakMap,R=new WeakSet,de=function(l){const h=z(this,o)[l];return h||(z(this,o)[l]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(l){ft(this,F,null);vt(this,F,l),this.onContinue=null}get promise(){return z(this,F).capability.promise}cancel(l=0){z(this,F).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=z(this,F).operatorList;if(!l)return!1;const{annotationCanvasMap:h}=z(this,F);return l.form||l.canvas&&(h==null?void 0:h.size)>0}}F=new WeakMap,exports.RenderTask=RenderTask;const w=class{constructor({callback:l,params:h,objs:I,commonObjs:k,annotationCanvasMap:T,operatorList:U,pageIndex:_,canvasFactory:V,filterFactory:lt,useRequestAnimationFrame:J=!1,pdfBug:ct=!1,pageColors:et=null}){this.callback=l,this.params=h,this.objs=I,this.commonObjs=k,this.annotationCanvasMap=T,this.operatorListIdx=null,this.operatorList=U,this._pageIndex=_,this.canvasFactory=V,this.filterFactory=lt,this._pdfBug=ct,this.pageColors=et,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=J===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=h.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:h}){var _,V;if(this.cancelled)return;if(this._canvas){if(z(w,u).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");z(w,u).add(this._canvas)}this._pdfBug&&((_=globalThis.StepperManager)!=null&&_.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:I,viewport:k,transform:T,background:U}=this.params;this.gfx=new _canvas.CanvasGraphics(I,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:h},this.annotationCanvasMap),this.gfx.beginDrawing({transform:T,viewport:k,transparency:l,background:U}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(l=null,h=0){var I;this.running=!1,this.cancelled=!0,(I=this.gfx)==null||I.endDrawing(this.pageColors),this._canvas&&z(w,u).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",h))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&z(w,u).delete(this._canvas),this.callback())))}};let InternalRenderTask=w;u=new WeakMap,ft(InternalRenderTask,u,new WeakSet);const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(x,t,e)=>{var m,C,b,Me,S;Object.defineProperty(t,"__esModule",{value:!0}),t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var r=e(1),s=e(4),i=e(8);class p{constructor(){ft(this,b);ft(this,m,!1);ft(this,C,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(f,c){const a=z(this,C).get(f);return a===void 0?c:Object.assign(c,a)}getRawValue(f){return z(this,C).get(f)}remove(f){if(z(this,C).delete(f),z(this,C).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const c of z(this,C).values())if(c instanceof s.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(f,c){const a=z(this,C).get(f);let o=!1;if(a!==void 0)for(const[R,L]of Object.entries(c))a[R]!==L&&(o=!0,a[R]=L);else o=!0,z(this,C).set(f,c);o&&gt(this,b,Me).call(this),c instanceof s.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(c.constructor._type)}has(f){return z(this,C).has(f)}getAll(){return z(this,C).size>0?(0,r.objectFromMap)(z(this,C)):null}setAll(f){for(const[c,a]of Object.entries(f))this.setValue(c,a)}get size(){return z(this,C).size}resetModified(){z(this,m)&&(vt(this,m,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new g(this)}get serializable(){if(z(this,C).size===0)return null;const f=new Map;for(const[c,a]of z(this,C)){const o=a instanceof s.AnnotationEditor?a.serialize():a;o&&f.set(c,o)}return f}static getHash(f){if(!f)return"";const c=new i.MurmurHash3_64;for(const[a,o]of f)c.update(`${a}:${JSON.stringify(o)}`);return c.hexdigest()}}m=new WeakMap,C=new WeakMap,b=new WeakSet,Me=function(){z(this,m)||(vt(this,m,!0),typeof this.onSetModified=="function"&&this.onSetModified())},t.AnnotationStorage=p;class g extends p{constructor(c){super();ft(this,S,null);vt(this,S,structuredClone(c.serializable))}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return z(this,S)}}S=new WeakMap,t.PrintAnnotationStorage=g},(x,t,e)=>{var p,g,m,C,b,M;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var r=e(5),s=e(1);const S=class{constructor(f){ft(this,p,this.focusin.bind(this));ft(this,g,this.focusout.bind(this));ft(this,m,!1);ft(this,C,!1);ft(this,b,!1);Dt(this,"_uiManager",null);ft(this,M,S._zIndex++);this.constructor===S&&(0,s.unreachable)("Cannot initialize AnnotationEditor."),this.parent=f.parent,this.id=f.id,this.width=this.height=null,this.pageIndex=f.parent.pageIndex,this.name=f.name,this.div=null,this._uiManager=f.uiManager;const{rotation:c,rawDims:{pageWidth:a,pageHeight:o,pageX:R,pageY:L}}=this.parent.viewport;this.rotation=c,this.pageDimensions=[a,o],this.pageTranslation=[R,L];const[F,u]=this.parentDimensions;this.x=f.x/F,this.y=f.y/u,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,s.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(f){this._uiManager.addCommands(f)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=z(this,M)}setParent(f){f!==null&&(this.pageIndex=f.pageIndex,this.pageDimensions=f.pageDimensions),this.parent=f}focusin(f){z(this,m)?vt(this,m,!1):this.parent.setSelected(this)}focusout(f){var a;if(!this.isAttachedToDOM)return;const c=f.relatedTarget;c!=null&&c.closest(`#${this.id}`)||(f.preventDefault(),(a=this.parent)!=null&&a.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(f){const c=this.parent.div.getBoundingClientRect();this.startX=f.clientX-c.x,this.startY=f.clientY-c.y,f.dataTransfer.setData("text/plain",this.id),f.dataTransfer.effectAllowed="move"}setAt(f,c,a,o){const[R,L]=this.parentDimensions;[a,o]=this.screenToPageTranslation(a,o),this.x=(f+a)/R,this.y=(c+o)/L,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(f,c){const[a,o]=this.parentDimensions;[f,c]=this.screenToPageTranslation(f,c),this.x+=f/a,this.y+=c/o,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(f,c){switch(this.parentRotation){case 90:return[c,-f];case 180:return[-f,-c];case 270:return[-c,f];default:return[f,c]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:f}=this._uiManager.viewParameters,[c,a]=this.pageDimensions;return[c*f,a*f]}setDims(f,c){const[a,o]=this.parentDimensions;this.div.style.width=`${100*f/a}%`,this.div.style.height=`${100*c/o}%`}fixDims(){const{style:f}=this.div,{height:c,width:a}=f,o=a.endsWith("%"),R=c.endsWith("%");if(o&&R)return;const[L,F]=this.parentDimensions;o||(f.width=`${100*parseFloat(a)/L}%`),R||(f.height=`${100*parseFloat(c)/F}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",z(this,p)),this.div.addEventListener("focusout",z(this,g));const[f,c]=this.getInitialTranslation();return this.translate(f,c),(0,r.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(f){const{isMac:c}=s.FeatureTest.platform;if(f.button!==0||f.ctrlKey&&c){f.preventDefault();return}f.ctrlKey&&!c||f.shiftKey||f.metaKey&&c?this.parent.toggleSelected(this):this.parent.setSelected(this),vt(this,m,!0)}getRect(f,c){const a=this.parentScale,[o,R]=this.pageDimensions,[L,F]=this.pageTranslation,u=f/a,w=c/a,y=this.x*o,l=this.y*R,h=this.width*o,I=this.height*R;switch(this.rotation){case 0:return[y+u+L,R-l-w-I+F,y+u+h+L,R-l-w+F];case 90:return[y+w+L,R-l+u+F,y+w+I+L,R-l+u+h+F];case 180:return[y-u-h+L,R-l+w+F,y-u+L,R-l+w+I+F];case 270:return[y-w-I+L,R-l-u-h+F,y-w+L,R-l-u+F];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(f,c){const[a,o,R,L]=f,F=R-a,u=L-o;switch(this.rotation){case 0:return[a,c-L,F,u];case 90:return[a,c-o,u,F];case 180:return[R,c-o,F,u];case 270:return[R,c-L,u,F];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){vt(this,b,!0)}disableEditMode(){vt(this,b,!1)}isInEditMode(){return z(this,b)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var f;(f=this.div)==null||f.addEventListener("focusin",z(this,p))}serialize(){(0,s.unreachable)("An editor must be serializable")}static deserialize(f,c,a){const o=new this.prototype.constructor({parent:c,id:c.getNextId(),uiManager:a});o.rotation=f.rotation;const[R,L]=o.pageDimensions,[F,u,w,y]=o.getRectInCurrentCoords(f.rect,L);return o.x=F/R,o.y=u/L,o.width=w/R,o.height=y/L,o}remove(){this.div.removeEventListener("focusin",z(this,p)),this.div.removeEventListener("focusout",z(this,g)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var f;(f=this.div)==null||f.classList.add("selectedEditor")}unselect(){var f;(f=this.div)==null||f.classList.remove("selectedEditor")}updateParams(f,c){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return z(this,C)}set isEditing(f){vt(this,C,f),f?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let i=S;p=new WeakMap,g=new WeakMap,m=new WeakMap,C=new WeakMap,b=new WeakMap,M=new WeakMap,Dt(i,"_colorManager",new r.ColorManager),Dt(i,"_zIndex",1),t.AnnotationEditor=i},(x,t,e)=>{var S,d,f,c,a,o,De,F,u,w,y,l,h,I,k,T,U,_,V,lt,J,ct,et,pt,at,B,O,D,N,G,H,Oe,$,fe,it,Ie,W,Le,v,Ut,A,Zt,j,Ne,K,Be,rt,pe,st,Jt,mt,me;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=i,t.opacityToHex=p;var r=e(1),s=e(6);function i(wt,q,nt){for(const tt of nt)q.addEventListener(tt,wt[tt].bind(wt))}function p(wt){return Math.round(Math.min(255,Math.max(1,255*wt))).toString(16).padStart(2,"0")}class g{constructor(){ft(this,S,0)}getId(){return`${r.AnnotationEditorPrefix}${se(this,S)._++}`}}S=new WeakMap;class m{constructor(q=128){ft(this,d,[]);ft(this,f,!1);ft(this,c,void 0);ft(this,a,-1);vt(this,c,q)}add({cmd:q,undo:nt,mustExec:tt,type:_t=NaN,overwriteIfSameType:Et=!1,keepUndo:ut=!1}){if(tt&&q(),z(this,f))return;const bt={cmd:q,undo:nt,type:_t};if(z(this,a)===-1){z(this,d).length>0&&(z(this,d).length=0),vt(this,a,0),z(this,d).push(bt);return}if(Et&&z(this,d)[z(this,a)].type===_t){ut&&(bt.undo=z(this,d)[z(this,a)].undo),z(this,d)[z(this,a)]=bt;return}const St=z(this,a)+1;St===z(this,c)?z(this,d).splice(0,1):(vt(this,a,St),St<z(this,d).length&&z(this,d).splice(St)),z(this,d).push(bt)}undo(){z(this,a)!==-1&&(vt(this,f,!0),z(this,d)[z(this,a)].undo(),vt(this,f,!1),vt(this,a,z(this,a)-1))}redo(){z(this,a)<z(this,d).length-1&&(vt(this,a,z(this,a)+1),vt(this,f,!0),z(this,d)[z(this,a)].cmd(),vt(this,f,!1))}hasSomethingToUndo(){return z(this,a)!==-1}hasSomethingToRedo(){return z(this,a)<z(this,d).length-1}destroy(){vt(this,d,null)}}d=new WeakMap,f=new WeakMap,c=new WeakMap,a=new WeakMap,t.CommandManager=m;class C{constructor(q){ft(this,o);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:nt}=r.FeatureTest.platform;for(const[tt,_t]of q)for(const Et of tt){const ut=Et.startsWith("mac+");nt&&ut?(this.callbacks.set(Et.slice(4),_t),this.allKeys.add(Et.split("+").at(-1))):!nt&&!ut&&(this.callbacks.set(Et,_t),this.allKeys.add(Et.split("+").at(-1)))}}exec(q,nt){if(!this.allKeys.has(nt.key))return;const tt=this.callbacks.get(gt(this,o,De).call(this,nt));tt&&(tt.bind(q)(),nt.stopPropagation(),nt.preventDefault())}}o=new WeakSet,De=function(q){q.altKey&&this.buffer.push("alt"),q.ctrlKey&&this.buffer.push("ctrl"),q.metaKey&&this.buffer.push("meta"),q.shiftKey&&this.buffer.push("shift"),this.buffer.push(q.key);const nt=this.buffer.join("+");return this.buffer.length=0,nt},t.KeyboardManager=C;const L=class{get _colors(){const q=new Map([["CanvasText",null],["Canvas",null]]);return(0,s.getColorValues)(q),(0,r.shadow)(this,"_colors",q)}convert(q){const nt=(0,s.getRGB)(q);if(!window.matchMedia("(forced-colors: active)").matches)return nt;for(const[tt,_t]of this._colors)if(_t.every((Et,ut)=>Et===nt[ut]))return L._colorsMapping.get(tt);return nt}getHexCode(q){const nt=this._colors.get(q);return nt?r.Util.makeHexColor(...nt):q}};let b=L;Dt(b,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),t.ColorManager=b;const yt=class{constructor(q,nt,tt){ft(this,H);ft(this,$);ft(this,it);ft(this,W);ft(this,v);ft(this,A);ft(this,j);ft(this,K);ft(this,rt);ft(this,st);ft(this,mt);ft(this,F,null);ft(this,u,new Map);ft(this,w,new Map);ft(this,y,null);ft(this,l,new m);ft(this,h,0);ft(this,I,null);ft(this,k,new Set);ft(this,T,null);ft(this,U,new g);ft(this,_,!1);ft(this,V,r.AnnotationEditorType.NONE);ft(this,lt,new Set);ft(this,J,this.copy.bind(this));ft(this,ct,this.cut.bind(this));ft(this,et,this.paste.bind(this));ft(this,pt,this.keydown.bind(this));ft(this,at,this.onEditingAction.bind(this));ft(this,B,this.onPageChanging.bind(this));ft(this,O,this.onScaleChanging.bind(this));ft(this,D,this.onRotationChanging.bind(this));ft(this,N,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ft(this,G,null);vt(this,G,q),vt(this,T,nt),z(this,T)._on("editingaction",z(this,at)),z(this,T)._on("pagechanging",z(this,B)),z(this,T)._on("scalechanging",z(this,O)),z(this,T)._on("rotationchanging",z(this,D)),vt(this,y,tt),this.viewParameters={realScale:s.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){gt(this,$,fe).call(this),z(this,T)._off("editingaction",z(this,at)),z(this,T)._off("pagechanging",z(this,B)),z(this,T)._off("scalechanging",z(this,O)),z(this,T)._off("rotationchanging",z(this,D));for(const q of z(this,w).values())q.destroy();z(this,w).clear(),z(this,u).clear(),z(this,k).clear(),vt(this,F,null),z(this,lt).clear(),z(this,l).destroy()}onPageChanging({pageNumber:q}){vt(this,h,q-1)}focusMainContainer(){z(this,G).focus()}addShouldRescale(q){z(this,k).add(q)}removeShouldRescale(q){z(this,k).delete(q)}onScaleChanging({scale:q}){this.commitOrRemove(),this.viewParameters.realScale=q*s.PixelsPerInch.PDF_TO_CSS_UNITS;for(const nt of z(this,k))nt.onScaleChanging()}onRotationChanging({pagesRotation:q}){this.commitOrRemove(),this.viewParameters.rotation=q}addToAnnotationStorage(q){!q.isEmpty()&&z(this,y)&&!z(this,y).has(q.id)&&z(this,y).setValue(q.id,q)}copy(q){if(q.preventDefault(),z(this,F)&&z(this,F).commitOrRemove(),!this.hasSelection)return;const nt=[];for(const tt of z(this,lt))tt.isEmpty()||nt.push(tt.serialize());nt.length!==0&&q.clipboardData.setData("application/pdfjs",JSON.stringify(nt))}cut(q){this.copy(q),this.delete()}paste(q){q.preventDefault();let nt=q.clipboardData.getData("application/pdfjs");if(!nt)return;try{nt=JSON.parse(nt)}catch(_t){(0,r.warn)(`paste: "${_t.message}".`);return}if(!Array.isArray(nt))return;this.unselectAll();const tt=z(this,w).get(z(this,h));try{const _t=[];for(const bt of nt){const St=tt.deserialize(bt);if(!St)return;_t.push(St)}const Et=()=>{for(const bt of _t)gt(this,rt,pe).call(this,bt);gt(this,mt,me).call(this,_t)},ut=()=>{for(const bt of _t)bt.remove()};this.addCommands({cmd:Et,undo:ut,mustExec:!0})}catch(_t){(0,r.warn)(`paste: "${_t.message}".`)}}keydown(q){var nt;(nt=this.getActive())!=null&&nt.shouldGetKeyboardEvents()||yt._keyboardManager.exec(this,q)}onEditingAction(q){["undo","redo","delete","selectAll"].includes(q.name)&&this[q.name]()}setEditingState(q){q?(gt(this,H,Oe).call(this),gt(this,it,Ie).call(this),gt(this,v,Ut).call(this,{isEditing:z(this,V)!==r.AnnotationEditorType.NONE,isEmpty:gt(this,st,Jt).call(this),hasSomethingToUndo:z(this,l).hasSomethingToUndo(),hasSomethingToRedo:z(this,l).hasSomethingToRedo(),hasSelectedEditor:!1})):(gt(this,$,fe).call(this),gt(this,W,Le).call(this),gt(this,v,Ut).call(this,{isEditing:!1}))}registerEditorTypes(q){if(!z(this,I)){vt(this,I,q);for(const nt of z(this,I))gt(this,A,Zt).call(this,nt.defaultPropertiesToUpdate)}}getId(){return z(this,U).getId()}get currentLayer(){return z(this,w).get(z(this,h))}get currentPageIndex(){return z(this,h)}addLayer(q){z(this,w).set(q.pageIndex,q),z(this,_)?q.enable():q.disable()}removeLayer(q){z(this,w).delete(q.pageIndex)}updateMode(q){if(vt(this,V,q),q===r.AnnotationEditorType.NONE)this.setEditingState(!1),gt(this,K,Be).call(this);else{this.setEditingState(!0),gt(this,j,Ne).call(this);for(const nt of z(this,w).values())nt.updateMode(q)}}updateToolbar(q){q!==z(this,V)&&z(this,T).dispatch("switchannotationeditormode",{source:this,mode:q})}updateParams(q,nt){if(z(this,I)){for(const tt of z(this,lt))tt.updateParams(q,nt);for(const tt of z(this,I))tt.updateDefaultParams(q,nt)}}getEditors(q){const nt=[];for(const tt of z(this,u).values())tt.pageIndex===q&&nt.push(tt);return nt}getEditor(q){return z(this,u).get(q)}addEditor(q){z(this,u).set(q.id,q)}removeEditor(q){var nt;z(this,u).delete(q.id),this.unselect(q),(nt=z(this,y))==null||nt.remove(q.id)}setActiveEditor(q){z(this,F)!==q&&(vt(this,F,q),q&&gt(this,A,Zt).call(this,q.propertiesToUpdate))}toggleSelected(q){if(z(this,lt).has(q)){z(this,lt).delete(q),q.unselect(),gt(this,v,Ut).call(this,{hasSelectedEditor:this.hasSelection});return}z(this,lt).add(q),q.select(),gt(this,A,Zt).call(this,q.propertiesToUpdate),gt(this,v,Ut).call(this,{hasSelectedEditor:!0})}setSelected(q){for(const nt of z(this,lt))nt!==q&&nt.unselect();z(this,lt).clear(),z(this,lt).add(q),q.select(),gt(this,A,Zt).call(this,q.propertiesToUpdate),gt(this,v,Ut).call(this,{hasSelectedEditor:!0})}isSelected(q){return z(this,lt).has(q)}unselect(q){q.unselect(),z(this,lt).delete(q),gt(this,v,Ut).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return z(this,lt).size!==0}undo(){z(this,l).undo(),gt(this,v,Ut).call(this,{hasSomethingToUndo:z(this,l).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:gt(this,st,Jt).call(this)})}redo(){z(this,l).redo(),gt(this,v,Ut).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:z(this,l).hasSomethingToRedo(),isEmpty:gt(this,st,Jt).call(this)})}addCommands(q){z(this,l).add(q),gt(this,v,Ut).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:gt(this,st,Jt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const q=[...z(this,lt)],nt=()=>{for(const _t of q)_t.remove()},tt=()=>{for(const _t of q)gt(this,rt,pe).call(this,_t)};this.addCommands({cmd:nt,undo:tt,mustExec:!0})}commitOrRemove(){var q;(q=z(this,F))==null||q.commitOrRemove()}selectAll(){for(const q of z(this,lt))q.commit();gt(this,mt,me).call(this,z(this,u).values())}unselectAll(){if(z(this,F)){z(this,F).commitOrRemove();return}if(z(this,lt).size!==0){for(const q of z(this,lt))q.unselect();z(this,lt).clear(),gt(this,v,Ut).call(this,{hasSelectedEditor:!1})}}isActive(q){return z(this,F)===q}getActive(){return z(this,F)}getMode(){return z(this,V)}};let M=yt;F=new WeakMap,u=new WeakMap,w=new WeakMap,y=new WeakMap,l=new WeakMap,h=new WeakMap,I=new WeakMap,k=new WeakMap,T=new WeakMap,U=new WeakMap,_=new WeakMap,V=new WeakMap,lt=new WeakMap,J=new WeakMap,ct=new WeakMap,et=new WeakMap,pt=new WeakMap,at=new WeakMap,B=new WeakMap,O=new WeakMap,D=new WeakMap,N=new WeakMap,G=new WeakMap,H=new WeakSet,Oe=function(){z(this,G).addEventListener("keydown",z(this,pt))},$=new WeakSet,fe=function(){z(this,G).removeEventListener("keydown",z(this,pt))},it=new WeakSet,Ie=function(){document.addEventListener("copy",z(this,J)),document.addEventListener("cut",z(this,ct)),document.addEventListener("paste",z(this,et))},W=new WeakSet,Le=function(){document.removeEventListener("copy",z(this,J)),document.removeEventListener("cut",z(this,ct)),document.removeEventListener("paste",z(this,et))},v=new WeakSet,Ut=function(q){Object.entries(q).some(([tt,_t])=>z(this,N)[tt]!==_t)&&z(this,T).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(z(this,N),q)})},A=new WeakSet,Zt=function(q){z(this,T).dispatch("annotationeditorparamschanged",{source:this,details:q})},j=new WeakSet,Ne=function(){if(!z(this,_)){vt(this,_,!0);for(const q of z(this,w).values())q.enable()}},K=new WeakSet,Be=function(){if(this.unselectAll(),z(this,_)){vt(this,_,!1);for(const q of z(this,w).values())q.disable()}},rt=new WeakSet,pe=function(q){const nt=z(this,w).get(q.pageIndex);nt?nt.addOrRebuild(q):this.addEditor(q)},st=new WeakSet,Jt=function(){if(z(this,u).size===0)return!0;if(z(this,u).size===1)for(const q of z(this,u).values())return q.isEmpty();return!1},mt=new WeakSet,me=function(q){z(this,lt).clear();for(const nt of q)nt.isEmpty()||(z(this,lt).add(nt),nt.select());gt(this,v,Ut).call(this,{hasSelectedEditor:!0})},Dt(M,"_keyboardManager",new C([[["ctrl+a","mac+meta+a"],yt.prototype.selectAll],[["ctrl+z","mac+meta+z"],yt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],yt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],yt.prototype.delete],[["Escape","mac+Escape"],yt.prototype.unselectAll]])),t.AnnotationEditorUIManager=M},(x,t,e)=>{var J,ct,et,pt,at,B,O,D,N,Gt,H,$t,$,Wt;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=t.AnnotationPrefix=void 0,t.deprecated=y,t.getColorValues=T,t.getCurrentTransform=U,t.getCurrentTransformInverse=_,t.getFilenameFromUrl=R,t.getPdfFilenameFromUrl=L,t.getRGB=k,t.getXfaPageViewport=I,t.isDataScheme=a,t.isPdfFile=o,t.isValidFetchUrl=u,t.loadScript=w,t.setLayerDimensions=V;var r=e(7),s=e(1);const i="http://www.w3.org/2000/svg",p="pdfjs_internal_id_";t.AnnotationPrefix=p;const lt=class{};let g=lt;Dt(g,"CSS",96),Dt(g,"PDF",72),Dt(g,"PDF_TO_CSS_UNITS",lt.CSS/lt.PDF),t.PixelsPerInch=g;class m extends r.BaseFilterFactory{constructor({docId:W,ownerDocument:n=globalThis.document}={}){super();ft(this,N);ft(this,H);ft(this,$);ft(this,J,void 0);ft(this,ct,void 0);ft(this,et,void 0);ft(this,pt,void 0);ft(this,at,void 0);ft(this,B,void 0);ft(this,O,void 0);ft(this,D,0);vt(this,et,W),vt(this,pt,n)}addFilter(W){if(!W)return"none";let n=z(this,N,Gt).get(W);if(n)return n;let v,P,A,E;if(W.length===1){const rt=W[0],ht=new Array(256);for(let st=0;st<256;st++)ht[st]=rt[st]/255;E=v=P=A=ht.join(",")}else{const[rt,ht,st]=W,dt=new Array(256),mt=new Array(256),At=new Array(256);for(let yt=0;yt<256;yt++)dt[yt]=rt[yt]/255,mt[yt]=ht[yt]/255,At[yt]=st[yt]/255;v=dt.join(","),P=mt.join(","),A=At.join(","),E=`${v}${P}${A}`}if(n=z(this,N,Gt).get(E),n)return z(this,N,Gt).set(W,n),n;const j=`g_${z(this,et)}_transfer_map_${se(this,D)._++}`,Q=`url(#${j})`;z(this,N,Gt).set(W,Q),z(this,N,Gt).set(E,Q);const K=z(this,pt).createElementNS(i,"filter",i);K.setAttribute("id",j),K.setAttribute("color-interpolation-filters","sRGB");const X=z(this,pt).createElementNS(i,"feComponentTransfer");return K.append(X),gt(this,$,Wt).call(this,X,"feFuncR",v),gt(this,$,Wt).call(this,X,"feFuncG",P),gt(this,$,Wt).call(this,X,"feFuncB",A),z(this,H,$t).append(K),Q}addHCMFilter(W,n){var st;const v=`${W}-${n}`;if(z(this,B)===v)return z(this,O);if(vt(this,B,v),vt(this,O,"none"),(st=z(this,at))==null||st.remove(),!W||!n)return z(this,O);z(this,H,$t).style.color=W,W=getComputedStyle(z(this,H,$t)).getPropertyValue("color");const P=k(W);W=s.Util.makeHexColor(...P),z(this,H,$t).style.color=n,n=getComputedStyle(z(this,H,$t)).getPropertyValue("color");const A=k(n);if(n=s.Util.makeHexColor(...A),z(this,H,$t).style.color="",W==="#000000"&&n==="#ffffff"||W===n)return z(this,O);const E=new Array(256);for(let dt=0;dt<=255;dt++){const mt=dt/255;E[dt]=mt<=.03928?mt/12.92:((mt+.055)/1.055)**2.4}const j=E.join(","),Q=`g_${z(this,et)}_hcm_filter`,K=vt(this,at,z(this,pt).createElementNS(i,"filter",i));K.setAttribute("id",Q),K.setAttribute("color-interpolation-filters","sRGB");let X=z(this,pt).createElementNS(i,"feComponentTransfer");K.append(X),gt(this,$,Wt).call(this,X,"feFuncR",j),gt(this,$,Wt).call(this,X,"feFuncG",j),gt(this,$,Wt).call(this,X,"feFuncB",j);const rt=z(this,pt).createElementNS(i,"feColorMatrix");rt.setAttribute("type","matrix"),rt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),K.append(rt),X=z(this,pt).createElementNS(i,"feComponentTransfer"),K.append(X);const ht=(dt,mt)=>{const At=P[dt]/255,yt=A[dt]/255,wt=new Array(mt+1);for(let q=0;q<=mt;q++)wt[q]=At+q/mt*(yt-At);return wt.join(",")};return gt(this,$,Wt).call(this,X,"feFuncR",ht(0,5)),gt(this,$,Wt).call(this,X,"feFuncG",ht(1,5)),gt(this,$,Wt).call(this,X,"feFuncB",ht(2,5)),z(this,H,$t).append(K),vt(this,O,`url(#${Q})`),z(this,O)}destroy(W=!1){W&&z(this,O)||(z(this,ct)&&(z(this,ct).parentNode.parentNode.remove(),vt(this,ct,null)),z(this,J)&&(z(this,J).clear(),vt(this,J,null)),vt(this,D,0))}}J=new WeakMap,ct=new WeakMap,et=new WeakMap,pt=new WeakMap,at=new WeakMap,B=new WeakMap,O=new WeakMap,D=new WeakMap,N=new WeakSet,Gt=function(){return z(this,J)||vt(this,J,new Map)},H=new WeakSet,$t=function(){if(!z(this,ct)){const W=z(this,pt).createElement("div"),{style:n}=W;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const v=z(this,pt).createElementNS(i,"svg");v.setAttribute("width",0),v.setAttribute("height",0),vt(this,ct,z(this,pt).createElementNS(i,"defs")),W.append(v),v.append(z(this,ct)),z(this,pt).body.append(W)}return z(this,ct)},$=new WeakSet,Wt=function(W,n,v){const P=z(this,pt).createElementNS(i,n);P.setAttribute("type","discrete"),P.setAttribute("tableValues",v),W.append(P)},t.DOMFilterFactory=m;class C extends r.BaseCanvasFactory{constructor({ownerDocument:Y=globalThis.document}={}){super(),this._document=Y}_createCanvas(Y,W){const n=this._document.createElement("canvas");return n.width=Y,n.height=W,n}}t.DOMCanvasFactory=C;async function b(it,Y=!1){if(u(it,document.baseURI)){const W=await fetch(it);if(!W.ok)throw new Error(W.statusText);return Y?new Uint8Array(await W.arrayBuffer()):(0,s.stringToBytes)(await W.text())}return new Promise((W,n)=>{const v=new XMLHttpRequest;v.open("GET",it,!0),Y&&(v.responseType="arraybuffer"),v.onreadystatechange=()=>{if(v.readyState===XMLHttpRequest.DONE){if(v.status===200||v.status===0){let P;if(Y&&v.response?P=new Uint8Array(v.response):!Y&&v.responseText&&(P=(0,s.stringToBytes)(v.responseText)),P){W(P);return}}n(new Error(v.statusText))}},v.send(null)})}class M extends r.BaseCMapReaderFactory{_fetchData(Y,W){return b(Y,this.isCompressed).then(n=>({cMapData:n,compressionType:W}))}}t.DOMCMapReaderFactory=M;class S extends r.BaseStandardFontDataFactory{_fetchData(Y){return b(Y,!0)}}t.DOMStandardFontDataFactory=S;class d extends r.BaseSVGFactory{_createSVG(Y){return document.createElementNS(i,Y)}}t.DOMSVGFactory=d;class f{constructor({viewBox:Y,scale:W,rotation:n,offsetX:v=0,offsetY:P=0,dontFlip:A=!1}){this.viewBox=Y,this.scale=W,this.rotation=n,this.offsetX=v,this.offsetY=P;const E=(Y[2]+Y[0])/2,j=(Y[3]+Y[1])/2;let Q,K,X,rt;switch(n%=360,n<0&&(n+=360),n){case 180:Q=-1,K=0,X=0,rt=1;break;case 90:Q=0,K=1,X=1,rt=0;break;case 270:Q=0,K=-1,X=-1,rt=0;break;case 0:Q=1,K=0,X=0,rt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}A&&(X=-X,rt=-rt);let ht,st,dt,mt;Q===0?(ht=Math.abs(j-Y[1])*W+v,st=Math.abs(E-Y[0])*W+P,dt=(Y[3]-Y[1])*W,mt=(Y[2]-Y[0])*W):(ht=Math.abs(E-Y[0])*W+v,st=Math.abs(j-Y[1])*W+P,dt=(Y[2]-Y[0])*W,mt=(Y[3]-Y[1])*W),this.transform=[Q*W,K*W,X*W,rt*W,ht-Q*W*E-X*W*j,st-K*W*E-rt*W*j],this.width=dt,this.height=mt}get rawDims(){const{viewBox:Y}=this;return(0,s.shadow)(this,"rawDims",{pageWidth:Y[2]-Y[0],pageHeight:Y[3]-Y[1],pageX:Y[0],pageY:Y[1]})}clone({scale:Y=this.scale,rotation:W=this.rotation,offsetX:n=this.offsetX,offsetY:v=this.offsetY,dontFlip:P=!1}={}){return new f({viewBox:this.viewBox.slice(),scale:Y,rotation:W,offsetX:n,offsetY:v,dontFlip:P})}convertToViewportPoint(Y,W){return s.Util.applyTransform([Y,W],this.transform)}convertToViewportRectangle(Y){const W=s.Util.applyTransform([Y[0],Y[1]],this.transform),n=s.Util.applyTransform([Y[2],Y[3]],this.transform);return[W[0],W[1],n[0],n[1]]}convertToPdfPoint(Y,W){return s.Util.applyInverseTransform([Y,W],this.transform)}}t.PageViewport=f;class c extends s.BaseException{constructor(Y,W,n=0){super(Y,"RenderingCancelledException"),this.type=W,this.extraDelay=n}}t.RenderingCancelledException=c;function a(it){const Y=it.length;let W=0;for(;W<Y&&it[W].trim()==="";)W++;return it.substring(W,W+5).toLowerCase()==="data:"}function o(it){return typeof it=="string"&&/\.pdf$/i.test(it)}function R(it,Y=!1){return Y||([it]=it.split(/[#?]/,1)),it.substring(it.lastIndexOf("/")+1)}function L(it,Y="document.pdf"){if(typeof it!="string")return Y;if(a(it))return(0,s.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Y;const W=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,v=W.exec(it);let P=n.exec(v[1])||n.exec(v[2])||n.exec(v[3]);if(P&&(P=P[0],P.includes("%")))try{P=n.exec(decodeURIComponent(P))[0]}catch{}return P||Y}class F{constructor(){Dt(this,"started",Object.create(null));Dt(this,"times",[])}time(Y){Y in this.started&&(0,s.warn)(`Timer is already running for ${Y}`),this.started[Y]=Date.now()}timeEnd(Y){Y in this.started||(0,s.warn)(`Timer has not been started for ${Y}`),this.times.push({name:Y,start:this.started[Y],end:Date.now()}),delete this.started[Y]}toString(){const Y=[];let W=0;for(const{name:n}of this.times)W=Math.max(n.length,W);for(const{name:n,start:v,end:P}of this.times)Y.push(`${n.padEnd(W)} ${P-v}ms
`);return Y.join("")}}t.StatTimer=F;function u(it,Y){try{const{protocol:W}=Y?new URL(it,Y):new URL(it);return W==="http:"||W==="https:"}catch{return!1}}function w(it,Y=!1){return new Promise((W,n)=>{const v=document.createElement("script");v.src=it,v.onload=function(P){Y&&v.remove(),W(P)},v.onerror=function(){n(new Error(`Cannot load script at: ${v.src}`))},(document.head||document.documentElement).append(v)})}function y(it){console.log("Deprecated API usage: "+it)}let l;class h{static toDateObject(Y){if(!Y||typeof Y!="string")return null;l||(l=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const W=l.exec(Y);if(!W)return null;const n=parseInt(W[1],10);let v=parseInt(W[2],10);v=v>=1&&v<=12?v-1:0;let P=parseInt(W[3],10);P=P>=1&&P<=31?P:1;let A=parseInt(W[4],10);A=A>=0&&A<=23?A:0;let E=parseInt(W[5],10);E=E>=0&&E<=59?E:0;let j=parseInt(W[6],10);j=j>=0&&j<=59?j:0;const Q=W[7]||"Z";let K=parseInt(W[8],10);K=K>=0&&K<=23?K:0;let X=parseInt(W[9],10)||0;return X=X>=0&&X<=59?X:0,Q==="-"?(A+=K,E+=X):Q==="+"&&(A-=K,E-=X),new Date(Date.UTC(n,v,P,A,E,j))}}t.PDFDateString=h;function I(it,{scale:Y=1,rotation:W=0}){const{width:n,height:v}=it.attributes.style,P=[0,0,parseInt(n),parseInt(v)];return new f({viewBox:P,scale:Y,rotation:W})}function k(it){if(it.startsWith("#")){const Y=parseInt(it.slice(1),16);return[(Y&16711680)>>16,(Y&65280)>>8,Y&255]}return it.startsWith("rgb(")?it.slice(4,-1).split(",").map(Y=>parseInt(Y)):it.startsWith("rgba(")?it.slice(5,-1).split(",").map(Y=>parseInt(Y)).slice(0,3):((0,s.warn)(`Not a valid color format: "${it}"`),[0,0,0])}function T(it){const Y=document.createElement("span");Y.style.visibility="hidden",document.body.append(Y);for(const W of it.keys()){Y.style.color=W;const n=window.getComputedStyle(Y).color;it.set(W,k(n))}Y.remove()}function U(it){const{a:Y,b:W,c:n,d:v,e:P,f:A}=it.getTransform();return[Y,W,n,v,P,A]}function _(it){const{a:Y,b:W,c:n,d:v,e:P,f:A}=it.getTransform().invertSelf();return[Y,W,n,v,P,A]}function V(it,Y,W=!1,n=!0){if(Y instanceof f){const{pageWidth:v,pageHeight:P}=Y.rawDims,{style:A}=it,E=`calc(var(--scale-factor) * ${v}px)`,j=`calc(var(--scale-factor) * ${P}px)`;!W||Y.rotation%180===0?(A.width=E,A.height=j):(A.width=j,A.height=E)}n&&it.setAttribute("data-main-rotation",Y.rotation)}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var r=e(1);class s{constructor(){this.constructor===s&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(b){return"none"}addHCMFilter(b,M){return"none"}destroy(b=!1){}}t.BaseFilterFactory=s;class i{constructor(){this.constructor===i&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(b,M){if(b<=0||M<=0)throw new Error("Invalid canvas size");const S=this._createCanvas(b,M);return{canvas:S,context:S.getContext("2d")}}reset(b,M,S){if(!b.canvas)throw new Error("Canvas is not specified");if(M<=0||S<=0)throw new Error("Invalid canvas size");b.canvas.width=M,b.canvas.height=S}destroy(b){if(!b.canvas)throw new Error("Canvas is not specified");b.canvas.width=0,b.canvas.height=0,b.canvas=null,b.context=null}_createCanvas(b,M){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=i;class p{constructor({baseUrl:b=null,isCompressed:M=!0}){this.constructor===p&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=b,this.isCompressed=M}async fetch({name:b}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!b)throw new Error("CMap name must be specified.");const M=this.baseUrl+b+(this.isCompressed?".bcmap":""),S=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(M,S).catch(d=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${M}`)})}_fetchData(b,M){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=p;class g{constructor({baseUrl:b=null}){this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=b}async fetch({filename:b}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!b)throw new Error("Font filename must be specified.");const M=`${this.baseUrl}${b}`;return this._fetchData(M).catch(S=>{throw new Error(`Unable to load font data at: ${M}`)})}_fetchData(b){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=g;class m{constructor(){this.constructor===m&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(b,M,S=!1){if(b<=0||M<=0)throw new Error("Invalid SVG dimensions");const d=this._createSVG("svg:svg");return d.setAttribute("version","1.1"),S||(d.setAttribute("width",`${b}px`),d.setAttribute("height",`${M}px`)),d.setAttribute("preserveAspectRatio","none"),d.setAttribute("viewBox",`0 0 ${b} ${M}`),d}createElement(b){if(typeof b!="string")throw new Error("Invalid SVG element type");return this._createSVG(b)}_createSVG(b){(0,r.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=m},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var r=e(1);const s=3285377520,i=4294901760,p=65535;class g{constructor(C){this.h1=C?C&4294967295:s,this.h2=C?C&4294967295:s}update(C){let b,M;if(typeof C=="string"){b=new Uint8Array(C.length*2),M=0;for(let y=0,l=C.length;y<l;y++){const h=C.charCodeAt(y);h<=255?b[M++]=h:(b[M++]=h>>>8,b[M++]=h&255)}}else if((0,r.isArrayBuffer)(C))b=C.slice(),M=b.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const S=M>>2,d=M-S*4,f=new Uint32Array(b.buffer,0,S);let c=0,a=0,o=this.h1,R=this.h2;const L=3432918353,F=461845907,u=L&p,w=F&p;for(let y=0;y<S;y++)y&1?(c=f[y],c=c*L&i|c*u&p,c=c<<15|c>>>17,c=c*F&i|c*w&p,o^=c,o=o<<13|o>>>19,o=o*5+3864292196):(a=f[y],a=a*L&i|a*u&p,a=a<<15|a>>>17,a=a*F&i|a*w&p,R^=a,R=R<<13|R>>>19,R=R*5+3864292196);switch(c=0,d){case 3:c^=b[S*4+2]<<16;case 2:c^=b[S*4+1]<<8;case 1:c^=b[S*4],c=c*L&i|c*u&p,c=c<<15|c>>>17,c=c*F&i|c*w&p,S&1?o^=c:R^=c}this.h1=o,this.h2=R}hexdigest(){let C=this.h1,b=this.h2;return C^=b>>>1,C=C*3981806797&i|C*36045&p,b=b*4283543511&i|((b<<16|C>>>16)*2950163797&i)>>>16,C^=b>>>1,C=C*444984403&i|C*60499&p,b=b*3301882366&i|((b<<16|C>>>16)*3120437893&i)>>>16,C^=b>>>1,(C>>>0).toString(16).padStart(8,"0")+(b>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=g},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var r=e(1),s=e(10);class i{constructor({ownerDocument:m=globalThis.document,styleElement:C=null}){this._document=m,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(m){this.nativeFontFaces.push(m),this._document.fonts.add(m)}insertRule(m){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const C=this.styleElement.sheet;C.insertRule(m,C.cssRules.length)}clear(){for(const m of this.nativeFontFaces)this._document.fonts.delete(m);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(m){if(m.attached||m.missingFile)return;if(m.attached=!0,this.isFontLoadingAPISupported){const b=m.createNativeFontFace();if(b){this.addNativeFontFace(b);try{await b.loaded}catch(M){throw(0,r.warn)(`Failed to load font '${b.family}': '${M}'.`),m.disableFontFace=!0,M}}return}const C=m.createFontFaceRule();if(C){if(this.insertRule(C),this.isSyncFontLoadingSupported)return;await new Promise(b=>{const M=this._queueLoadingCallback(b);this._prepareFontLoadEvent(m,M)})}}get isFontLoadingAPISupported(){var C;const m=!!((C=this._document)!=null&&C.fonts);return(0,r.shadow)(this,"isFontLoadingAPISupported",m)}get isSyncFontLoadingSupported(){let m=!1;return(s.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(m=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",m)}_queueLoadingCallback(m){function C(){for((0,r.assert)(!M.done,"completeRequest() cannot be called twice."),M.done=!0;b.length>0&&b[0].done;){const S=b.shift();setTimeout(S.callback,0)}}const{loadingRequests:b}=this,M={done:!1,complete:C,callback:m};return b.push(M),M}get _loadTestFont(){const m=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",m)}_prepareFontLoadEvent(m,C){function b(k,T){return k.charCodeAt(T)<<24|k.charCodeAt(T+1)<<16|k.charCodeAt(T+2)<<8|k.charCodeAt(T+3)&255}function M(k,T,U,_){const V=k.substring(0,T),lt=k.substring(T+U);return V+_+lt}let S,d;const f=this._document.createElement("canvas");f.width=1,f.height=1;const c=f.getContext("2d");let a=0;function o(k,T){if(++a>30){(0,r.warn)("Load test font never loaded."),T();return}if(c.font="30px "+k,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(o.bind(null,k,T))}const R=`lt${Date.now()}${this.loadTestFontId++}`;let L=this._loadTestFont;L=M(L,976,R.length,R);const u=16,w=1482184792;let y=b(L,u);for(S=0,d=R.length-3;S<d;S+=4)y=y-w+b(R,S)|0;S<R.length&&(y=y-w+b(R+"XXX",S)|0),L=M(L,u,4,(0,r.string32)(y));const l=`url(data:font/opentype;base64,${btoa(L)});`,h=`@font-face {font-family:"${R}";src:${l}}`;this.insertRule(h);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const k of[m.loadedName,R]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=k,I.append(T)}this._document.body.append(I),o(R,()=>{I.remove(),C.complete()})}}t.FontLoader=i;class p{constructor(m,{isEvalSupported:C=!0,disableFontFace:b=!1,ignoreErrors:M=!1,inspectFont:S=null}){this.compiledGlyphs=Object.create(null);for(const d in m)this[d]=m[d];this.isEvalSupported=C!==!1,this.disableFontFace=b===!0,this.ignoreErrors=M===!0,this._inspectFont=S}createNativeFontFace(){var C;if(!this.data||this.disableFontFace)return null;let m;if(!this.cssFontInfo)m=new FontFace(this.loadedName,this.data,{});else{const b={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(b.style=`oblique ${this.cssFontInfo.italicAngle}deg`),m=new FontFace(this.cssFontInfo.fontFamily,this.data,b)}return(C=this._inspectFont)==null||C.call(this,this),m}createFontFaceRule(){var M;if(!this.data||this.disableFontFace)return null;const m=(0,r.bytesToString)(this.data),C=`url(data:${this.mimetype};base64,${btoa(m)});`;let b;if(!this.cssFontInfo)b=`@font-face {font-family:"${this.loadedName}";src:${C}}`;else{let S=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(S+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),b=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${S}src:${C}}`}return(M=this._inspectFont)==null||M.call(this,this,C),b}getPathGenerator(m,C){if(this.compiledGlyphs[C]!==void 0)return this.compiledGlyphs[C];let b;try{b=m.get(this.loadedName+"_path_"+C)}catch(M){if(!this.ignoreErrors)throw M;return(0,r.warn)(`getPathGenerator - ignoring character: "${M}".`),this.compiledGlyphs[C]=function(S,d){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const M=[];for(const S of b){const d=S.args!==void 0?S.args.join(","):"";M.push("c.",S.cmd,"(",d,`);
`)}return this.compiledGlyphs[C]=new Function("c","size",M.join(""))}return this.compiledGlyphs[C]=function(M,S){for(const d of b)d.cmd==="scale"&&(d.args=[S,-S]),M[d.cmd].apply(M,d.args)}}}t.FontFaceObject=p},(x,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=e},(x,t,e)=>{var et,ge;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var r=e(1),s=e(6),i=e(12),p=e(13),g=e(10);const m=16,C=100,b=4096,M=15,S=10,d=1e3,f=16;function c(B,O){if(B._removeMirroring)throw new Error("Context is already forwarding operations.");B.__originalSave=B.save,B.__originalRestore=B.restore,B.__originalRotate=B.rotate,B.__originalScale=B.scale,B.__originalTranslate=B.translate,B.__originalTransform=B.transform,B.__originalSetTransform=B.setTransform,B.__originalResetTransform=B.resetTransform,B.__originalClip=B.clip,B.__originalMoveTo=B.moveTo,B.__originalLineTo=B.lineTo,B.__originalBezierCurveTo=B.bezierCurveTo,B.__originalRect=B.rect,B.__originalClosePath=B.closePath,B.__originalBeginPath=B.beginPath,B._removeMirroring=()=>{B.save=B.__originalSave,B.restore=B.__originalRestore,B.rotate=B.__originalRotate,B.scale=B.__originalScale,B.translate=B.__originalTranslate,B.transform=B.__originalTransform,B.setTransform=B.__originalSetTransform,B.resetTransform=B.__originalResetTransform,B.clip=B.__originalClip,B.moveTo=B.__originalMoveTo,B.lineTo=B.__originalLineTo,B.bezierCurveTo=B.__originalBezierCurveTo,B.rect=B.__originalRect,B.closePath=B.__originalClosePath,B.beginPath=B.__originalBeginPath,delete B._removeMirroring},B.save=function(){O.save(),this.__originalSave()},B.restore=function(){O.restore(),this.__originalRestore()},B.translate=function(N,G){O.translate(N,G),this.__originalTranslate(N,G)},B.scale=function(N,G){O.scale(N,G),this.__originalScale(N,G)},B.transform=function(N,G,H,Z,$,ot){O.transform(N,G,H,Z,$,ot),this.__originalTransform(N,G,H,Z,$,ot)},B.setTransform=function(N,G,H,Z,$,ot){O.setTransform(N,G,H,Z,$,ot),this.__originalSetTransform(N,G,H,Z,$,ot)},B.resetTransform=function(){O.resetTransform(),this.__originalResetTransform()},B.rotate=function(N){O.rotate(N),this.__originalRotate(N)},B.clip=function(N){O.clip(N),this.__originalClip(N)},B.moveTo=function(D,N){O.moveTo(D,N),this.__originalMoveTo(D,N)},B.lineTo=function(D,N){O.lineTo(D,N),this.__originalLineTo(D,N)},B.bezierCurveTo=function(D,N,G,H,Z,$){O.bezierCurveTo(D,N,G,H,Z,$),this.__originalBezierCurveTo(D,N,G,H,Z,$)},B.rect=function(D,N,G,H){O.rect(D,N,G,H),this.__originalRect(D,N,G,H)},B.closePath=function(){O.closePath(),this.__originalClosePath()},B.beginPath=function(){O.beginPath(),this.__originalBeginPath()}}class a{constructor(O){this.canvasFactory=O,this.cache=Object.create(null)}getCanvas(O,D,N){let G;return this.cache[O]!==void 0?(G=this.cache[O],this.canvasFactory.reset(G,D,N)):(G=this.canvasFactory.create(D,N),this.cache[O]=G),G}delete(O){delete this.cache[O]}clear(){for(const O in this.cache){const D=this.cache[O];this.canvasFactory.destroy(D),delete this.cache[O]}}}function o(B,O,D,N,G,H,Z,$,ot,it){const[Y,W,n,v,P,A]=(0,s.getCurrentTransform)(B);if(W===0&&n===0){const Q=Z*Y+P,K=Math.round(Q),X=$*v+A,rt=Math.round(X),ht=(Z+ot)*Y+P,st=Math.abs(Math.round(ht)-K)||1,dt=($+it)*v+A,mt=Math.abs(Math.round(dt)-rt)||1;return B.setTransform(Math.sign(Y),0,0,Math.sign(v),K,rt),B.drawImage(O,D,N,G,H,0,0,st,mt),B.setTransform(Y,W,n,v,P,A),[st,mt]}if(Y===0&&v===0){const Q=$*n+P,K=Math.round(Q),X=Z*W+A,rt=Math.round(X),ht=($+it)*n+P,st=Math.abs(Math.round(ht)-K)||1,dt=(Z+ot)*W+A,mt=Math.abs(Math.round(dt)-rt)||1;return B.setTransform(0,Math.sign(W),Math.sign(n),0,K,rt),B.drawImage(O,D,N,G,H,0,0,mt,st),B.setTransform(Y,W,n,v,P,A),[mt,st]}B.drawImage(O,D,N,G,H,Z,$,ot,it);const E=Math.hypot(Y,W),j=Math.hypot(n,v);return[E*ot,j*it]}function R(B){const{width:O,height:D}=B;if(O>d||D>d)return null;const N=1e3,G=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),H=O+1;let Z=new Uint8Array(H*(D+1)),$,ot,it;const Y=O+7&-8;let W=new Uint8Array(Y*D),n=0;for(const j of B.data){let Q=128;for(;Q>0;)W[n++]=j&Q?0:255,Q>>=1}let v=0;for(n=0,W[n]!==0&&(Z[0]=1,++v),ot=1;ot<O;ot++)W[n]!==W[n+1]&&(Z[ot]=W[n]?2:1,++v),n++;for(W[n]!==0&&(Z[ot]=2,++v),$=1;$<D;$++){n=$*Y,it=$*H,W[n-Y]!==W[n]&&(Z[it]=W[n]?1:8,++v);let j=(W[n]?4:0)+(W[n-Y]?8:0);for(ot=1;ot<O;ot++)j=(j>>2)+(W[n+1]?4:0)+(W[n-Y+1]?8:0),G[j]&&(Z[it+ot]=G[j],++v),n++;if(W[n-Y]!==W[n]&&(Z[it+ot]=W[n]?2:4,++v),v>N)return null}for(n=Y*(D-1),it=$*H,W[n]!==0&&(Z[it]=8,++v),ot=1;ot<O;ot++)W[n]!==W[n+1]&&(Z[it+ot]=W[n]?4:8,++v),n++;if(W[n]!==0&&(Z[it+ot]=4,++v),v>N)return null;const P=new Int32Array([0,H,-1,0,-H,0,0,0,1]),A=new Path2D;for($=0;v&&$<=D;$++){let j=$*H;const Q=j+O;for(;j<Q&&!Z[j];)j++;if(j===Q)continue;A.moveTo(j%H,$);const K=j;let X=Z[j];do{const rt=P[X];do j+=rt;while(!Z[j]);const ht=Z[j];ht!==5&&ht!==10?(X=ht,Z[j]=0):(X=ht&51*X>>4,Z[j]&=X>>2|X<<2),A.lineTo(j%H,j/H|0),Z[j]||--v}while(K!==j);--$}return W=null,Z=null,function(j){j.save(),j.scale(1/O,-1/D),j.translate(0,-D),j.fill(A),j.beginPath(),j.restore()}}class L{constructor(O,D){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,O,D])}clone(){const O=Object.create(this);return O.clipBox=this.clipBox.slice(),O}setCurrentPoint(O,D){this.x=O,this.y=D}updatePathMinMax(O,D,N){[D,N]=r.Util.applyTransform([D,N],O),this.minX=Math.min(this.minX,D),this.minY=Math.min(this.minY,N),this.maxX=Math.max(this.maxX,D),this.maxY=Math.max(this.maxY,N)}updateRectMinMax(O,D){const N=r.Util.applyTransform(D,O),G=r.Util.applyTransform(D.slice(2),O);this.minX=Math.min(this.minX,N[0],G[0]),this.minY=Math.min(this.minY,N[1],G[1]),this.maxX=Math.max(this.maxX,N[0],G[0]),this.maxY=Math.max(this.maxY,N[1],G[1])}updateScalingPathMinMax(O,D){r.Util.scaleMinMax(O,D),this.minX=Math.min(this.minX,D[0]),this.maxX=Math.max(this.maxX,D[1]),this.minY=Math.min(this.minY,D[2]),this.maxY=Math.max(this.maxY,D[3])}updateCurvePathMinMax(O,D,N,G,H,Z,$,ot,it,Y){const W=r.Util.bezierBoundingBox(D,N,G,H,Z,$,ot,it);if(Y){Y[0]=Math.min(Y[0],W[0],W[2]),Y[1]=Math.max(Y[1],W[0],W[2]),Y[2]=Math.min(Y[2],W[1],W[3]),Y[3]=Math.max(Y[3],W[1],W[3]);return}this.updateRectMinMax(O,W)}getPathBoundingBox(O=i.PathType.FILL,D=null){const N=[this.minX,this.minY,this.maxX,this.maxY];if(O===i.PathType.STROKE){D||(0,r.unreachable)("Stroke bounding box must include transform.");const G=r.Util.singularValueDecompose2dScale(D),H=G[0]*this.lineWidth/2,Z=G[1]*this.lineWidth/2;N[0]-=H,N[1]-=Z,N[2]+=H,N[3]+=Z}return N}updateClipFromPath(){const O=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(O||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(O){this.clipBox=O,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(O=i.PathType.FILL,D=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(O,D))}}function F(B,O){if(typeof ImageData<"u"&&O instanceof ImageData){B.putImageData(O,0,0);return}const D=O.height,N=O.width,G=D%f,H=(D-G)/f,Z=G===0?H:H+1,$=B.createImageData(N,f);let ot=0,it;const Y=O.data,W=$.data;let n,v,P,A;if(O.kind===r.ImageKind.GRAYSCALE_1BPP){const E=Y.byteLength,j=new Uint32Array(W.buffer,0,W.byteLength>>2),Q=j.length,K=N+7>>3,X=4294967295,rt=r.FeatureTest.isLittleEndian?4278190080:255;for(n=0;n<Z;n++){for(P=n<H?f:G,it=0,v=0;v<P;v++){const ht=E-ot;let st=0;const dt=ht>K?N:ht*8-7,mt=dt&-8;let At=0,yt=0;for(;st<mt;st+=8)yt=Y[ot++],j[it++]=yt&128?X:rt,j[it++]=yt&64?X:rt,j[it++]=yt&32?X:rt,j[it++]=yt&16?X:rt,j[it++]=yt&8?X:rt,j[it++]=yt&4?X:rt,j[it++]=yt&2?X:rt,j[it++]=yt&1?X:rt;for(;st<dt;st++)At===0&&(yt=Y[ot++],At=128),j[it++]=yt&At?X:rt,At>>=1}for(;it<Q;)j[it++]=0;B.putImageData($,0,n*f)}}else if(O.kind===r.ImageKind.RGBA_32BPP){for(v=0,A=N*f*4,n=0;n<H;n++)W.set(Y.subarray(ot,ot+A)),ot+=A,B.putImageData($,0,v),v+=f;n<Z&&(A=N*G*4,W.set(Y.subarray(ot,ot+A)),B.putImageData($,0,v))}else if(O.kind===r.ImageKind.RGB_24BPP)for(P=f,A=N*P,n=0;n<Z;n++){for(n>=H&&(P=G,A=N*P),it=0,v=A;v--;)W[it++]=Y[ot++],W[it++]=Y[ot++],W[it++]=Y[ot++],W[it++]=255;B.putImageData($,0,n*f)}else throw new Error(`bad image kind: ${O.kind}`)}function u(B,O){if(O.bitmap){B.drawImage(O.bitmap,0,0);return}const D=O.height,N=O.width,G=D%f,H=(D-G)/f,Z=G===0?H:H+1,$=B.createImageData(N,f);let ot=0;const it=O.data,Y=$.data;for(let W=0;W<Z;W++){const n=W<H?f:G;({srcPos:ot}=(0,p.convertBlackAndWhiteToRGBA)({src:it,srcPos:ot,dest:Y,width:N,height:n,nonBlackColor:0})),B.putImageData($,0,W*f)}}function w(B,O){const D=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const N of D)B[N]!==void 0&&(O[N]=B[N]);B.setLineDash!==void 0&&(O.setLineDash(B.getLineDash()),O.lineDashOffset=B.lineDashOffset)}function y(B){B.strokeStyle=B.fillStyle="#000000",B.fillRule="nonzero",B.globalAlpha=1,B.lineWidth=1,B.lineCap="butt",B.lineJoin="miter",B.miterLimit=10,B.globalCompositeOperation="source-over",B.font="10px sans-serif",B.setLineDash!==void 0&&(B.setLineDash([]),B.lineDashOffset=0),g.isNodeJS||(B.filter="none")}function l(B,O,D,N){const G=B.length;for(let H=3;H<G;H+=4){const Z=B[H];if(Z===0)B[H-3]=O,B[H-2]=D,B[H-1]=N;else if(Z<255){const $=255-Z;B[H-3]=B[H-3]*Z+O*$>>8,B[H-2]=B[H-2]*Z+D*$>>8,B[H-1]=B[H-1]*Z+N*$>>8}}}function h(B,O,D){const N=B.length,G=1/255;for(let H=3;H<N;H+=4){const Z=D?D[B[H]]:B[H];O[H]=O[H]*Z*G|0}}function I(B,O,D){const N=B.length;for(let G=3;G<N;G+=4){const H=B[G-3]*77+B[G-2]*152+B[G-1]*28;O[G]=D?O[G]*D[H>>8]>>8:O[G]*H>>16}}function k(B,O,D,N,G,H,Z,$,ot,it,Y){const W=!!H,n=W?H[0]:0,v=W?H[1]:0,P=W?H[2]:0;let A;G==="Luminosity"?A=I:A=h;const j=Math.min(N,Math.ceil(1048576/D));for(let Q=0;Q<N;Q+=j){const K=Math.min(j,N-Q),X=B.getImageData($-it,Q+(ot-Y),D,K),rt=O.getImageData($,Q+ot,D,K);W&&l(X.data,n,v,P),A(X.data,rt.data,Z),O.putImageData(rt,$,Q+ot)}}function T(B,O,D,N){const G=N[0],H=N[1],Z=N[2]-G,$=N[3]-H;Z===0||$===0||(k(O.context,D,Z,$,O.subtype,O.backdrop,O.transferMap,G,H,O.offsetX,O.offsetY),B.save(),B.globalAlpha=1,B.globalCompositeOperation="source-over",B.setTransform(1,0,0,1,0,0),B.drawImage(D.canvas,0,0),B.restore())}function U(B,O){const D=r.Util.singularValueDecompose2dScale(B);D[0]=Math.fround(D[0]),D[1]=Math.fround(D[1]);const N=Math.fround((globalThis.devicePixelRatio||1)*s.PixelsPerInch.PDF_TO_CSS_UNITS);return O!==void 0?O:D[0]<=N||D[1]<=N}const _=["butt","round","square"],V=["miter","round","bevel"],lt={},J={},at=class{constructor(O,D,N,G,H,{optionalContentConfig:Z,markedContentStack:$=null},ot){ft(this,et);this.ctx=O,this.current=new L(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=D,this.objs=N,this.canvasFactory=G,this.filterFactory=H,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=$||[],this.optionalContentConfig=Z,this.cachedCanvases=new a(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ot,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(O,D=null){return typeof O=="string"?O.startsWith("g_")?this.commonObjs.get(O):this.objs.get(O):D}beginDrawing({transform:O,viewport:D,transparency:N=!1,background:G=null}){const H=this.ctx.canvas.width,Z=this.ctx.canvas.height,$=this.ctx.fillStyle;if(this.ctx.fillStyle=G||"#ffffff",this.ctx.fillRect(0,0,H,Z),this.ctx.fillStyle=$,N){const ot=this.cachedCanvases.getCanvas("transparent",H,Z);this.compositeCtx=this.ctx,this.transparentCanvas=ot.canvas,this.ctx=ot.context,this.ctx.save(),this.ctx.transform(...(0,s.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),y(this.ctx),O&&(this.ctx.transform(...O),this.outputScaleX=O[0],this.outputScaleY=O[0]),this.ctx.transform(...D.transform),this.viewportScale=D.scale,this.baseTransform=(0,s.getCurrentTransform)(this.ctx)}executeOperatorList(O,D,N,G){const H=O.argsArray,Z=O.fnArray;let $=D||0;const ot=H.length;if(ot===$)return $;const it=ot-$>S&&typeof N=="function",Y=it?Date.now()+M:0;let W=0;const n=this.commonObjs,v=this.objs;let P;for(;;){if(G!==void 0&&$===G.nextBreakPoint)return G.breakIt($,N),$;if(P=Z[$],P!==r.OPS.dependency)this[P].apply(this,H[$]);else for(const A of H[$]){const E=A.startsWith("g_")?n:v;if(!E.has(A))return E.get(A,N),$}if($++,$===ot)return $;if(it&&++W>S){if(Date.now()>Y)return N(),$;W=0}}}endDrawing(O=null){gt(this,et,ge).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const D of this._cachedBitmapsMap.values()){for(const N of D.values())typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement&&(N.width=N.height=0);D.clear()}if(this._cachedBitmapsMap.clear(),O){const D=this.filterFactory.addHCMFilter(O.foreground,O.background);if(D!=="none"){const N=this.ctx.filter;this.ctx.filter=D,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=N}}}_scaleImage(O,D){const N=O.width,G=O.height;let H=Math.max(Math.hypot(D[0],D[1]),1),Z=Math.max(Math.hypot(D[2],D[3]),1),$=N,ot=G,it="prescale1",Y,W;for(;H>2&&$>1||Z>2&&ot>1;){let n=$,v=ot;H>2&&$>1&&(n=$>=16384?Math.floor($/2)-1||1:Math.ceil($/2),H/=$/n),Z>2&&ot>1&&(v=ot>=16384?Math.floor(ot/2)-1||1:Math.ceil(ot)/2,Z/=ot/v),Y=this.cachedCanvases.getCanvas(it,n,v),W=Y.context,W.clearRect(0,0,n,v),W.drawImage(O,0,0,$,ot,0,0,n,v),O=Y.canvas,$=n,ot=v,it=it==="prescale1"?"prescale2":"prescale1"}return{img:O,paintWidth:$,paintHeight:ot}}_createMaskCanvas(O){const D=this.ctx,{width:N,height:G}=O,H=this.current.fillColor,Z=this.current.patternFill,$=(0,s.getCurrentTransform)(D);let ot,it,Y,W;if((O.bitmap||O.data)&&O.count>1){const st=O.bitmap||O.data.buffer;it=JSON.stringify(Z?$:[$.slice(0,4),H]),ot=this._cachedBitmapsMap.get(st),ot||(ot=new Map,this._cachedBitmapsMap.set(st,ot));const dt=ot.get(it);if(dt&&!Z){const mt=Math.round(Math.min($[0],$[2])+$[4]),At=Math.round(Math.min($[1],$[3])+$[5]);return{canvas:dt,offsetX:mt,offsetY:At}}Y=dt}Y||(W=this.cachedCanvases.getCanvas("maskCanvas",N,G),u(W.context,O));let n=r.Util.transform($,[1/N,0,0,-1/G,0,0]);n=r.Util.transform(n,[1,0,0,1,0,-G]);const v=r.Util.applyTransform([0,0],n),P=r.Util.applyTransform([N,G],n),A=r.Util.normalizeRect([v[0],v[1],P[0],P[1]]),E=Math.round(A[2]-A[0])||1,j=Math.round(A[3]-A[1])||1,Q=this.cachedCanvases.getCanvas("fillCanvas",E,j),K=Q.context,X=Math.min(v[0],P[0]),rt=Math.min(v[1],P[1]);K.translate(-X,-rt),K.transform(...n),Y||(Y=this._scaleImage(W.canvas,(0,s.getCurrentTransformInverse)(K)),Y=Y.img,ot&&Z&&ot.set(it,Y)),K.imageSmoothingEnabled=U((0,s.getCurrentTransform)(K),O.interpolate),o(K,Y,0,0,Y.width,Y.height,0,0,N,G),K.globalCompositeOperation="source-in";const ht=r.Util.transform((0,s.getCurrentTransformInverse)(K),[1,0,0,1,-X,-rt]);return K.fillStyle=Z?H.getPattern(D,this,ht,i.PathType.FILL):H,K.fillRect(0,0,N,G),ot&&!Z&&(this.cachedCanvases.delete("fillCanvas"),ot.set(it,Q.canvas)),{canvas:Q.canvas,offsetX:Math.round(X),offsetY:Math.round(rt)}}setLineWidth(O){O!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=O,this.ctx.lineWidth=O}setLineCap(O){this.ctx.lineCap=_[O]}setLineJoin(O){this.ctx.lineJoin=V[O]}setMiterLimit(O){this.ctx.miterLimit=O}setDash(O,D){const N=this.ctx;N.setLineDash!==void 0&&(N.setLineDash(O),N.lineDashOffset=D)}setRenderingIntent(O){}setFlatness(O){}setGState(O){for(const[D,N]of O)switch(D){case"LW":this.setLineWidth(N);break;case"LC":this.setLineCap(N);break;case"LJ":this.setLineJoin(N);break;case"ML":this.setMiterLimit(N);break;case"D":this.setDash(N[0],N[1]);break;case"RI":this.setRenderingIntent(N);break;case"FL":this.setFlatness(N);break;case"Font":this.setFont(N[0],N[1]);break;case"CA":this.current.strokeAlpha=N;break;case"ca":this.current.fillAlpha=N,this.ctx.globalAlpha=N;break;case"BM":this.ctx.globalCompositeOperation=N;break;case"SMask":this.current.activeSMask=N?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(N);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const O=this.inSMaskMode;this.current.activeSMask&&!O?this.beginSMaskMode():!this.current.activeSMask&&O&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const O=this.ctx.canvas.width,D=this.ctx.canvas.height,N="smaskGroupAt"+this.groupLevel,G=this.cachedCanvases.getCanvas(N,O,D);this.suspendedCtx=this.ctx,this.ctx=G.context;const H=this.ctx;H.setTransform(...(0,s.getCurrentTransform)(this.suspendedCtx)),w(this.suspendedCtx,H),c(H,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),w(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(O){if(!this.current.activeSMask)return;O?(O[0]=Math.floor(O[0]),O[1]=Math.floor(O[1]),O[2]=Math.ceil(O[2]),O[3]=Math.ceil(O[3])):O=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const D=this.current.activeSMask,N=this.suspendedCtx;T(N,D,this.ctx,O),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(w(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const O=this.current;this.stateStack.push(O),this.current=O.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),w(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(O,D,N,G,H,Z){this.ctx.transform(O,D,N,G,H,Z),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(O,D,N){const G=this.ctx,H=this.current;let Z=H.x,$=H.y,ot,it;const Y=(0,s.getCurrentTransform)(G),W=Y[0]===0&&Y[3]===0||Y[1]===0&&Y[2]===0,n=W?N.slice(0):null;for(let v=0,P=0,A=O.length;v<A;v++)switch(O[v]|0){case r.OPS.rectangle:Z=D[P++],$=D[P++];const E=D[P++],j=D[P++],Q=Z+E,K=$+j;G.moveTo(Z,$),E===0||j===0?G.lineTo(Q,K):(G.lineTo(Q,$),G.lineTo(Q,K),G.lineTo(Z,K)),W||H.updateRectMinMax(Y,[Z,$,Q,K]),G.closePath();break;case r.OPS.moveTo:Z=D[P++],$=D[P++],G.moveTo(Z,$),W||H.updatePathMinMax(Y,Z,$);break;case r.OPS.lineTo:Z=D[P++],$=D[P++],G.lineTo(Z,$),W||H.updatePathMinMax(Y,Z,$);break;case r.OPS.curveTo:ot=Z,it=$,Z=D[P+4],$=D[P+5],G.bezierCurveTo(D[P],D[P+1],D[P+2],D[P+3],Z,$),H.updateCurvePathMinMax(Y,ot,it,D[P],D[P+1],D[P+2],D[P+3],Z,$,n),P+=6;break;case r.OPS.curveTo2:ot=Z,it=$,G.bezierCurveTo(Z,$,D[P],D[P+1],D[P+2],D[P+3]),H.updateCurvePathMinMax(Y,ot,it,Z,$,D[P],D[P+1],D[P+2],D[P+3],n),Z=D[P+2],$=D[P+3],P+=4;break;case r.OPS.curveTo3:ot=Z,it=$,Z=D[P+2],$=D[P+3],G.bezierCurveTo(D[P],D[P+1],Z,$,Z,$),H.updateCurvePathMinMax(Y,ot,it,D[P],D[P+1],Z,$,Z,$,n),P+=4;break;case r.OPS.closePath:G.closePath();break}W&&H.updateScalingPathMinMax(Y,n),H.setCurrentPoint(Z,$)}closePath(){this.ctx.closePath()}stroke(O=!0){const D=this.ctx,N=this.current.strokeColor;D.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof N=="object"&&(N!=null&&N.getPattern)?(D.save(),D.strokeStyle=N.getPattern(D,this,(0,s.getCurrentTransformInverse)(D),i.PathType.STROKE),this.rescaleAndStroke(!1),D.restore()):this.rescaleAndStroke(!0)),O&&this.consumePath(this.current.getClippedPathBoundingBox()),D.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(O=!0){const D=this.ctx,N=this.current.fillColor,G=this.current.patternFill;let H=!1;G&&(D.save(),D.fillStyle=N.getPattern(D,this,(0,s.getCurrentTransformInverse)(D),i.PathType.FILL),H=!0);const Z=this.current.getClippedPathBoundingBox();this.contentVisible&&Z!==null&&(this.pendingEOFill?(D.fill("evenodd"),this.pendingEOFill=!1):D.fill()),H&&D.restore(),O&&this.consumePath(Z)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=lt}eoClip(){this.pendingClip=J}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const O=this.pendingTextPaths,D=this.ctx;if(O===void 0){D.beginPath();return}D.save(),D.beginPath();for(const N of O)D.setTransform(...N.transform),D.translate(N.x,N.y),N.addToPath(D,N.fontSize);D.restore(),D.clip(),D.beginPath(),delete this.pendingTextPaths}setCharSpacing(O){this.current.charSpacing=O}setWordSpacing(O){this.current.wordSpacing=O}setHScale(O){this.current.textHScale=O/100}setLeading(O){this.current.leading=-O}setFont(O,D){const N=this.commonObjs.get(O),G=this.current;if(!N)throw new Error(`Can't find font for ${O}`);if(G.fontMatrix=N.fontMatrix||r.FONT_IDENTITY_MATRIX,(G.fontMatrix[0]===0||G.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+O),D<0?(D=-D,G.fontDirection=-1):G.fontDirection=1,this.current.font=N,this.current.fontSize=D,N.isType3Font)return;const H=N.loadedName||"sans-serif";let Z="normal";N.black?Z="900":N.bold&&(Z="bold");const $=N.italic?"italic":"normal",ot=`"${H}", ${N.fallbackName}`;let it=D;D<m?it=m:D>C&&(it=C),this.current.fontSizeScale=D/it,this.ctx.font=`${$} ${Z} ${it}px ${ot}`}setTextRenderingMode(O){this.current.textRenderingMode=O}setTextRise(O){this.current.textRise=O}moveText(O,D){this.current.x=this.current.lineX+=O,this.current.y=this.current.lineY+=D}setLeadingMoveText(O,D){this.setLeading(-D),this.moveText(O,D)}setTextMatrix(O,D,N,G,H,Z){this.current.textMatrix=[O,D,N,G,H,Z],this.current.textMatrixScale=Math.hypot(O,D),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(O,D,N,G){const H=this.ctx,Z=this.current,$=Z.font,ot=Z.textRenderingMode,it=Z.fontSize/Z.fontSizeScale,Y=ot&r.TextRenderingMode.FILL_STROKE_MASK,W=!!(ot&r.TextRenderingMode.ADD_TO_PATH_FLAG),n=Z.patternFill&&!$.missingFile;let v;($.disableFontFace||W||n)&&(v=$.getPathGenerator(this.commonObjs,O)),$.disableFontFace||n?(H.save(),H.translate(D,N),H.beginPath(),v(H,it),G&&H.setTransform(...G),(Y===r.TextRenderingMode.FILL||Y===r.TextRenderingMode.FILL_STROKE)&&H.fill(),(Y===r.TextRenderingMode.STROKE||Y===r.TextRenderingMode.FILL_STROKE)&&H.stroke(),H.restore()):((Y===r.TextRenderingMode.FILL||Y===r.TextRenderingMode.FILL_STROKE)&&H.fillText(O,D,N),(Y===r.TextRenderingMode.STROKE||Y===r.TextRenderingMode.FILL_STROKE)&&H.strokeText(O,D,N)),W&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,s.getCurrentTransform)(H),x:D,y:N,fontSize:it,addToPath:v})}get isFontSubpixelAAEnabled(){const{context:O}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);O.scale(1.5,1),O.fillText("I",0,10);const D=O.getImageData(0,0,10,10).data;let N=!1;for(let G=3;G<D.length;G+=4)if(D[G]>0&&D[G]<255){N=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",N)}showText(O){const D=this.current,N=D.font;if(N.isType3Font)return this.showType3Text(O);const G=D.fontSize;if(G===0)return;const H=this.ctx,Z=D.fontSizeScale,$=D.charSpacing,ot=D.wordSpacing,it=D.fontDirection,Y=D.textHScale*it,W=O.length,n=N.vertical,v=n?1:-1,P=N.defaultVMetrics,A=G*D.fontMatrix[0],E=D.textRenderingMode===r.TextRenderingMode.FILL&&!N.disableFontFace&&!D.patternFill;H.save(),H.transform(...D.textMatrix),H.translate(D.x,D.y+D.textRise),it>0?H.scale(Y,-1):H.scale(Y,1);let j;if(D.patternFill){H.save();const ht=D.fillColor.getPattern(H,this,(0,s.getCurrentTransformInverse)(H),i.PathType.FILL);j=(0,s.getCurrentTransform)(H),H.restore(),H.fillStyle=ht}let Q=D.lineWidth;const K=D.textMatrixScale;if(K===0||Q===0){const ht=D.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(ht===r.TextRenderingMode.STROKE||ht===r.TextRenderingMode.FILL_STROKE)&&(Q=this.getSinglePixelWidth())}else Q/=K;if(Z!==1&&(H.scale(Z,Z),Q/=Z),H.lineWidth=Q,N.isInvalidPDFjsFont){const ht=[];let st=0;for(const dt of O)ht.push(dt.unicode),st+=dt.width;H.fillText(ht.join(""),0,0),D.x+=st*A*Y,H.restore(),this.compose();return}let X=0,rt;for(rt=0;rt<W;++rt){const ht=O[rt];if(typeof ht=="number"){X+=v*ht*G/1e3;continue}let st=!1;const dt=(ht.isSpace?ot:0)+$,mt=ht.fontChar,At=ht.accent;let yt,wt,q=ht.width;if(n){const tt=ht.vmetric||P,_t=-(ht.vmetric?tt[1]:q*.5)*A,Et=tt[2]*A;q=tt?-tt[0]:q,yt=_t/Z,wt=(X+Et)/Z}else yt=X/Z,wt=0;if(N.remeasure&&q>0){const tt=H.measureText(mt).width*1e3/G*Z;if(q<tt&&this.isFontSubpixelAAEnabled){const _t=q/tt;st=!0,H.save(),H.scale(_t,1),yt/=_t}else q!==tt&&(yt+=(q-tt)/2e3*G/Z)}if(this.contentVisible&&(ht.isInFont||N.missingFile)){if(E&&!At)H.fillText(mt,yt,wt);else if(this.paintChar(mt,yt,wt,j),At){const tt=yt+G*At.offset.x/Z,_t=wt-G*At.offset.y/Z;this.paintChar(At.fontChar,tt,_t,j)}}let nt;n?nt=q*A-dt*it:nt=q*A+dt*it,X+=nt,st&&H.restore()}n?D.y-=X:D.x+=X*Y,H.restore(),this.compose()}showType3Text(O){const D=this.ctx,N=this.current,G=N.font,H=N.fontSize,Z=N.fontDirection,$=G.vertical?1:-1,ot=N.charSpacing,it=N.wordSpacing,Y=N.textHScale*Z,W=N.fontMatrix||r.FONT_IDENTITY_MATRIX,n=O.length,v=N.textRenderingMode===r.TextRenderingMode.INVISIBLE;let P,A,E,j;if(!(v||H===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,D.save(),D.transform(...N.textMatrix),D.translate(N.x,N.y),D.scale(Y,Z),P=0;P<n;++P){if(A=O[P],typeof A=="number"){j=$*A*H/1e3,this.ctx.translate(j,0),N.x+=j*Y;continue}const Q=(A.isSpace?it:0)+ot,K=G.charProcOperatorList[A.operatorListId];if(!K){(0,r.warn)(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),D.scale(H,H),D.transform(...W),this.executeOperatorList(K),this.restore()),E=r.Util.applyTransform([A.width,0],W)[0]*H+Q,D.translate(E,0),N.x+=E*Y}D.restore(),this.processingType3=null}}setCharWidth(O,D){}setCharWidthAndBounds(O,D,N,G,H,Z){this.ctx.rect(N,G,H-N,Z-G),this.ctx.clip(),this.endPath()}getColorN_Pattern(O){let D;if(O[0]==="TilingPattern"){const N=O[1],G=this.baseTransform||(0,s.getCurrentTransform)(this.ctx),H={createCanvasGraphics:Z=>new at(Z,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};D=new i.TilingPattern(O,N,this.ctx,H,G)}else D=this._getPattern(O[1],O[2]);return D}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(O,D,N){const G=r.Util.makeHexColor(O,D,N);this.ctx.strokeStyle=G,this.current.strokeColor=G}setFillRGBColor(O,D,N){const G=r.Util.makeHexColor(O,D,N);this.ctx.fillStyle=G,this.current.fillColor=G,this.current.patternFill=!1}_getPattern(O,D=null){let N;return this.cachedPatterns.has(O)?N=this.cachedPatterns.get(O):(N=(0,i.getShadingPattern)(this.getObject(O)),this.cachedPatterns.set(O,N)),D&&(N.matrix=D),N}shadingFill(O){if(!this.contentVisible)return;const D=this.ctx;this.save();const N=this._getPattern(O);D.fillStyle=N.getPattern(D,this,(0,s.getCurrentTransformInverse)(D),i.PathType.SHADING);const G=(0,s.getCurrentTransformInverse)(D);if(G){const H=D.canvas,Z=H.width,$=H.height,ot=r.Util.applyTransform([0,0],G),it=r.Util.applyTransform([0,$],G),Y=r.Util.applyTransform([Z,0],G),W=r.Util.applyTransform([Z,$],G),n=Math.min(ot[0],it[0],Y[0],W[0]),v=Math.min(ot[1],it[1],Y[1],W[1]),P=Math.max(ot[0],it[0],Y[0],W[0]),A=Math.max(ot[1],it[1],Y[1],W[1]);this.ctx.fillRect(n,v,P-n,A-v)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(O,D){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(O)&&O.length===6&&this.transform(...O),this.baseTransform=(0,s.getCurrentTransform)(this.ctx),D)){const N=D[2]-D[0],G=D[3]-D[1];this.ctx.rect(D[0],D[1],N,G),this.current.updateRectMinMax((0,s.getCurrentTransform)(this.ctx),D),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(O){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const D=this.ctx;O.isolated||(0,r.info)("TODO: Support non-isolated groups."),O.knockout&&(0,r.warn)("Knockout groups not supported.");const N=(0,s.getCurrentTransform)(D);if(O.matrix&&D.transform(...O.matrix),!O.bbox)throw new Error("Bounding box is required.");let G=r.Util.getAxialAlignedBoundingBox(O.bbox,(0,s.getCurrentTransform)(D));const H=[0,0,D.canvas.width,D.canvas.height];G=r.Util.intersect(G,H)||[0,0,0,0];const Z=Math.floor(G[0]),$=Math.floor(G[1]);let ot=Math.max(Math.ceil(G[2])-Z,1),it=Math.max(Math.ceil(G[3])-$,1),Y=1,W=1;ot>b&&(Y=ot/b,ot=b),it>b&&(W=it/b,it=b),this.current.startNewPathAndClipBox([0,0,ot,it]);let n="groupAt"+this.groupLevel;O.smask&&(n+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(n,ot,it),P=v.context;P.scale(1/Y,1/W),P.translate(-Z,-$),P.transform(...N),O.smask?this.smaskStack.push({canvas:v.canvas,context:P,offsetX:Z,offsetY:$,scaleX:Y,scaleY:W,subtype:O.smask.subtype,backdrop:O.smask.backdrop,transferMap:O.smask.transferMap||null,startTransformInverse:null}):(D.setTransform(1,0,0,1,0,0),D.translate(Z,$),D.scale(Y,W),D.save()),w(D,P),this.ctx=P,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(D),this.groupLevel++}endGroup(O){if(!this.contentVisible)return;this.groupLevel--;const D=this.ctx,N=this.groupStack.pop();if(this.ctx=N,this.ctx.imageSmoothingEnabled=!1,O.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const G=(0,s.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...G);const H=r.Util.getAxialAlignedBoundingBox([0,0,D.canvas.width,D.canvas.height],G);this.ctx.drawImage(D.canvas,0,0),this.ctx.restore(),this.compose(H)}}beginAnnotation(O,D,N,G,H){if(gt(this,et,ge).call(this),y(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(D)&&D.length===4){const Z=D[2]-D[0],$=D[3]-D[1];if(H&&this.annotationCanvasMap){N=N.slice(),N[4]-=D[0],N[5]-=D[1],D=D.slice(),D[0]=D[1]=0,D[2]=Z,D[3]=$;const[ot,it]=r.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(this.ctx)),{viewportScale:Y}=this,W=Math.ceil(Z*this.outputScaleX*Y),n=Math.ceil($*this.outputScaleY*Y);this.annotationCanvas=this.canvasFactory.create(W,n);const{canvas:v,context:P}=this.annotationCanvas;this.annotationCanvasMap.set(O,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=P,this.ctx.setTransform(ot,0,0,-it,0,$*it),y(this.ctx)}else y(this.ctx),this.ctx.rect(D[0],D[1],Z,$),this.ctx.clip(),this.endPath()}this.current=new L(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...N),this.transform(...G)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(O){if(!this.contentVisible)return;const D=O.count;O=this.getObject(O.data,O),O.count=D;const N=this.ctx,G=this.processingType3;if(G&&(G.compiled===void 0&&(G.compiled=R(O)),G.compiled)){G.compiled(N);return}const H=this._createMaskCanvas(O),Z=H.canvas;N.save(),N.setTransform(1,0,0,1,0,0),N.drawImage(Z,H.offsetX,H.offsetY),N.restore(),this.compose()}paintImageMaskXObjectRepeat(O,D,N=0,G=0,H,Z){if(!this.contentVisible)return;O=this.getObject(O.data,O);const $=this.ctx;$.save();const ot=(0,s.getCurrentTransform)($);$.transform(D,N,G,H,0,0);const it=this._createMaskCanvas(O);$.setTransform(1,0,0,1,it.offsetX-ot[4],it.offsetY-ot[5]);for(let Y=0,W=Z.length;Y<W;Y+=2){const n=r.Util.transform(ot,[D,N,G,H,Z[Y],Z[Y+1]]),[v,P]=r.Util.applyTransform([0,0],n);$.drawImage(it.canvas,v,P)}$.restore(),this.compose()}paintImageMaskXObjectGroup(O){if(!this.contentVisible)return;const D=this.ctx,N=this.current.fillColor,G=this.current.patternFill;for(const H of O){const{data:Z,width:$,height:ot,transform:it}=H,Y=this.cachedCanvases.getCanvas("maskCanvas",$,ot),W=Y.context;W.save();const n=this.getObject(Z,H);u(W,n),W.globalCompositeOperation="source-in",W.fillStyle=G?N.getPattern(W,this,(0,s.getCurrentTransformInverse)(D),i.PathType.FILL):N,W.fillRect(0,0,$,ot),W.restore(),D.save(),D.transform(...it),D.scale(1,-1),o(D,Y.canvas,0,0,$,ot,0,-1,1,1),D.restore()}this.compose()}paintImageXObject(O){if(!this.contentVisible)return;const D=this.getObject(O);if(!D){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(D)}paintImageXObjectRepeat(O,D,N,G){if(!this.contentVisible)return;const H=this.getObject(O);if(!H){(0,r.warn)("Dependent image isn't ready yet");return}const Z=H.width,$=H.height,ot=[];for(let it=0,Y=G.length;it<Y;it+=2)ot.push({transform:[D,0,0,N,G[it],G[it+1]],x:0,y:0,w:Z,h:$});this.paintInlineImageXObjectGroup(H,ot)}applyTransferMapsToCanvas(O){return this.current.transferMaps!=="none"&&(O.filter=this.current.transferMaps,O.drawImage(O.canvas,0,0),O.filter="none"),O.canvas}applyTransferMapsToBitmap(O){if(this.current.transferMaps==="none")return O.bitmap;const{bitmap:D,width:N,height:G}=O,H=this.cachedCanvases.getCanvas("inlineImage",N,G),Z=H.context;return Z.filter=this.current.transferMaps,Z.drawImage(D,0,0),Z.filter="none",H.canvas}paintInlineImageXObject(O){if(!this.contentVisible)return;const D=O.width,N=O.height,G=this.ctx;this.save(),g.isNodeJS||(G.filter="none"),G.scale(1/D,-1/N);let H;if(O.bitmap)H=this.applyTransferMapsToBitmap(O);else if(typeof HTMLElement=="function"&&O instanceof HTMLElement||!O.data)H=O;else{const ot=this.cachedCanvases.getCanvas("inlineImage",D,N).context;F(ot,O),H=this.applyTransferMapsToCanvas(ot)}const Z=this._scaleImage(H,(0,s.getCurrentTransformInverse)(G));G.imageSmoothingEnabled=U((0,s.getCurrentTransform)(G),O.interpolate),o(G,Z.img,0,0,Z.paintWidth,Z.paintHeight,0,-N,D,N),this.compose(),this.restore()}paintInlineImageXObjectGroup(O,D){if(!this.contentVisible)return;const N=this.ctx;let G;if(O.bitmap)G=O.bitmap;else{const H=O.width,Z=O.height,ot=this.cachedCanvases.getCanvas("inlineImage",H,Z).context;F(ot,O),G=this.applyTransferMapsToCanvas(ot)}for(const H of D)N.save(),N.transform(...H.transform),N.scale(1,-1),o(N,G,H.x,H.y,H.w,H.h,0,-1,1,1),N.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(O){}markPointProps(O,D){}beginMarkedContent(O){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(O,D){O==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(D)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(O){const D=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(O);const N=this.ctx;this.pendingClip&&(D||(this.pendingClip===J?N.clip("evenodd"):N.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),N.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const O=(0,s.getCurrentTransform)(this.ctx);if(O[1]===0&&O[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(O[0]),Math.abs(O[3]));else{const D=Math.abs(O[0]*O[3]-O[2]*O[1]),N=Math.hypot(O[0],O[2]),G=Math.hypot(O[1],O[3]);this._cachedGetSinglePixelWidth=Math.max(N,G)/D}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:O}=this.current,D=(0,s.getCurrentTransform)(this.ctx);let N,G;if(D[1]===0&&D[2]===0){const H=Math.abs(D[0]),Z=Math.abs(D[3]);if(O===0)N=1/H,G=1/Z;else{const $=H*O,ot=Z*O;N=$<1?1/$:1,G=ot<1?1/ot:1}}else{const H=Math.abs(D[0]*D[3]-D[2]*D[1]),Z=Math.hypot(D[0],D[1]),$=Math.hypot(D[2],D[3]);if(O===0)N=$/H,G=Z/H;else{const ot=O*H;N=$>ot?$/ot:1,G=Z>ot?Z/ot:1}}this._cachedScaleForStroking=[N,G]}return this._cachedScaleForStroking}rescaleAndStroke(O){const{ctx:D}=this,{lineWidth:N}=this.current,[G,H]=this.getScaleForStroking();if(D.lineWidth=N||1,G===1&&H===1){D.stroke();return}let Z,$,ot;O&&(Z=(0,s.getCurrentTransform)(D),$=D.getLineDash().slice(),ot=D.lineDashOffset),D.scale(G,H);const it=Math.max(G,H);D.setLineDash(D.getLineDash().map(Y=>Y/it)),D.lineDashOffset/=it,D.stroke(),O&&(D.setTransform(...Z),D.setLineDash($),D.lineDashOffset=ot)}isContentVisible(){for(let O=this.markedContentStack.length-1;O>=0;O--)if(!this.markedContentStack[O].visible)return!1;return!0}};let ct=at;et=new WeakSet,ge=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},t.CanvasGraphics=ct;for(const B in r.OPS)ct.prototype[B]!==void 0&&(ct.prototype[r.OPS[B]]=ct.prototype[B])},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=d;var r=e(1),s=e(6);const i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=i;function p(a,o){if(!o)return;const R=o[2]-o[0],L=o[3]-o[1],F=new Path2D;F.rect(o[0],o[1],R,L),a.clip(F)}class g{constructor(){this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class m extends g{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let R;this._type==="axial"?R=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(R=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const L of this._colorStops)R.addColorStop(L[0],L[1]);return R}getPattern(o,R,L,F){let u;if(F===i.STROKE||F===i.FILL){const w=R.current.getClippedPathBoundingBox(F,(0,s.getCurrentTransform)(o))||[0,0,0,0],y=Math.ceil(w[2]-w[0])||1,l=Math.ceil(w[3]-w[1])||1,h=R.cachedCanvases.getCanvas("pattern",y,l,!0),I=h.context;I.clearRect(0,0,I.canvas.width,I.canvas.height),I.beginPath(),I.rect(0,0,I.canvas.width,I.canvas.height),I.translate(-w[0],-w[1]),L=r.Util.transform(L,[1,0,0,1,w[0],w[1]]),I.transform(...R.baseTransform),this.matrix&&I.transform(...this.matrix),p(I,this._bbox),I.fillStyle=this._createGradient(I),I.fill(),u=o.createPattern(h.canvas,"no-repeat");const k=new DOMMatrix(L);u.setTransform(k)}else p(o,this._bbox),u=this._createGradient(o);return u}}function C(a,o,R,L,F,u,w,y){const l=o.coords,h=o.colors,I=a.data,k=a.width*4;let T;l[R+1]>l[L+1]&&(T=R,R=L,L=T,T=u,u=w,w=T),l[L+1]>l[F+1]&&(T=L,L=F,F=T,T=w,w=y,y=T),l[R+1]>l[L+1]&&(T=R,R=L,L=T,T=u,u=w,w=T);const U=(l[R]+o.offsetX)*o.scaleX,_=(l[R+1]+o.offsetY)*o.scaleY,V=(l[L]+o.offsetX)*o.scaleX,lt=(l[L+1]+o.offsetY)*o.scaleY,J=(l[F]+o.offsetX)*o.scaleX,ct=(l[F+1]+o.offsetY)*o.scaleY;if(_>=ct)return;const et=h[u],pt=h[u+1],at=h[u+2],B=h[w],O=h[w+1],D=h[w+2],N=h[y],G=h[y+1],H=h[y+2],Z=Math.round(_),$=Math.round(ct);let ot,it,Y,W,n,v,P,A;for(let E=Z;E<=$;E++){if(E<lt){let rt;E<_?rt=0:rt=(_-E)/(_-lt),ot=U-(U-V)*rt,it=et-(et-B)*rt,Y=pt-(pt-O)*rt,W=at-(at-D)*rt}else{let rt;E>ct?rt=1:lt===ct?rt=0:rt=(lt-E)/(lt-ct),ot=V-(V-J)*rt,it=B-(B-N)*rt,Y=O-(O-G)*rt,W=D-(D-H)*rt}let j;E<_?j=0:E>ct?j=1:j=(_-E)/(_-ct),n=U-(U-J)*j,v=et-(et-N)*j,P=pt-(pt-G)*j,A=at-(at-H)*j;const Q=Math.round(Math.min(ot,n)),K=Math.round(Math.max(ot,n));let X=k*E+Q*4;for(let rt=Q;rt<=K;rt++)j=(ot-rt)/(ot-n),j<0?j=0:j>1&&(j=1),I[X++]=it-(it-v)*j|0,I[X++]=Y-(Y-P)*j|0,I[X++]=W-(W-A)*j|0,I[X++]=255}}function b(a,o,R){const L=o.coords,F=o.colors;let u,w;switch(o.type){case"lattice":const y=o.verticesPerRow,l=Math.floor(L.length/y)-1,h=y-1;for(u=0;u<l;u++){let I=u*y;for(let k=0;k<h;k++,I++)C(a,R,L[I],L[I+1],L[I+y],F[I],F[I+1],F[I+y]),C(a,R,L[I+y+1],L[I+1],L[I+y],F[I+y+1],F[I+1],F[I+y])}break;case"triangles":for(u=0,w=L.length;u<w;u+=3)C(a,R,L[u],L[u+1],L[u+2],F[u],F[u+1],F[u+2]);break;default:throw new Error("illegal figure")}}class M extends g{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,R,L){const y=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-y,I=Math.ceil(this._bounds[3])-l,k=Math.min(Math.ceil(Math.abs(h*o[0]*1.1)),3e3),T=Math.min(Math.ceil(Math.abs(I*o[1]*1.1)),3e3),U=h/k,_=I/T,V={coords:this._coords,colors:this._colors,offsetX:-y,offsetY:-l,scaleX:1/U,scaleY:1/_},lt=k+2*2,J=T+2*2,ct=L.getCanvas("mesh",lt,J,!1),et=ct.context,pt=et.createImageData(k,T);if(R){const B=pt.data;for(let O=0,D=B.length;O<D;O+=4)B[O]=R[0],B[O+1]=R[1],B[O+2]=R[2],B[O+3]=255}for(const B of this._figures)b(pt,B,V);return et.putImageData(pt,2,2),{canvas:ct.canvas,offsetX:y-2*U,offsetY:l-2*_,scaleX:U,scaleY:_}}getPattern(o,R,L,F){p(o,this._bbox);let u;if(F===i.SHADING)u=r.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(o));else if(u=r.Util.singularValueDecompose2dScale(R.baseTransform),this.matrix){const y=r.Util.singularValueDecompose2dScale(this.matrix);u=[u[0]*y[0],u[1]*y[1]]}const w=this._createMeshCanvas(u,F===i.SHADING?null:this._background,R.cachedCanvases);return F!==i.SHADING&&(o.setTransform(...R.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(w.offsetX,w.offsetY),o.scale(w.scaleX,w.scaleY),o.createPattern(w.canvas,"no-repeat")}}class S extends g{getPattern(){return"hotpink"}}function d(a){switch(a[0]){case"RadialAxial":return new m(a);case"Mesh":return new M(a);case"Dummy":return new S}throw new Error(`Unknown IR type: ${a[0]}`)}const f={COLORED:1,UNCOLORED:2};class c{static get MAX_PATTERN_SIZE(){return(0,r.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(o,R,L,F,u){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=R,this.ctx=L,this.canvasGraphicsFactory=F,this.baseTransform=u}createPatternCanvas(o){const R=this.operatorList,L=this.bbox,F=this.xstep,u=this.ystep,w=this.paintType,y=this.tilingType,l=this.color,h=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+y);const I=L[0],k=L[1],T=L[2],U=L[3],_=r.Util.singularValueDecompose2dScale(this.matrix),V=r.Util.singularValueDecompose2dScale(this.baseTransform),lt=[_[0]*V[0],_[1]*V[1]],J=this.getSizeAndScale(F,this.ctx.canvas.width,lt[0]),ct=this.getSizeAndScale(u,this.ctx.canvas.height,lt[1]),et=o.cachedCanvases.getCanvas("pattern",J.size,ct.size,!0),pt=et.context,at=h.createCanvasGraphics(pt);at.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(at,w,l);let B=I,O=k,D=T,N=U;return I<0&&(B=0,D+=Math.abs(I)),k<0&&(O=0,N+=Math.abs(k)),pt.translate(-(J.scale*B),-(ct.scale*O)),at.transform(J.scale,0,0,ct.scale,0,0),pt.save(),this.clipBbox(at,B,O,D,N),at.baseTransform=(0,s.getCurrentTransform)(at.ctx),at.executeOperatorList(R),at.endDrawing(),{canvas:et.canvas,scaleX:J.scale,scaleY:ct.scale,offsetX:B,offsetY:O}}getSizeAndScale(o,R,L){o=Math.abs(o);const F=Math.max(c.MAX_PATTERN_SIZE,R);let u=Math.ceil(o*L);return u>=F?u=F:L=u/o,{scale:L,size:u}}clipBbox(o,R,L,F,u){const w=F-R,y=u-L;o.ctx.rect(R,L,w,y),o.current.updateRectMinMax((0,s.getCurrentTransform)(o.ctx),[R,L,F,u]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,R,L){const F=o.ctx,u=o.current;switch(R){case f.COLORED:const w=this.ctx;F.fillStyle=w.fillStyle,F.strokeStyle=w.strokeStyle,u.fillColor=w.fillStyle,u.strokeColor=w.strokeStyle;break;case f.UNCOLORED:const y=r.Util.makeHexColor(L[0],L[1],L[2]);F.fillStyle=y,F.strokeStyle=y,u.fillColor=y,u.strokeColor=y;break;default:throw new r.FormatError(`Unsupported paint type: ${R}`)}}getPattern(o,R,L,F){let u=L;F!==i.SHADING&&(u=r.Util.transform(u,R.baseTransform),this.matrix&&(u=r.Util.transform(u,this.matrix)));const w=this.createPatternCanvas(R);let y=new DOMMatrix(u);y=y.translate(w.offsetX,w.offsetY),y=y.scale(1/w.scaleX,1/w.scaleY);const l=o.createPattern(w.canvas,"repeat");return l.setTransform(y),l}}t.TilingPattern=c},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=i,t.convertToRGBA=s,t.grayToRGBA=g;var r=e(1);function s(m){switch(m.kind){case r.ImageKind.GRAYSCALE_1BPP:return i(m);case r.ImageKind.RGB_24BPP:return p(m)}return null}function i({src:m,srcPos:C=0,dest:b,width:M,height:S,nonBlackColor:d=4294967295,inverseDecode:f=!1}){const c=r.FeatureTest.isLittleEndian?4278190080:255,[a,o]=f?[d,c]:[c,d],R=M>>3,L=M&7,F=m.length;b=new Uint32Array(b.buffer);let u=0;for(let w=0;w<S;w++){for(const l=C+R;C<l;C++){const h=C<F?m[C]:255;b[u++]=h&128?o:a,b[u++]=h&64?o:a,b[u++]=h&32?o:a,b[u++]=h&16?o:a,b[u++]=h&8?o:a,b[u++]=h&4?o:a,b[u++]=h&2?o:a,b[u++]=h&1?o:a}if(L===0)continue;const y=C<F?m[C++]:255;for(let l=0;l<L;l++)b[u++]=y&1<<7-l?o:a}return{srcPos:C,destPos:u}}function p({src:m,srcPos:C=0,dest:b,destPos:M=0,width:S,height:d}){let f=0;const c=m.length>>2,a=new Uint32Array(m.buffer,C,c);if(r.FeatureTest.isLittleEndian){for(;f<c-2;f+=3,M+=4){const o=a[f],R=a[f+1],L=a[f+2];b[M]=o|4278190080,b[M+1]=o>>>24|R<<8|4278190080,b[M+2]=R>>>16|L<<16|4278190080,b[M+3]=L>>>8|4278190080}for(let o=f*4,R=m.length;o<R;o+=3)b[M++]=m[o]|m[o+1]<<8|m[o+2]<<16|4278190080}else{for(;f<c-2;f+=3,M+=4){const o=a[f],R=a[f+1],L=a[f+2];b[M]=o|255,b[M+1]=o<<24|R>>>8|255,b[M+2]=R<<16|L>>>16|255,b[M+3]=L<<8|255}for(let o=f*4,R=m.length;o<R;o+=3)b[M++]=m[o]<<24|m[o+1]<<16|m[o+2]<<8|255}return{srcPos:C,destPos:M}}function g(m,C){if(r.FeatureTest.isLittleEndian)for(let b=0,M=m.length;b<M;b++)C[b]=m[b]*65793|4278190080;else for(let b=0,M=m.length;b<M;b++)C[b]=m[b]*16843008|255}},(x,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const e=Object.create(null);t.GlobalWorkerOptions=e,e.workerPort=null,e.workerSrc=""},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var r=e(1);const s={UNKNOWN:0,DATA:1,ERROR:2},i={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function p(m){switch(m instanceof Error||typeof m=="object"&&m!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),m.name){case"AbortException":return new r.AbortException(m.message);case"MissingPDFException":return new r.MissingPDFException(m.message);case"PasswordException":return new r.PasswordException(m.message,m.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(m.message,m.status);case"UnknownErrorException":return new r.UnknownErrorException(m.message,m.details);default:return new r.UnknownErrorException(m.message,m.toString())}}class g{constructor(C,b,M){this.sourceName=C,this.targetName=b,this.comObj=M,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=S=>{const d=S.data;if(d.targetName!==this.sourceName)return;if(d.stream){this._processStreamMessage(d);return}if(d.callback){const c=d.callbackId,a=this.callbackCapabilities[c];if(!a)throw new Error(`Cannot resolve callback ${c}`);if(delete this.callbackCapabilities[c],d.callback===s.DATA)a.resolve(d.data);else if(d.callback===s.ERROR)a.reject(p(d.reason));else throw new Error("Unexpected callback case");return}const f=this.actionHandler[d.action];if(!f)throw new Error(`Unknown action from worker: ${d.action}`);if(d.callbackId){const c=this.sourceName,a=d.sourceName;new Promise(function(o){o(f(d.data))}).then(function(o){M.postMessage({sourceName:c,targetName:a,callback:s.DATA,callbackId:d.callbackId,data:o})},function(o){M.postMessage({sourceName:c,targetName:a,callback:s.ERROR,callbackId:d.callbackId,reason:p(o)})});return}if(d.streamId){this._createStreamSink(d);return}f(d.data)},M.addEventListener("message",this._onComObjOnMessage)}on(C,b){const M=this.actionHandler;if(M[C])throw new Error(`There is already an actionName called "${C}"`);M[C]=b}send(C,b,M){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:C,data:b},M)}sendWithPromise(C,b,M){const S=this.callbackId++,d=(0,r.createPromiseCapability)();this.callbackCapabilities[S]=d;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:C,callbackId:S,data:b},M)}catch(f){d.reject(f)}return d.promise}sendWithStream(C,b,M,S){const d=this.streamId++,f=this.sourceName,c=this.targetName,a=this.comObj;return new ReadableStream({start:o=>{const R=(0,r.createPromiseCapability)();return this.streamControllers[d]={controller:o,startCall:R,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:f,targetName:c,action:C,streamId:d,data:b,desiredSize:o.desiredSize},S),R.promise},pull:o=>{const R=(0,r.createPromiseCapability)();return this.streamControllers[d].pullCall=R,a.postMessage({sourceName:f,targetName:c,stream:i.PULL,streamId:d,desiredSize:o.desiredSize}),R.promise},cancel:o=>{(0,r.assert)(o instanceof Error,"cancel must have a valid reason");const R=(0,r.createPromiseCapability)();return this.streamControllers[d].cancelCall=R,this.streamControllers[d].isClosed=!0,a.postMessage({sourceName:f,targetName:c,stream:i.CANCEL,streamId:d,reason:p(o)}),R.promise}},M)}_createStreamSink(C){const b=C.streamId,M=this.sourceName,S=C.sourceName,d=this.comObj,f=this,c=this.actionHandler[C.action],a={enqueue(o,R=1,L){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=R,F>0&&this.desiredSize<=0&&(this.sinkCapability=(0,r.createPromiseCapability)(),this.ready=this.sinkCapability.promise),d.postMessage({sourceName:M,targetName:S,stream:i.ENQUEUE,streamId:b,chunk:o},L)},close(){this.isCancelled||(this.isCancelled=!0,d.postMessage({sourceName:M,targetName:S,stream:i.CLOSE,streamId:b}),delete f.streamSinks[b])},error(o){(0,r.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,d.postMessage({sourceName:M,targetName:S,stream:i.ERROR,streamId:b,reason:p(o)}))},sinkCapability:(0,r.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:C.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[b]=a,new Promise(function(o){o(c(C.data,a))}).then(function(){d.postMessage({sourceName:M,targetName:S,stream:i.START_COMPLETE,streamId:b,success:!0})},function(o){d.postMessage({sourceName:M,targetName:S,stream:i.START_COMPLETE,streamId:b,reason:p(o)})})}_processStreamMessage(C){const b=C.streamId,M=this.sourceName,S=C.sourceName,d=this.comObj,f=this.streamControllers[b],c=this.streamSinks[b];switch(C.stream){case i.START_COMPLETE:C.success?f.startCall.resolve():f.startCall.reject(p(C.reason));break;case i.PULL_COMPLETE:C.success?f.pullCall.resolve():f.pullCall.reject(p(C.reason));break;case i.PULL:if(!c){d.postMessage({sourceName:M,targetName:S,stream:i.PULL_COMPLETE,streamId:b,success:!0});break}c.desiredSize<=0&&C.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=C.desiredSize,new Promise(function(a){a(c.onPull&&c.onPull())}).then(function(){d.postMessage({sourceName:M,targetName:S,stream:i.PULL_COMPLETE,streamId:b,success:!0})},function(a){d.postMessage({sourceName:M,targetName:S,stream:i.PULL_COMPLETE,streamId:b,reason:p(a)})});break;case i.ENQUEUE:if((0,r.assert)(f,"enqueue should have stream controller"),f.isClosed)break;f.controller.enqueue(C.chunk);break;case i.CLOSE:if((0,r.assert)(f,"close should have stream controller"),f.isClosed)break;f.isClosed=!0,f.controller.close(),this._deleteStreamController(f,b);break;case i.ERROR:(0,r.assert)(f,"error should have stream controller"),f.controller.error(p(C.reason)),this._deleteStreamController(f,b);break;case i.CANCEL_COMPLETE:C.success?f.cancelCall.resolve():f.cancelCall.reject(p(C.reason)),this._deleteStreamController(f,b);break;case i.CANCEL:if(!c)break;new Promise(function(a){a(c.onCancel&&c.onCancel(p(C.reason)))}).then(function(){d.postMessage({sourceName:M,targetName:S,stream:i.CANCEL_COMPLETE,streamId:b,success:!0})},function(a){d.postMessage({sourceName:M,targetName:S,stream:i.CANCEL_COMPLETE,streamId:b,reason:p(a)})}),c.sinkCapability.reject(p(C.reason)),c.isCancelled=!0,delete this.streamSinks[b];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(C,b){await Promise.allSettled([C.startCall&&C.startCall.promise,C.pullCall&&C.pullCall.promise,C.cancelCall&&C.cancelCall.promise]),delete this.streamControllers[b]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}t.MessageHandler=g},(x,t,e)=>{var i,p;Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=e(1);class s{constructor({parsedData:m,rawData:C}){ft(this,i,void 0);ft(this,p,void 0);vt(this,i,m),vt(this,p,C)}getRaw(){return z(this,p)}get(m){return z(this,i).get(m)??null}getAll(){return(0,r.objectFromMap)(z(this,i))}has(m){return z(this,i).has(m)}}i=new WeakMap,p=new WeakMap,t.Metadata=s},(x,t,e)=>{var m,C,b,M,S,d,be;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var r=e(1),s=e(8);const i=Symbol("INTERNAL");class p{constructor(a,o){ft(this,m,!0);this.name=a,this.intent=o}get visible(){return z(this,m)}_setVisible(a,o){a!==i&&(0,r.unreachable)("Internal method `_setVisible` called."),vt(this,m,o)}}m=new WeakMap;class g{constructor(a){ft(this,d);ft(this,C,null);ft(this,b,new Map);ft(this,M,null);ft(this,S,null);if(this.name=null,this.creator=null,a!==null){this.name=a.name,this.creator=a.creator,vt(this,S,a.order);for(const o of a.groups)z(this,b).set(o.id,new p(o.name,o.intent));if(a.baseState==="OFF")for(const o of z(this,b).values())o._setVisible(i,!1);for(const o of a.on)z(this,b).get(o)._setVisible(i,!0);for(const o of a.off)z(this,b).get(o)._setVisible(i,!1);vt(this,M,this.getHash())}}isVisible(a){if(z(this,b).size===0)return!0;if(!a)return(0,r.warn)("Optional content group not defined."),!0;if(a.type==="OCG")return z(this,b).has(a.id)?z(this,b).get(a.id).visible:((0,r.warn)(`Optional content group not found: ${a.id}`),!0);if(a.type==="OCMD"){if(a.expression)return gt(this,d,be).call(this,a.expression);if(!a.policy||a.policy==="AnyOn"){for(const o of a.ids){if(!z(this,b).has(o))return(0,r.warn)(`Optional content group not found: ${o}`),!0;if(z(this,b).get(o).visible)return!0}return!1}else if(a.policy==="AllOn"){for(const o of a.ids){if(!z(this,b).has(o))return(0,r.warn)(`Optional content group not found: ${o}`),!0;if(!z(this,b).get(o).visible)return!1}return!0}else if(a.policy==="AnyOff"){for(const o of a.ids){if(!z(this,b).has(o))return(0,r.warn)(`Optional content group not found: ${o}`),!0;if(!z(this,b).get(o).visible)return!0}return!1}else if(a.policy==="AllOff"){for(const o of a.ids){if(!z(this,b).has(o))return(0,r.warn)(`Optional content group not found: ${o}`),!0;if(z(this,b).get(o).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${a.policy}.`),!0}return(0,r.warn)(`Unknown group type ${a.type}.`),!0}setVisibility(a,o=!0){if(!z(this,b).has(a)){(0,r.warn)(`Optional content group not found: ${a}`);return}z(this,b).get(a)._setVisible(i,!!o),vt(this,C,null)}get hasInitialVisibility(){return this.getHash()===z(this,M)}getOrder(){return z(this,b).size?z(this,S)?z(this,S).slice():[...z(this,b).keys()]:null}getGroups(){return z(this,b).size>0?(0,r.objectFromMap)(z(this,b)):null}getGroup(a){return z(this,b).get(a)||null}getHash(){if(z(this,C)!==null)return z(this,C);const a=new s.MurmurHash3_64;for(const[o,R]of z(this,b))a.update(`${o}:${R.visible}`);return vt(this,C,a.hexdigest())}}C=new WeakMap,b=new WeakMap,M=new WeakMap,S=new WeakMap,d=new WeakSet,be=function(a){const o=a.length;if(o<2)return!0;const R=a[0];for(let L=1;L<o;L++){const F=a[L];let u;if(Array.isArray(F))u=gt(this,d,be).call(this,F);else if(z(this,b).has(F))u=z(this,b).get(F).visible;else return(0,r.warn)(`Optional content group not found: ${F}`),!0;switch(R){case"And":if(!u)return!1;break;case"Or":if(u)return!0;break;case"Not":return!u;default:return!0}}return R==="And"},t.OptionalContentConfig=g},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var r=e(1),s=e(6);class i{constructor({length:C,initialData:b,progressiveDone:M=!1,contentDispositionFilename:S=null,disableRange:d=!1,disableStream:f=!1},c){if((0,r.assert)(c,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=M,this._contentDispositionFilename=S,(b==null?void 0:b.length)>0){const a=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;this._queuedChunks.push(a)}this._pdfDataRangeTransport=c,this._isStreamingSupported=!f,this._isRangeSupported=!d,this._contentLength=C,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((a,o)=>{this._onReceiveData({begin:a,chunk:o})}),this._pdfDataRangeTransport.addProgressListener((a,o)=>{this._onProgress({loaded:a,total:o})}),this._pdfDataRangeTransport.addProgressiveReadListener(a=>{this._onReceiveData({chunk:a})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:C,chunk:b}){const M=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;if(C===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(M):this._queuedChunks.push(M);else{const S=this._rangeReaders.some(function(d){return d._begin!==C?!1:(d._enqueue(M),!0)});(0,r.assert)(S,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}_onProgress(C){var b,M,S,d;C.total===void 0?(M=(b=this._rangeReaders[0])==null?void 0:b.onProgress)==null||M.call(b,{loaded:C.loaded}):(d=(S=this._fullRequestReader)==null?void 0:S.onProgress)==null||d.call(S,{loaded:C.loaded,total:C.total})}_onProgressiveDone(){var C;(C=this._fullRequestReader)==null||C.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(C){const b=this._rangeReaders.indexOf(C);b>=0&&this._rangeReaders.splice(b,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const C=this._queuedChunks;return this._queuedChunks=null,new p(this,C,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(C,b){if(b<=this._progressiveDataLength)return null;const M=new g(this,C,b);return this._pdfDataRangeTransport.requestDataRange(C,b),this._rangeReaders.push(M),M}cancelAllRequests(C){var b;(b=this._fullRequestReader)==null||b.cancel(C);for(const M of this._rangeReaders.slice(0))M.cancel(C);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=i;class p{constructor(C,b,M=!1,S=null){this._stream=C,this._done=M||!1,this._filename=(0,s.isPdfFile)(S)?S:null,this._queuedChunks=b||[],this._loaded=0;for(const d of this._queuedChunks)this._loaded+=d.byteLength;this._requests=[],this._headersReady=Promise.resolve(),C._fullRequestReader=this,this.onProgress=null}_enqueue(C){this._done||(this._requests.length>0?this._requests.shift().resolve({value:C,done:!1}):this._queuedChunks.push(C),this._loaded+=C.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=(0,r.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class g{constructor(C,b,M){this._stream=C,this._begin=b,this._end=M,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(C){if(!this._done){if(this._requests.length===0)this._queuedChunk=C;else{this._requests.shift().resolve({value:C,done:!1});for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const C=(0,r.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(x,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class e{static textContent(s){const i=[],p={items:i,styles:Object.create(null)};function g(m){var M;if(!m)return;let C=null;const b=m.name;if(b==="#text")C=m.value;else if(e.shouldBuildText(b))(M=m==null?void 0:m.attributes)!=null&&M.textContent?C=m.attributes.textContent:m.value&&(C=m.value);else return;if(C!==null&&i.push({str:C}),!!m.children)for(const S of m.children)g(S)}return g(s),p}static shouldBuildText(s){return!(s==="textarea"||s==="input"||s==="option"||s==="select")}}t.XfaText=e},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var r=e(7);const s=function(C){return new Promise((b,M)=>{require$$5.readFile(C,(d,f)=>{if(d||!f){M(new Error(d));return}b(new Uint8Array(f))})})};class i extends r.BaseFilterFactory{}t.NodeFilterFactory=i;class p extends r.BaseCanvasFactory{_createCanvas(b,M){return require$$5.createCanvas(b,M)}}t.NodeCanvasFactory=p;class g extends r.BaseCMapReaderFactory{_fetchData(b,M){return s(b).then(S=>({cMapData:S,compressionType:M}))}}t.NodeCMapReaderFactory=g;class m extends r.BaseStandardFontDataFactory{_fetchData(b){return s(b)}}t.NodeStandardFontDataFactory=m},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var r=e(1),s=e(22);const i=require$$5,p=require$$5,g=require$$5,m=require$$5,C=/^file:\/\/\/[a-zA-Z]:\//;function b(L){const F=m.parse(L);return F.protocol==="file:"||F.host?F:/^[a-z]:[/\\]/i.test(L)?m.parse(`file:///${L}`):(F.host||(F.protocol="file:"),F)}class M{constructor(F){this.source=F,this.url=b(F.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F;return((F=this._fullRequestReader)==null?void 0:F._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new o(this):new c(this),this._fullRequestReader}getRangeReader(F,u){if(u<=this._progressiveDataLength)return null;const w=this.isFsUrl?new R(this,F,u):new a(this,F,u);return this._rangeRequestReaders.push(w),w}cancelAllRequests(F){var u;(u=this._fullRequestReader)==null||u.cancel(F);for(const w of this._rangeRequestReaders.slice(0))w.cancel(F)}}t.PDFNodeStream=M;class S{constructor(F){this._url=F.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=F.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)(),this._headersCapability=(0,r.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const F=this._readableStream.read();return F===null?(this._readCapability=(0,r.createPromiseCapability)(),this.read()):(this._loaded+=F.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){if(!this._readableStream){this._error(F);return}this._readableStream.destroy(F)}_error(F){this._storedError=F,this._readCapability.resolve()}_setReadableStream(F){this._readableStream=F,F.on("readable",()=>{this._readCapability.resolve()}),F.on("end",()=>{F.destroy(),this._done=!0,this._readCapability.resolve()}),F.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class d{constructor(F){this._url=F.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)();const u=F.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const F=this._readableStream.read();return F===null?(this._readCapability=(0,r.createPromiseCapability)(),this.read()):(this._loaded+=F.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){if(!this._readableStream){this._error(F);return}this._readableStream.destroy(F)}_error(F){this._storedError=F,this._readCapability.resolve()}_setReadableStream(F){this._readableStream=F,F.on("readable",()=>{this._readCapability.resolve()}),F.on("end",()=>{F.destroy(),this._done=!0,this._readCapability.resolve()}),F.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(L,F){return{protocol:L.protocol,auth:L.auth,host:L.hostname,port:L.port,path:L.path,method:"GET",headers:F}}class c extends S{constructor(F){super(F);const u=w=>{if(w.statusCode===404){const I=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=I,this._headersCapability.reject(I);return}this._headersCapability.resolve(),this._setReadableStream(w);const y=I=>this._readableStream.headers[I.toLowerCase()],{allowRangeRequests:l,suggestedLength:h}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:F.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(y)};this._request=null,this._url.protocol==="http:"?this._request=p.request(f(this._url,F.httpHeaders),u):this._request=g.request(f(this._url,F.httpHeaders),u),this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class a extends d{constructor(F,u,w){super(F),this._httpHeaders={};for(const l in F.httpHeaders){const h=F.httpHeaders[l];h!==void 0&&(this._httpHeaders[l]=h)}this._httpHeaders.Range=`bytes=${u}-${w-1}`;const y=l=>{if(l.statusCode===404){const h=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h;return}this._setReadableStream(l)};this._request=null,this._url.protocol==="http:"?this._request=p.request(f(this._url,this._httpHeaders),y):this._request=g.request(f(this._url,this._httpHeaders),y),this._request.on("error",l=>{this._storedError=l}),this._request.end()}}class o extends S{constructor(F){super(F);let u=decodeURIComponent(this._url.path);C.test(this._url.href)&&(u=u.replace(/^\//,"")),i.lstat(u,(w,y)=>{if(w){w.code==="ENOENT"&&(w=new r.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=y.size,this._setReadableStream(i.createReadStream(u)),this._headersCapability.resolve()})}}class R extends d{constructor(F,u,w){super(F);let y=decodeURIComponent(this._url.path);C.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(i.createReadStream(y,{start:u,end:w-1}))}}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=m,t.extractFilenameFromHeader=g,t.validateRangeRequestCapabilities=p,t.validateResponseStatus=C;var r=e(1),s=e(23),i=e(6);function p({getResponseHeader:b,isHttp:M,rangeChunkSize:S,disableRange:d}){const f={allowRangeRequests:!1,suggestedLength:void 0},c=parseInt(b("Content-Length"),10);return!Number.isInteger(c)||(f.suggestedLength=c,c<=2*S)||d||!M||b("Accept-Ranges")!=="bytes"||(b("Content-Encoding")||"identity")!=="identity"||(f.allowRangeRequests=!0),f}function g(b){const M=b("Content-Disposition");if(M){let S=(0,s.getFilenameFromContentDispositionHeader)(M);if(S.includes("%"))try{S=decodeURIComponent(S)}catch{}if((0,i.isPdfFile)(S))return S}return null}function m(b,M){return b===404||b===0&&M.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+M+'".'):new r.UnexpectedResponseException(`Unexpected server response (${b}) while retrieving PDF "${M}".`,b)}function C(b){return b===200||b===206}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=s;var r=e(1);function s(i){let p=!0,g=m("filename\\*","i").exec(i);if(g){g=g[1];let c=S(g);return c=unescape(c),c=d(c),c=f(c),b(c)}if(g=M(i),g){const c=f(g);return b(c)}if(g=m("filename","i").exec(i),g){g=g[1];let c=S(g);return c=f(c),b(c)}function m(c,a){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',a)}function C(c,a){if(c){if(!/^[\x00-\xFF]+$/.test(a))return a;try{const o=new TextDecoder(c,{fatal:!0}),R=(0,r.stringToBytes)(a);a=o.decode(R),p=!1}catch{}}return a}function b(c){return p&&/[\x80-\xff]/.test(c)&&(c=C("utf-8",c),p&&(c=C("iso-8859-1",c))),c}function M(c){const a=[];let o;const R=m("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(o=R.exec(c))!==null;){let[,F,u,w]=o;if(F=parseInt(F,10),F in a){if(F===0)break;continue}a[F]=[u,w]}const L=[];for(let F=0;F<a.length&&F in a;++F){let[u,w]=a[F];w=S(w),u&&(w=unescape(w),F===0&&(w=d(w))),L.push(w)}return L.join("")}function S(c){if(c.startsWith('"')){const a=c.slice(1).split('\\"');for(let o=0;o<a.length;++o){const R=a[o].indexOf('"');R!==-1&&(a[o]=a[o].slice(0,R),a.length=o+1),a[o]=a[o].replaceAll(/\\(.)/g,"$1")}c=a.join('"')}return c}function d(c){const a=c.indexOf("'");if(a===-1)return c;const o=c.slice(0,a),L=c.slice(a+1).replace(/^[^']*'/,"");return C(o,L)}function f(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(a,o,R,L){if(R==="q"||R==="Q")return L=L.replaceAll("_"," "),L=L.replaceAll(/=([0-9a-fA-F]{2})/g,function(F,u){return String.fromCharCode(parseInt(u,16))}),C(o,L);try{L=atob(L)}catch{}return C(o,L)})}return""}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var r=e(1),s=e(22);const i=200,p=206;function g(S){const d=S.response;return typeof d!="string"?d:(0,r.stringToBytes)(d).buffer}class m{constructor(d,f={}){this.url=d,this.isHttp=/^https?:/i.test(d),this.httpHeaders=this.isHttp&&f.httpHeaders||Object.create(null),this.withCredentials=f.withCredentials||!1,this.getXhr=f.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(d,f,c){const a={begin:d,end:f};for(const o in c)a[o]=c[o];return this.request(a)}requestFull(d){return this.request(d)}request(d){const f=this.getXhr(),c=this.currXhrId++,a=this.pendingRequests[c]={xhr:f};f.open("GET",this.url),f.withCredentials=this.withCredentials;for(const o in this.httpHeaders){const R=this.httpHeaders[o];R!==void 0&&f.setRequestHeader(o,R)}return this.isHttp&&"begin"in d&&"end"in d?(f.setRequestHeader("Range",`bytes=${d.begin}-${d.end-1}`),a.expectedStatus=p):a.expectedStatus=i,f.responseType="arraybuffer",d.onError&&(f.onerror=function(o){d.onError(f.status)}),f.onreadystatechange=this.onStateChange.bind(this,c),f.onprogress=this.onProgress.bind(this,c),a.onHeadersReceived=d.onHeadersReceived,a.onDone=d.onDone,a.onError=d.onError,a.onProgress=d.onProgress,f.send(null),c}onProgress(d,f){var a;const c=this.pendingRequests[d];c&&((a=c.onProgress)==null||a.call(c,f))}onStateChange(d,f){var F,u,w;const c=this.pendingRequests[d];if(!c)return;const a=c.xhr;if(a.readyState>=2&&c.onHeadersReceived&&(c.onHeadersReceived(),delete c.onHeadersReceived),a.readyState!==4||!(d in this.pendingRequests))return;if(delete this.pendingRequests[d],a.status===0&&this.isHttp){(F=c.onError)==null||F.call(c,a.status);return}const o=a.status||i;if(!(o===i&&c.expectedStatus===p)&&o!==c.expectedStatus){(u=c.onError)==null||u.call(c,a.status);return}const L=g(a);if(o===p){const y=a.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(y);c.onDone({begin:parseInt(l[1],10),chunk:L})}else L?c.onDone({begin:0,chunk:L}):(w=c.onError)==null||w.call(c,a.status)}getRequestXhr(d){return this.pendingRequests[d].xhr}isPendingRequest(d){return d in this.pendingRequests}abortRequest(d){const f=this.pendingRequests[d].xhr;delete this.pendingRequests[d],f.abort()}}class C{constructor(d){this._source=d,this._manager=new m(d.url,{httpHeaders:d.httpHeaders,withCredentials:d.withCredentials}),this._rangeChunkSize=d.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(d){const f=this._rangeRequestReaders.indexOf(d);f>=0&&this._rangeRequestReaders.splice(f,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new b(this._manager,this._source),this._fullRequestReader}getRangeReader(d,f){const c=new M(this._manager,d,f);return c.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(c),c}cancelAllRequests(d){var f;(f=this._fullRequestReader)==null||f.cancel(d);for(const c of this._rangeRequestReaders.slice(0))c.cancel(d)}}t.PDFNetworkStream=C;class b{constructor(d,f){this._manager=d;const c={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=f.url,this._fullRequestId=d.requestFull(c),this._headersReceivedCapability=(0,r.createPromiseCapability)(),this._disableRange=f.disableRange||!1,this._contentLength=f.length,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const d=this._fullRequestId,f=this._manager.getRequestXhr(d),c=R=>f.getResponseHeader(R),{allowRangeRequests:a,suggestedLength:o}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(c),this._isRangeSupported&&this._manager.abortRequest(d),this._headersReceivedCapability.resolve()}_onDone(d){if(d&&(this._requests.length>0?this._requests.shift().resolve({value:d.chunk,done:!1}):this._cachedChunks.push(d.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(d){this._storedError=(0,s.createResponseStatusError)(d,this._url),this._headersReceivedCapability.reject(this._storedError);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(d){var f;(f=this.onProgress)==null||f.call(this,{loaded:d.loaded,total:d.lengthComputable?d.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const d=(0,r.createPromiseCapability)();return this._requests.push(d),d.promise}cancel(d){this._done=!0,this._headersReceivedCapability.reject(d);for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class M{constructor(d,f,c){this._manager=d;const a={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._requestId=d.requestRange(f,c,a),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var d;(d=this.onClosed)==null||d.call(this,this)}_onDone(d){const f=d.chunk;this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunk=f,this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(d){this._storedError=(0,s.createResponseStatusError)(d,this._url);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(d){var f;this.isStreamingSupported||(f=this.onProgress)==null||f.call(this,{loaded:d.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const d=(0,r.createPromiseCapability)();return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var r=e(1),s=e(22);function i(M,S,d){return{method:"GET",headers:M,signal:d.signal,mode:"cors",credentials:S?"include":"same-origin",redirect:"follow"}}function p(M){const S=new Headers;for(const d in M){const f=M[d];f!==void 0&&S.append(d,f)}return S}function g(M){return M instanceof Uint8Array?M.buffer:M instanceof ArrayBuffer?M:((0,r.warn)(`getArrayBuffer - unexpected data format: ${M}`),new Uint8Array(M).buffer)}class m{constructor(S){this.source=S,this.isHttp=/^https?:/i.test(S.url),this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new C(this),this._fullRequestReader}getRangeReader(S,d){if(d<=this._progressiveDataLength)return null;const f=new b(this,S,d);return this._rangeRequestReaders.push(f),f}cancelAllRequests(S){var d;(d=this._fullRequestReader)==null||d.cancel(S);for(const f of this._rangeRequestReaders.slice(0))f.cancel(S)}}t.PDFFetchStream=m;class C{constructor(S){this._stream=S,this._reader=null,this._loaded=0,this._filename=null;const d=S.source;this._withCredentials=d.withCredentials||!1,this._contentLength=d.length,this._headersCapability=(0,r.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!d.disableStream,this._isRangeSupported=!d.disableRange,this._headers=p(this._stream.httpHeaders);const f=d.url;fetch(f,i(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,s.validateResponseStatus)(c.status))throw(0,s.createResponseStatusError)(c.status,f);this._reader=c.body.getReader(),this._headersCapability.resolve();const a=L=>c.headers.get(L),{allowRangeRequests:o,suggestedLength:R}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:a,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=R||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._headersCapability.promise;const{value:S,done:d}=await this._reader.read();return d?{value:S,done:d}:(this._loaded+=S.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded,total:this._contentLength}),{value:g(S),done:!1})}cancel(S){var d;(d=this._reader)==null||d.cancel(S),this._abortController.abort()}}class b{constructor(S,d,f){this._stream=S,this._reader=null,this._loaded=0;const c=S.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,r.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,this._abortController=new AbortController,this._headers=p(this._stream.httpHeaders),this._headers.append("Range",`bytes=${d}-${f-1}`);const a=c.url;fetch(a,i(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,s.validateResponseStatus)(o.status))throw(0,s.createResponseStatusError)(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._readCapability.promise;const{value:S,done:d}=await this._reader.read();return d?{value:S,done:d}:(this._loaded+=S.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded}),{value:g(S),done:!1})}cancel(S){var d;(d=this._reader)==null||d.cancel(S),this._abortController.abort()}}},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=c,t.updateTextLayer=a;var r=e(1),s=e(6);const i=1e5,p=30,g=.8,m=new Map;function C(o,R){let L;if(R&&r.FeatureTest.isOffscreenCanvasSupported)L=new OffscreenCanvas(o,o).getContext("2d",{alpha:!1});else{const F=document.createElement("canvas");F.width=F.height=o,L=F.getContext("2d",{alpha:!1})}return L}function b(o,R){const L=m.get(o);if(L)return L;const F=C(p,R);F.font=`${p}px ${o}`;const u=F.measureText("");let w=u.fontBoundingBoxAscent,y=Math.abs(u.fontBoundingBoxDescent);if(w){const h=w/(w+y);return m.set(o,h),F.canvas.width=F.canvas.height=0,h}F.strokeStyle="red",F.clearRect(0,0,p,p),F.strokeText("g",0,0);let l=F.getImageData(0,0,p,p).data;y=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){y=Math.ceil(h/4/p);break}F.clearRect(0,0,p,p),F.strokeText("A",0,p),l=F.getImageData(0,0,p,p).data,w=0;for(let h=0,I=l.length;h<I;h+=4)if(l[h]>0){w=p-Math.floor(h/4/p);break}if(F.canvas.width=F.canvas.height=0,w){const h=w/(w+y);return m.set(o,h),h}return m.set(o,g),g}function M(o,R,L){const F=document.createElement("span"),u={angle:0,canvasWidth:0,hasText:R.str!=="",hasEOL:R.hasEOL,fontSize:0};o._textDivs.push(F);const w=r.Util.transform(o._transform,R.transform);let y=Math.atan2(w[1],w[0]);const l=L[R.fontName];l.vertical&&(y+=Math.PI/2);const h=Math.hypot(w[2],w[3]),I=h*b(l.fontFamily,o._isOffscreenCanvasSupported);let k,T;y===0?(k=w[4],T=w[5]-I):(k=w[4]+I*Math.sin(y),T=w[5]-I*Math.cos(y));const U="calc(var(--scale-factor)*",_=F.style;o._container===o._rootContainer?(_.left=`${(100*k/o._pageWidth).toFixed(2)}%`,_.top=`${(100*T/o._pageHeight).toFixed(2)}%`):(_.left=`${U}${k.toFixed(2)}px)`,_.top=`${U}${T.toFixed(2)}px)`),_.fontSize=`${U}${h.toFixed(2)}px)`,_.fontFamily=l.fontFamily,u.fontSize=h,F.setAttribute("role","presentation"),F.textContent=R.str,F.dir=R.dir,o._fontInspectorEnabled&&(F.dataset.fontName=R.fontName),y!==0&&(u.angle=y*(180/Math.PI));let V=!1;if(R.str.length>1)V=!0;else if(R.str!==" "&&R.transform[0]!==R.transform[3]){const lt=Math.abs(R.transform[0]),J=Math.abs(R.transform[3]);lt!==J&&Math.max(lt,J)/Math.min(lt,J)>1.5&&(V=!0)}V&&(u.canvasWidth=l.vertical?R.height:R.width),o._textDivProperties.set(F,u),o._isReadableStream&&o._layoutText(F)}function S(o){const{div:R,scale:L,properties:F,ctx:u,prevFontSize:w,prevFontFamily:y}=o,{style:l}=R;let h="";if(F.canvasWidth!==0&&F.hasText){const{fontFamily:I}=l,{canvasWidth:k,fontSize:T}=F;(w!==T||y!==I)&&(u.font=`${T*L}px ${I}`,o.prevFontSize=T,o.prevFontFamily=I);const{width:U}=u.measureText(R.textContent);U>0&&(h=`scaleX(${k*L/U})`)}F.angle!==0&&(h=`rotate(${F.angle}deg) ${h}`),h.length>0&&(l.transform=h)}function d(o){if(o._canceled)return;const R=o._textDivs,L=o._capability;if(R.length>i){L.resolve();return}if(!o._isReadableStream)for(const u of R)o._layoutText(u);L.resolve()}class f{constructor({textContentSource:R,container:L,viewport:F,textDivs:u,textDivProperties:w,textContentItemsStr:y,isOffscreenCanvasSupported:l}){var U;this._textContentSource=R,this._isReadableStream=R instanceof ReadableStream,this._container=this._rootContainer=L,this._textDivs=u||[],this._textContentItemsStr=y||[],this._isOffscreenCanvasSupported=l,this._fontInspectorEnabled=!!((U=globalThis.FontInspector)!=null&&U.enabled),this._reader=null,this._textDivProperties=w||new WeakMap,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:F.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:C(0,l)};const{pageWidth:h,pageHeight:I,pageX:k,pageY:T}=F.rawDims;this._transform=[1,0,0,-1,-k,T+I],this._pageWidth=h,this._pageHeight=I,(0,s.setLayerDimensions)(L,F),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(R,L){for(const F of R){if(F.str===void 0){if(F.type==="beginMarkedContentProps"||F.type==="beginMarkedContent"){const u=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),F.id!==null&&this._container.setAttribute("id",`${F.id}`),u.append(this._container)}else F.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(F.str),M(this,F,L)}}_layoutText(R){const L=this._layoutTextParams.properties=this._textDivProperties.get(R);if(this._layoutTextParams.div=R,S(this._layoutTextParams),L.hasText&&this._container.append(R),L.hasEOL){const F=document.createElement("br");F.setAttribute("role","presentation"),this._container.append(F)}}_render(){const R=(0,r.createPromiseCapability)();let L=Object.create(null);if(this._isReadableStream){const F=()=>{this._reader.read().then(({value:u,done:w})=>{if(w){R.resolve();return}Object.assign(L,u.styles),this._processItems(u.items,L),F()},R.reject)};this._reader=this._textContentSource.getReader(),F()}else if(this._textContentSource){const{items:F,styles:u}=this._textContentSource;this._processItems(F,u),R.resolve()}else throw new Error('No "textContentSource" parameter specified.');R.promise.then(()=>{L=null,d(this)},this._capability.reject)}}t.TextLayerRenderTask=f;function c(o){!o.textContentSource&&(o.textContent||o.textContentStream)&&((0,s.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),o.textContentSource=o.textContent||o.textContentStream);const{container:R,viewport:L}=o,F=getComputedStyle(R),u=F.getPropertyValue("visibility"),w=parseFloat(F.getPropertyValue("--scale-factor"));u==="visible"&&(!w||Math.abs(w-L.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const y=new f(o);return y._render(),y}function a({container:o,viewport:R,textDivs:L,textDivProperties:F,isOffscreenCanvasSupported:u,mustRotate:w=!0,mustRescale:y=!0}){if(w&&(0,s.setLayerDimensions)(o,{rotation:R.rotation}),y){const l=C(0,u),I={prevFontSize:null,prevFontFamily:null,div:null,scale:R.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l};for(const k of L)I.properties=F.get(k),I.div=k,S(I)}}},(x,t,e)=>{var C,b,M,S,d,f,c,a,o,_e,L,je,u,ye,y,ve;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var r=e(1),s=e(5),i=e(28),p=e(29),g=e(6);const h=class{constructor(k){ft(this,o);ft(this,L);ft(this,u);ft(this,y);ft(this,C,void 0);ft(this,b,!1);ft(this,M,this.pointerup.bind(this));ft(this,S,this.pointerdown.bind(this));ft(this,d,new Map);ft(this,f,!1);ft(this,c,!1);ft(this,a,void 0);h._initialized||(h._initialized=!0,i.FreeTextEditor.initialize(k.l10n),p.InkEditor.initialize(k.l10n)),k.uiManager.registerEditorTypes([i.FreeTextEditor,p.InkEditor]),vt(this,a,k.uiManager),this.pageIndex=k.pageIndex,this.div=k.div,vt(this,C,k.accessibilityManager),z(this,a).addLayer(this)}get isEmpty(){return z(this,d).size===0}updateToolbar(k){z(this,a).updateToolbar(k)}updateMode(k=z(this,a).getMode()){gt(this,y,ve).call(this),k===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),z(this,a).unselectAll(),k!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",k===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",k===r.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(k){if(!k&&z(this,a).getMode()!==r.AnnotationEditorType.INK)return;if(!k){for(const U of z(this,d).values())if(U.isEmpty()){U.setInBackground();return}}gt(this,u,ye).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(k){z(this,a).setEditingState(k)}addCommands(k){z(this,a).addCommands(k)}enable(){this.div.style.pointerEvents="auto";for(const k of z(this,d).values())k.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const k of z(this,d).values())k.disableEditing();gt(this,y,ve).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(k){z(this,a).getActive()!==k&&z(this,a).setActiveEditor(k)}enableClick(){this.div.addEventListener("pointerdown",z(this,S)),this.div.addEventListener("pointerup",z(this,M))}disableClick(){this.div.removeEventListener("pointerdown",z(this,S)),this.div.removeEventListener("pointerup",z(this,M))}attach(k){z(this,d).set(k.id,k)}detach(k){var T;z(this,d).delete(k.id),(T=z(this,C))==null||T.removePointerInTextLayer(k.contentDiv)}remove(k){z(this,a).removeEditor(k),this.detach(k),k.div.style.display="none",setTimeout(()=>{k.div.style.display="",k.div.remove(),k.isAttachedToDOM=!1,document.activeElement===document.body&&z(this,a).focusMainContainer()},0),z(this,c)||this.addInkEditorIfNeeded(!1)}add(k){if(gt(this,o,_e).call(this,k),z(this,a).addEditor(k),this.attach(k),!k.isAttachedToDOM){const T=k.render();this.div.append(T),k.isAttachedToDOM=!0}this.moveEditorInDOM(k),k.onceAdded(),z(this,a).addToAnnotationStorage(k)}moveEditorInDOM(k){var T;(T=z(this,C))==null||T.moveElementInDOM(this.div,k.div,k.contentDiv,!0)}addOrRebuild(k){k.needsToBeRebuilt()?k.rebuild():this.add(k)}addANewEditor(k){const T=()=>{this.addOrRebuild(k)},U=()=>{k.remove()};this.addCommands({cmd:T,undo:U,mustExec:!0})}addUndoableEditor(k){const T=()=>{this.addOrRebuild(k)},U=()=>{k.remove()};this.addCommands({cmd:T,undo:U,mustExec:!1})}getNextId(){return z(this,a).getId()}deserialize(k){switch(k.annotationType){case r.AnnotationEditorType.FREETEXT:return i.FreeTextEditor.deserialize(k,this,z(this,a));case r.AnnotationEditorType.INK:return p.InkEditor.deserialize(k,this,z(this,a))}return null}setSelected(k){z(this,a).setSelected(k)}toggleSelected(k){z(this,a).toggleSelected(k)}isSelected(k){return z(this,a).isSelected(k)}unselect(k){z(this,a).unselect(k)}pointerup(k){const{isMac:T}=r.FeatureTest.platform;if(!(k.button!==0||k.ctrlKey&&T)&&k.target===this.div&&z(this,f)){if(vt(this,f,!1),!z(this,b)){vt(this,b,!0);return}gt(this,u,ye).call(this,k)}}pointerdown(k){const{isMac:T}=r.FeatureTest.platform;if(k.button!==0||k.ctrlKey&&T||k.target!==this.div)return;vt(this,f,!0);const U=z(this,a).getActive();vt(this,b,!U||U.isEmpty())}drop(k){const T=k.dataTransfer.getData("text/plain"),U=z(this,a).getEditor(T);if(!U)return;k.preventDefault(),k.dataTransfer.dropEffect="move",gt(this,o,_e).call(this,U);const _=this.div.getBoundingClientRect(),V=k.clientX-_.x,lt=k.clientY-_.y;U.translate(V-U.startX,lt-U.startY),this.moveEditorInDOM(U),U.div.focus()}dragover(k){k.preventDefault()}destroy(){var k,T;((k=z(this,a).getActive())==null?void 0:k.parent)===this&&z(this,a).setActiveEditor(null);for(const U of z(this,d).values())(T=z(this,C))==null||T.removePointerInTextLayer(U.contentDiv),U.setParent(null),U.isAttachedToDOM=!1,U.div.remove();this.div=null,z(this,d).clear(),z(this,a).removeLayer(this)}render({viewport:k}){this.viewport=k,(0,g.setLayerDimensions)(this.div,k),(0,s.bindEvents)(this,this.div,["dragover","drop"]);for(const T of z(this,a).getEditors(this.pageIndex))this.add(T);this.updateMode()}update({viewport:k}){z(this,a).commitOrRemove(),this.viewport=k,(0,g.setLayerDimensions)(this.div,{rotation:k.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:k,pageHeight:T}=this.viewport.rawDims;return[k,T]}};let m=h;C=new WeakMap,b=new WeakMap,M=new WeakMap,S=new WeakMap,d=new WeakMap,f=new WeakMap,c=new WeakMap,a=new WeakMap,o=new WeakSet,_e=function(k){var T;k.parent!==this&&(this.attach(k),(T=k.parent)==null||T.detach(k),k.setParent(this),k.div&&k.isAttachedToDOM&&(k.div.remove(),this.div.append(k.div)))},L=new WeakSet,je=function(k){switch(z(this,a).getMode()){case r.AnnotationEditorType.FREETEXT:return new i.FreeTextEditor(k);case r.AnnotationEditorType.INK:return new p.InkEditor(k)}return null},u=new WeakSet,ye=function(k){const T=this.getNextId(),U=gt(this,L,je).call(this,{parent:this,id:T,x:k.offsetX,y:k.offsetY,uiManager:z(this,a)});return U&&this.add(U),U},y=new WeakSet,ve=function(){vt(this,c,!0);for(const k of z(this,d).values())k.isEmpty()&&k.remove();vt(this,c,!1)},Dt(m,"_initialized",!1),t.AnnotationEditorLayer=m},(x,t,e)=>{var g,m,C,b,M,S,d,f,c,a,ze,R,Ue,F,Xe,w,Ae;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var r=e(1),s=e(5),i=e(4);const l=class extends i.AnnotationEditor{constructor(k){super({...k,name:"freeTextEditor"});ft(this,a);ft(this,R);ft(this,F);ft(this,w);ft(this,g,this.editorDivBlur.bind(this));ft(this,m,this.editorDivFocus.bind(this));ft(this,C,this.editorDivInput.bind(this));ft(this,b,this.editorDivKeydown.bind(this));ft(this,M,void 0);ft(this,S,"");ft(this,d,`${this.id}-editor`);ft(this,f,!1);ft(this,c,void 0);vt(this,M,k.color||l._defaultColor||i.AnnotationEditor._defaultLineColor),vt(this,c,k.fontSize||l._defaultFontSize)}static initialize(k){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(U=>[U,k.get(U)]));const T=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(T.getPropertyValue("--freetext-padding"))}static updateDefaultParams(k,T){switch(k){case r.AnnotationEditorParamsType.FREETEXT_SIZE:l._defaultFontSize=T;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:l._defaultColor=T;break}}updateParams(k,T){switch(k){case r.AnnotationEditorParamsType.FREETEXT_SIZE:gt(this,a,ze).call(this,T);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:gt(this,R,Ue).call(this,T);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,l._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,l._defaultColor||i.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,z(this,c)],[r.AnnotationEditorParamsType.FREETEXT_COLOR,z(this,M)]]}getInitialTranslation(){const k=this.parentScale;return[-l._internalPadding*k,-(l._internalPadding+z(this,c))*k]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",z(this,b)),this.editorDiv.addEventListener("focus",z(this,m)),this.editorDiv.addEventListener("blur",z(this,g)),this.editorDiv.addEventListener("input",z(this,C)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",z(this,d)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",z(this,b)),this.editorDiv.removeEventListener("focus",z(this,m)),this.editorDiv.removeEventListener("blur",z(this,g)),this.editorDiv.removeEventListener("input",z(this,C)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(k){super.focusin(k),k.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),z(this,f)||(vt(this,f,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),vt(this,S,gt(this,F,Xe).call(this).trimEnd()),gt(this,w,Ae).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(k){this.enableEditMode(),this.editorDiv.focus()}keydown(k){k.target===this.div&&k.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(k){l._keyboardManager.exec(this,k)}editorDivFocus(k){this.isEditing=!0}editorDivBlur(k){this.isEditing=!1}editorDivInput(k){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let k,T;this.width&&(k=this.x,T=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",z(this,d)),this.enableEditing(),l._l10nPromise.get("editor_free_text2_aria_label").then(_=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("aria-label",_)}),l._l10nPromise.get("free_text2_default_content").then(_=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("default-content",_)}),this.editorDiv.contentEditable=!0;const{style:U}=this.editorDiv;if(U.fontSize=`calc(${z(this,c)}px * var(--scale-factor))`,U.color=z(this,M),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,s.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[_,V]=this.parentDimensions;this.setAt(k*_,T*V,this.width*_,this.height*V);for(const lt of z(this,S).split(`
`)){const J=document.createElement("div");J.append(lt?document.createTextNode(lt):document.createElement("br")),this.editorDiv.append(J)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(k,T,U){const _=super.deserialize(k,T,U);return vt(_,c,k.fontSize),vt(_,M,r.Util.makeHexColor(...k.color)),vt(_,S,k.value),_}serialize(){if(this.isEmpty())return null;const k=l._internalPadding*this.parentScale,T=this.getRect(k,k),U=i.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:z(this,M));return{annotationType:r.AnnotationEditorType.FREETEXT,color:U,fontSize:z(this,c),value:z(this,S),pageIndex:this.pageIndex,rect:T,rotation:this.rotation}}};let p=l;g=new WeakMap,m=new WeakMap,C=new WeakMap,b=new WeakMap,M=new WeakMap,S=new WeakMap,d=new WeakMap,f=new WeakMap,c=new WeakMap,a=new WeakSet,ze=function(k){const T=_=>{this.editorDiv.style.fontSize=`calc(${_}px * var(--scale-factor))`,this.translate(0,-(_-z(this,c))*this.parentScale),vt(this,c,_),gt(this,w,Ae).call(this)},U=z(this,c);this.addCommands({cmd:()=>{T(k)},undo:()=>{T(U)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},R=new WeakSet,Ue=function(k){const T=z(this,M);this.addCommands({cmd:()=>{vt(this,M,this.editorDiv.style.color=k)},undo:()=>{vt(this,M,this.editorDiv.style.color=T)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},F=new WeakSet,Xe=function(){const k=this.editorDiv.getElementsByTagName("div");if(k.length===0)return this.editorDiv.innerText;const T=[];for(const U of k)T.push(U.innerText.replace(/\r\n?|\n/,""));return T.join(`
`)},w=new WeakSet,Ae=function(){const[k,T]=this.parentDimensions;let U;if(this.isAttachedToDOM)U=this.div.getBoundingClientRect();else{const{currentLayer:_,div:V}=this,lt=V.style.display;V.style.display="hidden",_.div.append(this.div),U=V.getBoundingClientRect(),V.remove(),V.style.display=lt}this.width=U.width/k,this.height=U.height/T},Dt(p,"_freeTextDefaultContent",""),Dt(p,"_l10nPromise"),Dt(p,"_internalPadding",0),Dt(p,"_defaultColor",null),Dt(p,"_defaultFontSize",10),Dt(p,"_keyboardManager",new s.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],l.prototype.commitOrRemove]])),Dt(p,"_type","freetext"),t.FreeTextEditor=p},(x,t,e)=>{var C,b,M,S,d,f,c,a,o,R,L,F,u,w,y,We,h,He,k,$e,U,qe,V,Se,J,Ve,et,Ge,at,Ye,O,Ht,N,ke,H,ae,$,oe,it,Yt,W,we,v,le,A,Ee,j,Ke,K,Ze,rt,Je,st,Ce,mt,ce,yt,Kt,q,Pe;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0,Object.defineProperty(t,"fitCurve",{enumerable:!0,get:function(){return i.fitCurve}});var r=e(1),s=e(4),i=e(30),p=e(5);const g=16,tt=class extends s.AnnotationEditor{constructor(ut){super({...ut,name:"inkEditor"});ft(this,y);ft(this,h);ft(this,k);ft(this,U);ft(this,V);ft(this,J);ft(this,et);ft(this,at);ft(this,O);ft(this,N);ft(this,H);ft(this,$);ft(this,it);ft(this,W);ft(this,v);ft(this,j);ft(this,K);ft(this,rt);ft(this,st);ft(this,mt);ft(this,yt);ft(this,q);ft(this,C,0);ft(this,b,0);ft(this,M,0);ft(this,S,this.canvasPointermove.bind(this));ft(this,d,this.canvasPointerleave.bind(this));ft(this,f,this.canvasPointerup.bind(this));ft(this,c,this.canvasPointerdown.bind(this));ft(this,a,!1);ft(this,o,!1);ft(this,R,null);ft(this,L,null);ft(this,F,0);ft(this,u,0);ft(this,w,null);this.color=ut.color||null,this.thickness=ut.thickness||null,this.opacity=ut.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(ut){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(bt=>[bt,ut.get(bt)]))}static updateDefaultParams(ut,bt){switch(ut){case r.AnnotationEditorParamsType.INK_THICKNESS:tt._defaultThickness=bt;break;case r.AnnotationEditorParamsType.INK_COLOR:tt._defaultColor=bt;break;case r.AnnotationEditorParamsType.INK_OPACITY:tt._defaultOpacity=bt/100;break}}updateParams(ut,bt){switch(ut){case r.AnnotationEditorParamsType.INK_THICKNESS:gt(this,y,We).call(this,bt);break;case r.AnnotationEditorParamsType.INK_COLOR:gt(this,h,He).call(this,bt);break;case r.AnnotationEditorParamsType.INK_OPACITY:gt(this,k,$e).call(this,bt);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,tt._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,tt._defaultColor||s.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(tt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||tt._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||tt._defaultColor||s.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??tt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(gt(this,H,ae).call(this),gt(this,$,oe).call(this)),this.isAttachedToDOM||(this.parent.add(this),gt(this,it,Yt).call(this)),gt(this,yt,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,z(this,L).disconnect(),vt(this,L,null),super.remove())}setParent(ut){!this.parent&&ut?this._uiManager.removeShouldRescale(this):this.parent&&ut===null&&this._uiManager.addShouldRescale(this),super.setParent(ut)}onScaleChanging(){const[ut,bt]=this.parentDimensions,St=this.width*ut,kt=this.height*bt;this.setDimensions(St,kt)}enableEditMode(){z(this,a)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",z(this,c)),this.canvas.addEventListener("pointerup",z(this,f)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",z(this,c)),this.canvas.removeEventListener("pointerup",z(this,f)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){z(this,a)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),vt(this,a,!0),this.div.classList.add("disabled"),gt(this,yt,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(ut){super.focusin(ut),this.enableEditMode()}canvasPointerdown(ut){ut.button!==0||!this.isInEditMode()||z(this,a)||(this.setInForeground(),ut.type!=="mouse"&&this.div.focus(),ut.stopPropagation(),this.canvas.addEventListener("pointerleave",z(this,d)),this.canvas.addEventListener("pointermove",z(this,S)),gt(this,J,Ve).call(this,ut.offsetX,ut.offsetY))}canvasPointermove(ut){ut.stopPropagation(),gt(this,et,Ge).call(this,ut.offsetX,ut.offsetY)}canvasPointerup(ut){ut.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(ut.stopPropagation(),gt(this,N,ke).call(this,ut),this.setInBackground())}canvasPointerleave(ut){gt(this,N,ke).call(this,ut),this.setInBackground()}render(){if(this.div)return this.div;let ut,bt;this.width&&(ut=this.x,bt=this.y),super.render(),tt._l10nPromise.get("editor_ink2_aria_label").then(xt=>{var Ct;return(Ct=this.div)==null?void 0:Ct.setAttribute("aria-label",xt)});const[St,kt,Rt,Tt]=gt(this,U,qe).call(this);if(this.setAt(St,kt,0,0),this.setDims(Rt,Tt),gt(this,H,ae).call(this),this.width){const[xt,Ct]=this.parentDimensions;this.setAt(ut*xt,bt*Ct,this.width*xt,this.height*Ct),vt(this,o,!0),gt(this,it,Yt).call(this),this.setDims(this.width*xt,this.height*Ct),gt(this,O,Ht).call(this),gt(this,q,Pe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return gt(this,$,oe).call(this),this.div}setDimensions(ut,bt){const St=Math.round(ut),kt=Math.round(bt);if(z(this,F)===St&&z(this,u)===kt)return;vt(this,F,St),vt(this,u,kt),this.canvas.style.visibility="hidden",z(this,C)&&Math.abs(z(this,C)-ut/bt)>.01&&(bt=Math.ceil(ut/z(this,C)),this.setDims(ut,bt));const[Rt,Tt]=this.parentDimensions;this.width=ut/Rt,this.height=bt/Tt,z(this,a)&&gt(this,W,we).call(this,ut,bt),gt(this,it,Yt).call(this),gt(this,O,Ht).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(ut,bt,St){var Mt,Ot;const kt=super.deserialize(ut,bt,St);kt.thickness=ut.thickness,kt.color=r.Util.makeHexColor(...ut.color),kt.opacity=ut.opacity;const[Rt,Tt]=kt.pageDimensions,xt=kt.width*Rt,Ct=kt.height*Tt,Ft=kt.parentScale,Pt=ut.thickness/2;vt(kt,C,xt/Ct),vt(kt,a,!0),vt(kt,F,Math.round(xt)),vt(kt,u,Math.round(Ct));for(const{bezier:Lt}of ut.paths){const Bt=[];kt.paths.push(Bt);let It=Ft*(Lt[0]-Pt),jt=Ft*(Ct-Lt[1]-Pt);for(let zt=2,Qt=Lt.length;zt<Qt;zt+=6){const te=Ft*(Lt[zt]-Pt),ee=Ft*(Ct-Lt[zt+1]-Pt),re=Ft*(Lt[zt+2]-Pt),ne=Ft*(Ct-Lt[zt+3]-Pt),Re=Ft*(Lt[zt+4]-Pt),Fe=Ft*(Ct-Lt[zt+5]-Pt);Bt.push([[It,jt],[te,ee],[re,ne],[Re,Fe]]),It=Re,jt=Fe}const Xt=gt(this,A,Ee).call(this,Bt);kt.bezierPath2D.push(Xt)}const Nt=gt(Mt=kt,st,Ce).call(Mt);return vt(kt,M,Math.max(g,Nt[2]-Nt[0])),vt(kt,b,Math.max(g,Nt[3]-Nt[1])),gt(Ot=kt,W,we).call(Ot,xt,Ct),kt}serialize(){if(this.isEmpty())return null;const ut=this.getRect(0,0),bt=this.rotation%180===0?ut[3]-ut[1]:ut[2]-ut[0],St=s.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:gt(this,j,Ke).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,bt),pageIndex:this.pageIndex,rect:ut,rotation:this.rotation}}};let m=tt;C=new WeakMap,b=new WeakMap,M=new WeakMap,S=new WeakMap,d=new WeakMap,f=new WeakMap,c=new WeakMap,a=new WeakMap,o=new WeakMap,R=new WeakMap,L=new WeakMap,F=new WeakMap,u=new WeakMap,w=new WeakMap,y=new WeakSet,We=function(ut){const bt=this.thickness;this.addCommands({cmd:()=>{this.thickness=ut,gt(this,yt,Kt).call(this)},undo:()=>{this.thickness=bt,gt(this,yt,Kt).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},h=new WeakSet,He=function(ut){const bt=this.color;this.addCommands({cmd:()=>{this.color=ut,gt(this,O,Ht).call(this)},undo:()=>{this.color=bt,gt(this,O,Ht).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},k=new WeakSet,$e=function(ut){ut/=100;const bt=this.opacity;this.addCommands({cmd:()=>{this.opacity=ut,gt(this,O,Ht).call(this)},undo:()=>{this.opacity=bt,gt(this,O,Ht).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},U=new WeakSet,qe=function(){const{parentRotation:ut,parentDimensions:[bt,St]}=this;switch(ut){case 90:return[0,St,St,bt];case 180:return[bt,St,bt,St];case 270:return[bt,0,St,bt];default:return[0,0,bt,St]}},V=new WeakSet,Se=function(){const{ctx:ut,color:bt,opacity:St,thickness:kt,parentScale:Rt,scaleFactor:Tt}=this;ut.lineWidth=kt*Rt/Tt,ut.lineCap="round",ut.lineJoin="round",ut.miterLimit=10,ut.strokeStyle=`${bt}${(0,p.opacityToHex)(St)}`},J=new WeakSet,Ve=function(ut,bt){this.isEditing=!0,z(this,o)||(vt(this,o,!0),gt(this,it,Yt).call(this),this.thickness||(this.thickness=tt._defaultThickness),this.color||(this.color=tt._defaultColor||s.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=tt._defaultOpacity)),this.currentPath.push([ut,bt]),vt(this,R,null),gt(this,V,Se).call(this),this.ctx.beginPath(),this.ctx.moveTo(ut,bt),vt(this,w,()=>{z(this,w)&&(z(this,R)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):gt(this,O,Ht).call(this),this.ctx.lineTo(...z(this,R)),vt(this,R,null),this.ctx.stroke()),window.requestAnimationFrame(z(this,w)))}),window.requestAnimationFrame(z(this,w))},et=new WeakSet,Ge=function(ut,bt){const[St,kt]=this.currentPath.at(-1);ut===St&&bt===kt||(this.currentPath.push([ut,bt]),vt(this,R,[ut,bt]))},at=new WeakSet,Ye=function(ut,bt){var Ft;this.ctx.closePath(),vt(this,w,null),ut=Math.min(Math.max(ut,0),this.canvas.width),bt=Math.min(Math.max(bt,0),this.canvas.height);const[St,kt]=this.currentPath.at(-1);(ut!==St||bt!==kt)&&this.currentPath.push([ut,bt]);let Rt;if(this.currentPath.length!==1)Rt=(0,i.fitCurve)(this.currentPath,30,null);else{const Pt=[ut,bt];Rt=[[Pt,Pt.slice(),Pt.slice(),Pt]]}const Tt=gt(Ft=tt,A,Ee).call(Ft,Rt);this.currentPath.length=0;const xt=()=>{this.paths.push(Rt),this.bezierPath2D.push(Tt),this.rebuild()},Ct=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(gt(this,H,ae).call(this),gt(this,$,oe).call(this)),gt(this,yt,Kt).call(this))};this.addCommands({cmd:xt,undo:Ct,mustExec:!0})},O=new WeakSet,Ht=function(){if(this.isEmpty()){gt(this,v,le).call(this);return}gt(this,V,Se).call(this);const{canvas:ut,ctx:bt}=this;bt.setTransform(1,0,0,1,0,0),bt.clearRect(0,0,ut.width,ut.height),gt(this,v,le).call(this);for(const St of this.bezierPath2D)bt.stroke(St)},N=new WeakSet,ke=function(ut){gt(this,at,Ye).call(this,ut.offsetX,ut.offsetY),this.canvas.removeEventListener("pointerleave",z(this,d)),this.canvas.removeEventListener("pointermove",z(this,S)),this.addToAnnotationStorage()},H=new WeakSet,ae=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",tt._l10nPromise.get("editor_ink_canvas_aria_label").then(ut=>{var bt;return(bt=this.canvas)==null?void 0:bt.setAttribute("aria-label",ut)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$=new WeakSet,oe=function(){vt(this,L,new ResizeObserver(ut=>{const bt=ut[0].contentRect;bt.width&&bt.height&&this.setDimensions(bt.width,bt.height)})),z(this,L).observe(this.div)},it=new WeakSet,Yt=function(){if(!z(this,o))return;const[ut,bt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*ut),this.canvas.height=Math.ceil(this.height*bt),gt(this,v,le).call(this)},W=new WeakSet,we=function(ut,bt){const St=gt(this,mt,ce).call(this),kt=(ut-St)/z(this,M),Rt=(bt-St)/z(this,b);this.scaleFactor=Math.min(kt,Rt)},v=new WeakSet,le=function(){const ut=gt(this,mt,ce).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+ut,this.translationY*this.scaleFactor+ut)},A=new WeakSet,Ee=function(ut){const bt=new Path2D;for(let St=0,kt=ut.length;St<kt;St++){const[Rt,Tt,xt,Ct]=ut[St];St===0&&bt.moveTo(...Rt),bt.bezierCurveTo(Tt[0],Tt[1],xt[0],xt[1],Ct[0],Ct[1])}return bt},j=new WeakSet,Ke=function(ut,bt,St,kt){const Tt=[],xt=this.thickness/2;let Ct,Ft;for(const Pt of this.paths){Ct=[],Ft=[];for(let Nt=0,Mt=Pt.length;Nt<Mt;Nt++){const[Ot,Lt,Bt,It]=Pt[Nt],jt=ut*(Ot[0]+bt)+xt,Xt=kt-ut*(Ot[1]+St)-xt,zt=ut*(Lt[0]+bt)+xt,Qt=kt-ut*(Lt[1]+St)-xt,te=ut*(Bt[0]+bt)+xt,ee=kt-ut*(Bt[1]+St)-xt,re=ut*(It[0]+bt)+xt,ne=kt-ut*(It[1]+St)-xt;Nt===0&&(Ct.push(jt,Xt),Ft.push(jt,Xt)),Ct.push(zt,Qt,te,ee,re,ne),gt(this,K,Ze).call(this,jt,Xt,zt,Qt,te,ee,re,ne,4,Ft)}Tt.push({bezier:Ct,points:Ft})}return Tt},K=new WeakSet,Ze=function(ut,bt,St,kt,Rt,Tt,xt,Ct,Ft,Pt){if(gt(this,rt,Je).call(this,ut,bt,St,kt,Rt,Tt,xt,Ct)){Pt.push(xt,Ct);return}for(let Nt=1;Nt<Ft-1;Nt++){const Mt=Nt/Ft,Ot=1-Mt;let Lt=Mt*ut+Ot*St,Bt=Mt*bt+Ot*kt,It=Mt*St+Ot*Rt,jt=Mt*kt+Ot*Tt;const Xt=Mt*Rt+Ot*xt,zt=Mt*Tt+Ot*Ct;Lt=Mt*Lt+Ot*It,Bt=Mt*Bt+Ot*jt,It=Mt*It+Ot*Xt,jt=Mt*jt+Ot*zt,Lt=Mt*Lt+Ot*It,Bt=Mt*Bt+Ot*jt,Pt.push(Lt,Bt)}Pt.push(xt,Ct)},rt=new WeakSet,Je=function(ut,bt,St,kt,Rt,Tt,xt,Ct){const Pt=(3*St-2*ut-xt)**2,Nt=(3*kt-2*bt-Ct)**2,Mt=(3*Rt-ut-2*xt)**2,Ot=(3*Tt-bt-2*Ct)**2;return Math.max(Pt,Mt)+Math.max(Nt,Ot)<=10},st=new WeakSet,Ce=function(){let ut=1/0,bt=-1/0,St=1/0,kt=-1/0;for(const Rt of this.paths)for(const[Tt,xt,Ct,Ft]of Rt){const Pt=r.Util.bezierBoundingBox(...Tt,...xt,...Ct,...Ft);ut=Math.min(ut,Pt[0]),St=Math.min(St,Pt[1]),bt=Math.max(bt,Pt[2]),kt=Math.max(kt,Pt[3])}return[ut,St,bt,kt]},mt=new WeakSet,ce=function(){return z(this,a)?Math.ceil(this.thickness*this.parentScale):0},yt=new WeakSet,Kt=function(ut=!1){if(this.isEmpty())return;if(!z(this,a)){gt(this,O,Ht).call(this);return}const bt=gt(this,st,Ce).call(this),St=gt(this,mt,ce).call(this);vt(this,M,Math.max(g,bt[2]-bt[0])),vt(this,b,Math.max(g,bt[3]-bt[1]));const kt=Math.ceil(St+z(this,M)*this.scaleFactor),Rt=Math.ceil(St+z(this,b)*this.scaleFactor),[Tt,xt]=this.parentDimensions;this.width=kt/Tt,this.height=Rt/xt,vt(this,C,kt/Rt),gt(this,q,Pe).call(this);const Ct=this.translationX,Ft=this.translationY;this.translationX=-bt[0],this.translationY=-bt[1],gt(this,it,Yt).call(this),gt(this,O,Ht).call(this),vt(this,F,kt),vt(this,u,Rt),this.setDims(kt,Rt);const Pt=ut?St/this.scaleFactor/2:0;this.translate(Ct-this.translationX-Pt,Ft-this.translationY-Pt)},q=new WeakSet,Pe=function(){const{style:ut}=this.div;z(this,C)>=1?(ut.minHeight=`${g}px`,ut.minWidth=`${Math.round(z(this,C)*g)}px`):(ut.minWidth=`${g}px`,ut.minHeight=`${Math.round(g/z(this,C))}px`)},ft(m,A),Dt(m,"_defaultColor",null),Dt(m,"_defaultOpacity",1),Dt(m,"_defaultThickness",1),Dt(m,"_l10nPromise"),Dt(m,"_type","ink"),t.InkEditor=m},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fitCurve=void 0;const r=e(31);t.fitCurve=r},x=>{function t(f,c,a){if(!Array.isArray(f))throw new TypeError("First argument should be an array");if(f.forEach(F=>{if(!Array.isArray(F)||F.some(u=>typeof u!="number")||F.length!==f[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),f=f.filter((F,u)=>u===0||!F.every((w,y)=>w===f[u-1][y])),f.length<2)return[];const o=f.length,R=M(f[1],f[0]),L=M(f[o-2],f[o-1]);return e(f,R,L,c,a)}function e(f,c,a,o,R){var F,u,w,y,l,h,I,k,T,U,_,V,lt;if(f.length===2)return V=S.vectorLen(S.subtract(f[0],f[1]))/3,F=[f[0],S.addArrays(f[0],S.mulItems(c,V)),S.addArrays(f[1],S.mulItems(a,V)),f[1]],[F];if(u=g(f),[F,y,h]=r(f,u,u,c,a,R),y===0||y<o)return[F];if(y<o*o)for(w=u,l=y,I=h,lt=0;lt<20;lt++){if(w=i(F,f,w),[F,y,h]=r(f,u,w,c,a,R),y<o)return[F];if(h===I){let J=y/l;if(J>.9999&&J<1.0001)break}l=y,I=h}return _=[],k=S.subtract(f[h-1],f[h+1]),k.every(J=>J===0)&&(k=S.subtract(f[h-1],f[h]),[k[0],k[1]]=[-k[1],k[0]]),T=S.normalize(k),U=S.mulItems(T,-1),_=_.concat(e(f.slice(0,h+1),c,T,o,R)),_=_.concat(e(f.slice(h),U,a,o,R)),_}function r(f,c,a,o,R,L){var F,u,w;return F=s(f,a,o,R),[u,w]=m(f,F,c),L&&L({bez:F,points:f,params:c,maxErr:u,maxPoint:w}),[F,u,w]}function s(f,c,a,o){var R,L,F,u,w,y,l,h,I,k,T,U,_,V,lt,J,ct,et=f[0],pt=f[f.length-1];for(R=[et,null,null,pt],L=S.zeros_Xx2x2(c.length),_=0,V=c.length;_<V;_++)J=c[_],ct=1-J,F=L[_],F[0]=S.mulItems(a,3*J*(ct*ct)),F[1]=S.mulItems(o,3*ct*(J*J));for(u=[[0,0],[0,0]],w=[0,0],_=0,V=f.length;_<V;_++)J=c[_],F=L[_],u[0][0]+=S.dot(F[0],F[0]),u[0][1]+=S.dot(F[0],F[1]),u[1][0]+=S.dot(F[0],F[1]),u[1][1]+=S.dot(F[1],F[1]),lt=S.subtract(f[_],d.q([et,et,pt,pt],J)),w[0]+=S.dot(F[0],lt),w[1]+=S.dot(F[1],lt);return y=u[0][0]*u[1][1]-u[1][0]*u[0][1],l=u[0][0]*w[1]-u[1][0]*w[0],h=w[0]*u[1][1]-w[1]*u[0][1],I=y===0?0:h/y,k=y===0?0:l/y,U=S.vectorLen(S.subtract(et,pt)),T=1e-6*U,I<T||k<T?(R[1]=S.addArrays(et,S.mulItems(a,U/3)),R[2]=S.addArrays(pt,S.mulItems(o,U/3))):(R[1]=S.addArrays(et,S.mulItems(a,I)),R[2]=S.addArrays(pt,S.mulItems(o,k))),R}function i(f,c,a){return a.map((o,R)=>p(f,c[R],o))}function p(f,c,a){var o=S.subtract(d.q(f,a),c),R=d.qprime(f,a),L=S.mulMatrix(o,R),F=S.sum(S.squareItems(R))+2*S.mulMatrix(o,d.qprimeprime(f,a));return F===0?a:a-L/F}function g(f){var c=[],a,o,R;return f.forEach((L,F)=>{a=F?o+S.vectorLen(S.subtract(L,R)):0,c.push(a),o=a,R=L}),c=c.map(L=>L/o),c}function m(f,c,a){var o,R,L,F,u,w,y,l;R=0,L=Math.floor(f.length/2);const h=C(c,10);for(u=0,w=f.length;u<w;u++)y=f[u],l=b(c,a[u],h,10),F=S.subtract(d.q(c,l),y),o=F[0]*F[0]+F[1]*F[1],o>R&&(R=o,L=u);return[R,L]}var C=function(f,c){for(var a,o=[0],R=f[0],L=0,F=1;F<=c;F++)a=d.q(f,F/c),L+=S.vectorLen(S.subtract(a,R)),o.push(L),R=a;return o=o.map(u=>u/L),o};function b(f,c,a,o){if(c<0)return 0;if(c>1)return 1;for(var R,L,F,u,w,y=1;y<=o;y++)if(c<=a[y]){u=(y-1)/o,F=y/o,L=a[y-1],R=a[y],w=(c-L)/(R-L)*(F-u)+u;break}return w}function M(f,c){return S.normalize(S.subtract(f,c))}class S{static zeros_Xx2x2(c){for(var a=[];c--;)a.push([0,0]);return a}static mulItems(c,a){return c.map(o=>o*a)}static mulMatrix(c,a){return c.reduce((o,R,L)=>o+R*a[L],0)}static subtract(c,a){return c.map((o,R)=>o-a[R])}static addArrays(c,a){return c.map((o,R)=>o+a[R])}static addItems(c,a){return c.map(o=>o+a)}static sum(c){return c.reduce((a,o)=>a+o)}static dot(c,a){return S.mulMatrix(c,a)}static vectorLen(c){return Math.hypot(...c)}static divItems(c,a){return c.map(o=>o/a)}static squareItems(c){return c.map(a=>a*a)}static normalize(c){return this.divItems(c,this.vectorLen(c))}}class d{static q(c,a){var o=1-a,R=S.mulItems(c[0],o*o*o),L=S.mulItems(c[1],3*o*o*a),F=S.mulItems(c[2],3*o*a*a),u=S.mulItems(c[3],a*a*a);return S.addArrays(S.addArrays(R,L),S.addArrays(F,u))}static qprime(c,a){var o=1-a,R=S.mulItems(S.subtract(c[1],c[0]),3*o*o),L=S.mulItems(S.subtract(c[2],c[1]),6*o*a),F=S.mulItems(S.subtract(c[3],c[2]),3*a*a);return S.addArrays(S.addArrays(R,L),F)}static qprimeprime(c,a){return S.addArrays(S.mulItems(S.addArrays(S.subtract(c[2],S.mulItems(c[1],2)),c[0]),6*(1-a)),S.mulItems(S.addArrays(S.subtract(c[3],S.mulItems(c[2],2)),c[1]),6*a))}}x.exports=t,x.exports.fitCubic=e,x.exports.createTangent=M},(x,t,e)=>{var O,qt,N,Qe,Z,xe,ot,Te;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var r=e(1),s=e(6),i=e(3),p=e(33),g=e(34);const m=1e3,C=9,b=new WeakSet;function M(W){return{width:W[2]-W[0],height:W[3]-W[1]}}class S{static create(n){switch(n.data.annotationType){case r.AnnotationType.LINK:return new f(n);case r.AnnotationType.TEXT:return new c(n);case r.AnnotationType.WIDGET:switch(n.data.fieldType){case"Tx":return new o(n);case"Btn":return n.data.radioButton?new L(n):n.data.checkBox?new R(n):new F(n);case"Ch":return new u(n)}return new a(n);case r.AnnotationType.POPUP:return new w(n);case r.AnnotationType.FREETEXT:return new l(n);case r.AnnotationType.LINE:return new h(n);case r.AnnotationType.SQUARE:return new I(n);case r.AnnotationType.CIRCLE:return new k(n);case r.AnnotationType.POLYLINE:return new T(n);case r.AnnotationType.CARET:return new _(n);case r.AnnotationType.INK:return new V(n);case r.AnnotationType.POLYGON:return new U(n);case r.AnnotationType.HIGHLIGHT:return new lt(n);case r.AnnotationType.UNDERLINE:return new J(n);case r.AnnotationType.SQUIGGLY:return new ct(n);case r.AnnotationType.STRIKEOUT:return new et(n);case r.AnnotationType.STAMP:return new pt(n);case r.AnnotationType.FILEATTACHMENT:return new at(n);default:return new d(n)}}}class d{constructor(n,{isRenderable:v=!1,ignoreBorder:P=!1,createQuadrilaterals:A=!1}={}){this.isRenderable=v,this.data=n.data,this.layer=n.layer,this.page=n.page,this.viewport=n.viewport,this.linkService=n.linkService,this.downloadManager=n.downloadManager,this.imageResourcesPath=n.imageResourcesPath,this.renderForms=n.renderForms,this.svgFactory=n.svgFactory,this.annotationStorage=n.annotationStorage,this.enableScripting=n.enableScripting,this.hasJSActions=n.hasJSActions,this._fieldObjects=n.fieldObjects,v&&(this.container=this._createContainer(P)),A&&(this.quadrilaterals=this._createQuadrilaterals(P))}_createContainer(n=!1){const{data:v,page:P,viewport:A}=this,E=document.createElement("section");E.setAttribute("data-annotation-id",v.id),v.noRotate&&E.classList.add("norotate");const{pageWidth:j,pageHeight:Q,pageX:K,pageY:X}=A.rawDims,{width:rt,height:ht}=M(v.rect),st=r.Util.normalizeRect([v.rect[0],P.view[3]-v.rect[1]+P.view[1],v.rect[2],P.view[3]-v.rect[3]+P.view[1]]);if(!n&&v.borderStyle.width>0){E.style.borderWidth=`${v.borderStyle.width}px`;const mt=v.borderStyle.horizontalCornerRadius,At=v.borderStyle.verticalCornerRadius;if(mt>0||At>0){const wt=`calc(${mt}px * var(--scale-factor)) / calc(${At}px * var(--scale-factor))`;E.style.borderRadius=wt}else if(this instanceof L){const wt=`calc(${rt}px * var(--scale-factor)) / calc(${ht}px * var(--scale-factor))`;E.style.borderRadius=wt}switch(v.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:E.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:E.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:E.style.borderBottomStyle="solid";break}const yt=v.borderColor||null;yt?E.style.borderColor=r.Util.makeHexColor(yt[0]|0,yt[1]|0,yt[2]|0):E.style.borderWidth=0}E.style.left=`${100*(st[0]-K)/j}%`,E.style.top=`${100*(st[1]-X)/Q}%`;const{rotation:dt}=v;return v.hasOwnCanvas||dt===0?(E.style.width=`${100*rt/j}%`,E.style.height=`${100*ht/Q}%`):this.setRotation(dt,E),E}setRotation(n,v=this.container){const{pageWidth:P,pageHeight:A}=this.viewport.rawDims,{width:E,height:j}=M(this.data.rect);let Q,K;n%180===0?(Q=100*E/P,K=100*j/A):(Q=100*j/P,K=100*E/A),v.style.width=`${Q}%`,v.style.height=`${K}%`,v.setAttribute("data-main-rotation",(360-n)%360)}get _commonActions(){const n=(v,P,A)=>{const E=A.detail[v];A.target.style[P]=p.ColorConverters[`${E[0]}_HTML`](E.slice(1))};return(0,r.shadow)(this,"_commonActions",{display:v=>{const P=v.detail.display%2===1;this.container.style.visibility=P?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:P,print:v.detail.display===0||v.detail.display===3})},print:v=>{this.annotationStorage.setValue(this.data.id,{print:v.detail.print})},hidden:v=>{this.container.style.visibility=v.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:v.detail.hidden})},focus:v=>{setTimeout(()=>v.target.focus({preventScroll:!1}),0)},userName:v=>{v.target.title=v.detail.userName},readonly:v=>{v.detail.readonly?v.target.setAttribute("readonly",""):v.target.removeAttribute("readonly")},required:v=>{this._setRequired(v.target,v.detail.required)},bgColor:v=>{n("bgColor","backgroundColor",v)},fillColor:v=>{n("fillColor","backgroundColor",v)},fgColor:v=>{n("fgColor","color",v)},textColor:v=>{n("textColor","color",v)},borderColor:v=>{n("borderColor","borderColor",v)},strokeColor:v=>{n("strokeColor","borderColor",v)},rotation:v=>{const P=v.detail.rotation;this.setRotation(P),this.annotationStorage.setValue(this.data.id,{rotation:P})}})}_dispatchEventFromSandbox(n,v){const P=this._commonActions;for(const A of Object.keys(v.detail)){const E=n[A]||P[A];E==null||E(v)}}_setDefaultPropertiesFromJS(n){if(!this.enableScripting)return;const v=this.annotationStorage.getRawValue(this.data.id);if(!v)return;const P=this._commonActions;for(const[A,E]of Object.entries(v)){const j=P[A];if(j){const Q={detail:{[A]:E},target:n};j(Q),delete v[A]}}}_createQuadrilaterals(n=!1){if(!this.data.quadPoints)return null;const v=[],P=this.data.rect;for(const A of this.data.quadPoints)this.data.rect=[A[2].x,A[2].y,A[1].x,A[1].y],v.push(this._createContainer(n));return this.data.rect=P,v}_createPopup(n,v){let P=this.container;this.quadrilaterals&&(n=n||this.quadrilaterals,P=this.quadrilaterals[0]),n||(n=document.createElement("div"),n.classList.add("popupTriggerArea"),P.append(n));const E=new y({container:P,trigger:n,color:v.color,titleObj:v.titleObj,modificationDate:v.modificationDate,contentsObj:v.contentsObj,richText:v.richText,hideWrapper:!0}).render();E.style.left="100%",P.append(E)}_renderQuadrilaterals(n){for(const v of this.quadrilaterals)v.classList.add(n);return this.quadrilaterals}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(n,v=null){const P=[];if(this._fieldObjects){const A=this._fieldObjects[n];if(A)for(const{page:E,id:j,exportValues:Q}of A){if(E===-1||j===v)continue;const K=typeof Q=="string"?Q:null,X=document.querySelector(`[data-element-id="${j}"]`);if(X&&!b.has(X)){(0,r.warn)(`_getElementsByName - element not allowed: ${j}`);continue}P.push({id:j,exportValue:K,domElement:X})}return P}for(const A of document.getElementsByName(n)){const{exportValue:E}=A,j=A.getAttribute("data-element-id");j!==v&&b.has(A)&&P.push({id:j,exportValue:E,domElement:A})}return P}}class f extends d{constructor(v,P=null){super(v,{isRenderable:!0,ignoreBorder:!!(P!=null&&P.ignoreBorder),createQuadrilaterals:!0});ft(this,O);ft(this,N);this.isTooltipOnly=v.data.isTooltipOnly}render(){const{data:v,linkService:P}=this,A=document.createElement("a");A.setAttribute("data-element-id",v.id);let E=!1;return v.url?(P.addLinkAttributes(A,v.url,v.newWindow),E=!0):v.action?(this._bindNamedAction(A,v.action),E=!0):v.attachment?(this._bindAttachment(A,v.attachment),E=!0):v.setOCGState?(gt(this,N,Qe).call(this,A,v.setOCGState),E=!0):v.dest?(this._bindLink(A,v.dest),E=!0):(v.actions&&(v.actions.Action||v.actions["Mouse Up"]||v.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,v),E=!0),v.resetForm?(this._bindResetFormAction(A,v.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(A,""),E=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((j,Q)=>{const K=Q===0?A:A.cloneNode();return j.append(K),j}):(this.container.classList.add("linkAnnotation"),E&&this.container.append(A),this.container)}_bindLink(v,P){v.href=this.linkService.getDestinationHash(P),v.onclick=()=>(P&&this.linkService.goToDestination(P),!1),(P||P==="")&&gt(this,O,qt).call(this)}_bindNamedAction(v,P){v.href=this.linkService.getAnchorUrl(""),v.onclick=()=>(this.linkService.executeNamedAction(P),!1),gt(this,O,qt).call(this)}_bindAttachment(v,P){v.href=this.linkService.getAnchorUrl(""),v.onclick=()=>{var A;return(A=this.downloadManager)==null||A.openOrDownloadData(this.container,P.content,P.filename),!1},gt(this,O,qt).call(this)}_bindJSAction(v,P){v.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const E of Object.keys(P.actions)){const j=A.get(E);j&&(v[j]=()=>{var Q;return(Q=this.linkService.eventBus)==null||Q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P.id,name:E}}),!1})}v.onclick||(v.onclick=()=>!1),gt(this,O,qt).call(this)}_bindResetFormAction(v,P){const A=v.onclick;if(A||(v.href=this.linkService.getAnchorUrl("")),gt(this,O,qt).call(this),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(v.onclick=()=>!1);return}v.onclick=()=>{var ht;A==null||A();const{fields:E,refs:j,include:Q}=P,K=[];if(E.length!==0||j.length!==0){const st=new Set(j);for(const dt of E){const mt=this._fieldObjects[dt]||[];for(const{id:At}of mt)st.add(At)}for(const dt of Object.values(this._fieldObjects))for(const mt of dt)st.has(mt.id)===Q&&K.push(mt)}else for(const st of Object.values(this._fieldObjects))K.push(...st);const X=this.annotationStorage,rt=[];for(const st of K){const{id:dt}=st;switch(rt.push(dt),st.type){case"text":{const At=st.defaultValue||"";X.setValue(dt,{value:At});break}case"checkbox":case"radiobutton":{const At=st.defaultValue===st.exportValues;X.setValue(dt,{value:At});break}case"combobox":case"listbox":{const At=st.defaultValue||"";X.setValue(dt,{value:At});break}default:continue}const mt=document.querySelector(`[data-element-id="${dt}"]`);if(mt){if(!b.has(mt)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${dt}`);continue}}else continue;mt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:rt,name:"ResetForm"}})),!1}}}O=new WeakSet,qt=function(){this.container.setAttribute("data-internal-link","")},N=new WeakSet,Qe=function(v,P){v.href=this.linkService.getAnchorUrl(""),v.onclick=()=>(this.linkService.executeSetOCGState(P),!1),gt(this,O,qt).call(this)};class c extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v})}render(){this.container.classList.add("textAnnotation");const n=document.createElement("img");return n.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",n.alt="[{{type}} Annotation]",n.dataset.l10nId="text_annotation_type",n.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(n,this.data),this.container.append(n),this.container}}class a extends d{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(n){const{isWin:v,isMac:P}=r.FeatureTest.platform;return v&&n.ctrlKey||P&&n.metaKey}_setEventListener(n,v,P,A){v.includes("mouse")?n.addEventListener(v,E=>{var j;(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:A(E),shift:E.shiftKey,modifier:this._getKeyModifier(E)}})}):n.addEventListener(v,E=>{var j;(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:A(E)}})})}_setEventListeners(n,v,P){var A;for(const[E,j]of v)(j==="Action"||(A=this.data.actions)!=null&&A[j])&&this._setEventListener(n,E,j,P)}_setBackgroundColor(n){const v=this.data.backgroundColor||null;n.style.backgroundColor=v===null?"transparent":r.Util.makeHexColor(v[0],v[1],v[2])}_setTextStyle(n){const v=["left","center","right"],{fontColor:P}=this.data.defaultAppearanceData,A=this.data.defaultAppearanceData.fontSize||C,E=n.style;let j;const Q=2,K=X=>Math.round(10*X)/10;if(this.data.multiLine){const X=Math.abs(this.data.rect[3]-this.data.rect[1]-Q),rt=Math.round(X/(r.LINE_FACTOR*A))||1,ht=X/rt;j=Math.min(A,K(ht/r.LINE_FACTOR))}else{const X=Math.abs(this.data.rect[3]-this.data.rect[1]-Q);j=Math.min(A,K(X/r.LINE_FACTOR))}E.fontSize=`calc(${j}px * var(--scale-factor))`,E.color=r.Util.makeHexColor(P[0],P[1],P[2]),this.data.textAlignment!==null&&(E.textAlign=v[this.data.textAlignment])}_setRequired(n,v){v?n.setAttribute("required",!0):n.removeAttribute("required"),n.setAttribute("aria-required",v)}}class o extends a{constructor(n){const v=n.renderForms||!n.data.hasAppearance&&!!n.data.fieldValue;super(n,{isRenderable:v})}setPropertyOnSiblings(n,v,P,A){const E=this.annotationStorage;for(const j of this._getElementsByName(n.name,n.id))j.domElement&&(j.domElement[v]=P),E.setValue(j.id,{[A]:P})}render(){var A;const n=this.annotationStorage,v=this.data.id;this.container.classList.add("textWidgetAnnotation");let P=null;if(this.renderForms){const E=n.getValue(v,{value:this.data.fieldValue});let j=E.formattedValue||E.value||"";const Q=n.getValue(v,{charLimit:this.data.maxLen}).charLimit;Q&&j.length>Q&&(j=j.slice(0,Q));const K={userValue:j,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(P=document.createElement("textarea"),P.textContent=j,this.data.doNotScroll&&(P.style.overflowY="hidden")):(P=document.createElement("input"),P.type="text",P.setAttribute("value",j),this.data.doNotScroll&&(P.style.overflowX="hidden")),b.add(P),P.setAttribute("data-element-id",v),P.disabled=this.data.readOnly,P.name=this.data.fieldName,P.tabIndex=m,this._setRequired(P,this.data.required),Q&&(P.maxLength=Q),P.addEventListener("input",rt=>{n.setValue(v,{value:rt.target.value}),this.setPropertyOnSiblings(P,"value",rt.target.value,"value")}),P.addEventListener("resetform",rt=>{const ht=this.data.defaultFieldValue??"";P.value=K.userValue=ht,K.formattedValue=null});let X=rt=>{const{formattedValue:ht}=K;ht!=null&&(rt.target.value=ht),rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){P.addEventListener("focus",ht=>{const{target:st}=ht;K.userValue&&(st.value=K.userValue),K.lastCommittedValue=st.value,K.commitKey=1}),P.addEventListener("updatefromsandbox",ht=>{const st={value(dt){K.userValue=dt.detail.value??"",n.setValue(v,{value:K.userValue.toString()}),dt.target.value=K.userValue},formattedValue(dt){const{formattedValue:mt}=dt.detail;K.formattedValue=mt,mt!=null&&dt.target!==document.activeElement&&(dt.target.value=mt),n.setValue(v,{formattedValue:mt})},selRange(dt){dt.target.setSelectionRange(...dt.detail.selRange)},charLimit:dt=>{var wt;const{charLimit:mt}=dt.detail,{target:At}=dt;if(mt===0){At.removeAttribute("maxLength");return}At.setAttribute("maxLength",mt);let yt=K.userValue;!yt||yt.length<=mt||(yt=yt.slice(0,mt),At.value=K.userValue=yt,n.setValue(v,{value:yt}),(wt=this.linkService.eventBus)==null||wt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:yt,willCommit:!0,commitKey:1,selStart:At.selectionStart,selEnd:At.selectionEnd}}))}};this._dispatchEventFromSandbox(st,ht)}),P.addEventListener("keydown",ht=>{var mt;K.commitKey=1;let st=-1;if(ht.key==="Escape"?st=0:ht.key==="Enter"&&!this.data.multiLine?st=2:ht.key==="Tab"&&(K.commitKey=3),st===-1)return;const{value:dt}=ht.target;K.lastCommittedValue!==dt&&(K.lastCommittedValue=dt,K.userValue=dt,(mt=this.linkService.eventBus)==null||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:dt,willCommit:!0,commitKey:st,selStart:ht.target.selectionStart,selEnd:ht.target.selectionEnd}}))});const rt=X;X=null,P.addEventListener("blur",ht=>{var dt;if(!ht.relatedTarget)return;const{value:st}=ht.target;K.userValue=st,K.lastCommittedValue!==st&&((dt=this.linkService.eventBus)==null||dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:st,willCommit:!0,commitKey:K.commitKey,selStart:ht.target.selectionStart,selEnd:ht.target.selectionEnd}})),rt(ht)}),(A=this.data.actions)!=null&&A.Keystroke&&P.addEventListener("beforeinput",ht=>{var nt;K.lastCommittedValue=null;const{data:st,target:dt}=ht,{value:mt,selectionStart:At,selectionEnd:yt}=dt;let wt=At,q=yt;switch(ht.inputType){case"deleteWordBackward":{const tt=mt.substring(0,At).match(/\w*[^\w]*$/);tt&&(wt-=tt[0].length);break}case"deleteWordForward":{const tt=mt.substring(At).match(/^[^\w]*\w*/);tt&&(q+=tt[0].length);break}case"deleteContentBackward":At===yt&&(wt-=1);break;case"deleteContentForward":At===yt&&(q+=1);break}ht.preventDefault(),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:mt,change:st||"",willCommit:!1,selStart:wt,selEnd:q}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ht=>ht.target.value)}if(X&&P.addEventListener("blur",X),this.data.comb){const ht=(this.data.rect[2]-this.data.rect[0])/Q;P.classList.add("comb"),P.style.letterSpacing=`calc(${ht}px * var(--scale-factor) - 1ch)`}}else P=document.createElement("div"),P.textContent=this.data.fieldValue,P.style.verticalAlign="middle",P.style.display="table-cell";return this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class R extends a{constructor(n){super(n,{isRenderable:n.renderForms})}render(){const n=this.annotationStorage,v=this.data,P=v.id;let A=n.getValue(P,{value:v.exportValue===v.fieldValue}).value;typeof A=="string"&&(A=A!=="Off",n.setValue(P,{value:A})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const E=document.createElement("input");return b.add(E),E.setAttribute("data-element-id",P),E.disabled=v.readOnly,this._setRequired(E,this.data.required),E.type="checkbox",E.name=v.fieldName,A&&E.setAttribute("checked",!0),E.setAttribute("exportValue",v.exportValue),E.tabIndex=m,E.addEventListener("change",j=>{const{name:Q,checked:K}=j.target;for(const X of this._getElementsByName(Q,P)){const rt=K&&X.exportValue===v.exportValue;X.domElement&&(X.domElement.checked=rt),n.setValue(X.id,{value:rt})}n.setValue(P,{value:K})}),E.addEventListener("resetform",j=>{const Q=v.defaultFieldValue||"Off";j.target.checked=Q===v.exportValue}),this.enableScripting&&this.hasJSActions&&(E.addEventListener("updatefromsandbox",j=>{const Q={value(K){K.target.checked=K.detail.value!=="Off",n.setValue(P,{value:K.target.checked})}};this._dispatchEventFromSandbox(Q,j)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class L extends a{constructor(n){super(n,{isRenderable:n.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const n=this.annotationStorage,v=this.data,P=v.id;let A=n.getValue(P,{value:v.fieldValue===v.buttonValue}).value;typeof A=="string"&&(A=A!==v.buttonValue,n.setValue(P,{value:A}));const E=document.createElement("input");if(b.add(E),E.setAttribute("data-element-id",P),E.disabled=v.readOnly,this._setRequired(E,this.data.required),E.type="radio",E.name=v.fieldName,A&&E.setAttribute("checked",!0),E.tabIndex=m,E.addEventListener("change",j=>{const{name:Q,checked:K}=j.target;for(const X of this._getElementsByName(Q,P))n.setValue(X.id,{value:!1});n.setValue(P,{value:K})}),E.addEventListener("resetform",j=>{const Q=v.defaultFieldValue;j.target.checked=Q!=null&&Q===v.buttonValue}),this.enableScripting&&this.hasJSActions){const j=v.buttonValue;E.addEventListener("updatefromsandbox",Q=>{const K={value:X=>{const rt=j===X.detail.value;for(const ht of this._getElementsByName(X.target.name)){const st=rt&&ht.id===P;ht.domElement&&(ht.domElement.checked=st),n.setValue(ht.id,{value:st})}}};this._dispatchEventFromSandbox(K,Q)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Q=>Q.target.checked)}return this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class F extends f{constructor(n){super(n,{ignoreBorder:n.data.hasAppearance})}render(){const n=super.render();n.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(n.title=this.data.alternativeText);const v=n.lastChild;return this.enableScripting&&this.hasJSActions&&v&&(this._setDefaultPropertiesFromJS(v),v.addEventListener("updatefromsandbox",P=>{this._dispatchEventFromSandbox({},P)})),n}}class u extends a{constructor(n){super(n,{isRenderable:n.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const n=this.annotationStorage,v=this.data.id,P=n.getValue(v,{value:this.data.fieldValue}),A=document.createElement("select");b.add(A),A.setAttribute("data-element-id",v),A.disabled=this.data.readOnly,this._setRequired(A,this.data.required),A.name=this.data.fieldName,A.tabIndex=m;let E=this.data.combo&&this.data.options.length>0;this.data.combo||(A.size=this.data.options.length,this.data.multiSelect&&(A.multiple=!0)),A.addEventListener("resetform",rt=>{const ht=this.data.defaultFieldValue;for(const st of A.options)st.selected=st.value===ht});for(const rt of this.data.options){const ht=document.createElement("option");ht.textContent=rt.displayValue,ht.value=rt.exportValue,P.value.includes(rt.exportValue)&&(ht.setAttribute("selected",!0),E=!1),A.append(ht)}let j=null;if(E){const rt=document.createElement("option");rt.value=" ",rt.setAttribute("hidden",!0),rt.setAttribute("selected",!0),A.prepend(rt),j=()=>{rt.remove(),A.removeEventListener("input",j),j=null},A.addEventListener("input",j)}const Q=rt=>{const ht=rt?"value":"textContent",{options:st,multiple:dt}=A;return dt?Array.prototype.filter.call(st,mt=>mt.selected).map(mt=>mt[ht]):st.selectedIndex===-1?null:st[st.selectedIndex][ht]};let K=Q(!1);const X=rt=>{const ht=rt.target.options;return Array.prototype.map.call(ht,st=>({displayValue:st.textContent,exportValue:st.value}))};return this.enableScripting&&this.hasJSActions?(A.addEventListener("updatefromsandbox",rt=>{const ht={value(st){j==null||j();const dt=st.detail.value,mt=new Set(Array.isArray(dt)?dt:[dt]);for(const At of A.options)At.selected=mt.has(At.value);n.setValue(v,{value:Q(!0)}),K=Q(!1)},multipleSelection(st){A.multiple=!0},remove(st){const dt=A.options,mt=st.detail.remove;dt[mt].selected=!1,A.remove(mt),dt.length>0&&Array.prototype.findIndex.call(dt,yt=>yt.selected)===-1&&(dt[0].selected=!0),n.setValue(v,{value:Q(!0),items:X(st)}),K=Q(!1)},clear(st){for(;A.length!==0;)A.remove(0);n.setValue(v,{value:null,items:[]}),K=Q(!1)},insert(st){const{index:dt,displayValue:mt,exportValue:At}=st.detail.insert,yt=A.children[dt],wt=document.createElement("option");wt.textContent=mt,wt.value=At,yt?yt.before(wt):A.append(wt),n.setValue(v,{value:Q(!0),items:X(st)}),K=Q(!1)},items(st){const{items:dt}=st.detail;for(;A.length!==0;)A.remove(0);for(const mt of dt){const{displayValue:At,exportValue:yt}=mt,wt=document.createElement("option");wt.textContent=At,wt.value=yt,A.append(wt)}A.options.length>0&&(A.options[0].selected=!0),n.setValue(v,{value:Q(!0),items:X(st)}),K=Q(!1)},indices(st){const dt=new Set(st.detail.indices);for(const mt of st.target.options)mt.selected=dt.has(mt.index);n.setValue(v,{value:Q(!0)}),K=Q(!1)},editable(st){st.target.disabled=!st.detail.editable}};this._dispatchEventFromSandbox(ht,rt)}),A.addEventListener("input",rt=>{var st;const ht=Q(!0);n.setValue(v,{value:ht}),rt.preventDefault(),(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:K,changeEx:ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],rt=>rt.target.value)):A.addEventListener("input",function(rt){n.setValue(v,{value:Q(!0)})}),this.data.combo&&this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}const H=class extends d{constructor(n){var A,E,j;const{data:v}=n,P=!H.IGNORE_TYPES.has(v.parentType)&&!!((A=v.titleObj)!=null&&A.str||(E=v.contentsObj)!=null&&E.str||(j=v.richText)!=null&&j.str);super(n,{isRenderable:P})}render(){this.container.classList.add("popupAnnotation");const n=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(n.length===0)return this.container;const v=new y({container:this.container,trigger:Array.from(n),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),P=this.page,A=r.Util.normalizeRect([this.data.parentRect[0],P.view[3]-this.data.parentRect[1]+P.view[1],this.data.parentRect[2],P.view[3]-this.data.parentRect[3]+P.view[1]]),E=A[0]+this.data.parentRect[2]-this.data.parentRect[0],j=A[1],{pageWidth:Q,pageHeight:K,pageX:X,pageY:rt}=this.viewport.rawDims;return this.container.style.left=`${100*(E-X)/Q}%`,this.container.style.top=`${100*(j-rt)/K}%`,this.container.append(v.render()),this.container}};let w=H;Dt(w,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class y{constructor(n){this.container=n.container,this.trigger=n.trigger,this.color=n.color,this.titleObj=n.titleObj,this.modificationDate=n.modificationDate,this.contentsObj=n.contentsObj,this.richText=n.richText,this.hideWrapper=n.hideWrapper||!1,this.pinned=!1}render(){var Q,K;const v=document.createElement("div");v.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?v:this.container,this.hideElement.hidden=!0;const P=document.createElement("div");P.classList.add("popup");const A=this.color;if(A){const X=.7*(255-A[0])+A[0],rt=.7*(255-A[1])+A[1],ht=.7*(255-A[2])+A[2];P.style.backgroundColor=r.Util.makeHexColor(X|0,rt|0,ht|0)}const E=document.createElement("h1");E.dir=this.titleObj.dir,E.textContent=this.titleObj.str,P.append(E);const j=s.PDFDateString.toDateObject(this.modificationDate);if(j){const X=document.createElement("span");X.classList.add("popupDate"),X.textContent="{{date}}, {{time}}",X.dataset.l10nId="annotation_date_string",X.dataset.l10nArgs=JSON.stringify({date:j.toLocaleDateString(),time:j.toLocaleTimeString()}),P.append(X)}if((Q=this.richText)!=null&&Q.str&&(!((K=this.contentsObj)!=null&&K.str)||this.contentsObj.str===this.richText.str))g.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:P}),P.lastChild.classList.add("richText","popupContent");else{const X=this._formatContents(this.contentsObj);P.append(X)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const X of this.trigger)X.addEventListener("click",this._toggle.bind(this)),X.addEventListener("mouseover",this._show.bind(this,!1)),X.addEventListener("mouseout",this._hide.bind(this,!1));return P.addEventListener("click",this._hide.bind(this,!0)),v.append(P),v}_formatContents({str:n,dir:v}){const P=document.createElement("p");P.classList.add("popupContent"),P.dir=v;const A=n.split(/(?:\r\n?|\n)/);for(let E=0,j=A.length;E<j;++E){const Q=A[E];P.append(document.createTextNode(Q)),E<j-1&&P.append(document.createElement("br"))}return P}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(n=!1){n&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(n=!0){n&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class l extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0}),this.textContent=n.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const n=document.createElement("div");n.classList.add("annotationTextContent"),n.setAttribute("role","comment");for(const v of this.textContent){const P=document.createElement("span");P.textContent=v,n.append(P)}this.container.append(n)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class h extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const n=this.data,{width:v,height:P}=M(n.rect),A=this.svgFactory.create(v,P,!0),E=this.svgFactory.createElement("svg:line");return E.setAttribute("x1",n.rect[2]-n.lineCoordinates[0]),E.setAttribute("y1",n.rect[3]-n.lineCoordinates[1]),E.setAttribute("x2",n.rect[2]-n.lineCoordinates[2]),E.setAttribute("y2",n.rect[3]-n.lineCoordinates[3]),E.setAttribute("stroke-width",n.borderStyle.width||1),E.setAttribute("stroke","transparent"),E.setAttribute("fill","transparent"),A.append(E),this.container.append(A),this._createPopup(E,n),this.container}}class I extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const n=this.data,{width:v,height:P}=M(n.rect),A=this.svgFactory.create(v,P,!0),E=n.borderStyle.width,j=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",E/2),j.setAttribute("y",E/2),j.setAttribute("width",v-E),j.setAttribute("height",P-E),j.setAttribute("stroke-width",E||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),A.append(j),this.container.append(A),this._createPopup(j,n),this.container}}class k extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const n=this.data,{width:v,height:P}=M(n.rect),A=this.svgFactory.create(v,P,!0),E=n.borderStyle.width,j=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",v/2),j.setAttribute("cy",P/2),j.setAttribute("rx",v/2-E/2),j.setAttribute("ry",P/2-E/2),j.setAttribute("stroke-width",E||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),A.append(j),this.container.append(A),this._createPopup(j,n),this.container}}class T extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:v,height:P}=M(n.rect),A=this.svgFactory.create(v,P,!0);let E=[];for(const Q of n.vertices){const K=Q.x-n.rect[0],X=n.rect[3]-Q.y;E.push(K+","+X)}E=E.join(" ");const j=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",E),j.setAttribute("stroke-width",n.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),A.append(j),this.container.append(A),this._createPopup(j,n),this.container}}class U extends T{constructor(n){super(n),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _ extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:v,height:P}=M(n.rect),A=this.svgFactory.create(v,P,!0);for(const E of n.inkLists){let j=[];for(const K of E){const X=K.x-n.rect[0],rt=n.rect[3]-K.y;j.push(`${X},${rt}`)}j=j.join(" ");const Q=this.svgFactory.createElement(this.svgElementName);Q.setAttribute("points",j),Q.setAttribute("stroke-width",n.borderStyle.width||1),Q.setAttribute("stroke","transparent"),Q.setAttribute("fill","transparent"),this._createPopup(Q,n),A.append(Q)}return this.container.append(A),this.container}}class lt extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class J extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class ct extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class et extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class pt extends d{constructor(n){var P,A,E;const v=!!(n.data.hasPopup||(P=n.data.titleObj)!=null&&P.str||(A=n.data.contentsObj)!=null&&A.str||(E=n.data.richText)!=null&&E.str);super(n,{isRenderable:v,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class at extends d{constructor(n){var A;super(n,{isRenderable:!0});const{filename:v,content:P}=this.data.file;this.filename=(0,s.getFilenameFromUrl)(v,!0),this.content=P,(A=this.linkService.eventBus)==null||A.dispatch("fileattachmentannotation",{source:this,filename:v,content:P})}render(){var v,P;this.container.classList.add("fileAttachmentAnnotation");let n;return this.data.hasAppearance?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),n.classList.add("popupTriggerArea"),n.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((v=this.data.titleObj)!=null&&v.str||(P=this.data.contentsObj)!=null&&P.str||this.data.richText)&&this._createPopup(n,this.data),this.container.append(n),this.container}_download(){var n;(n=this.downloadManager)==null||n.openOrDownloadData(this.container,this.content,this.filename)}}const Y=class{static render(n){var K,X;const{annotations:v,div:P,viewport:A,accessibilityManager:E}=n;(0,s.setLayerDimensions)(P,A);const j={data:null,layer:P,page:n.page,viewport:A,linkService:n.linkService,downloadManager:n.downloadManager,imageResourcesPath:n.imageResourcesPath||"",renderForms:n.renderForms!==!1,svgFactory:new s.DOMSVGFactory,annotationStorage:n.annotationStorage||new i.AnnotationStorage,enableScripting:n.enableScripting===!0,hasJSActions:n.hasJSActions,fieldObjects:n.fieldObjects};let Q=0;for(const rt of v){if(rt.noHTML)continue;if(rt.annotationType!==r.AnnotationType.POPUP){const{width:dt,height:mt}=M(rt.rect);if(dt<=0||mt<=0)continue}j.data=rt;const ht=S.create(j);if(!ht.isRenderable)continue;const st=ht.render();if(rt.hidden&&(st.style.visibility="hidden"),Array.isArray(st))for(const dt of st)dt.style.zIndex=Q++,gt(K=Y,Z,xe).call(K,dt,rt.id,P,E);else st.style.zIndex=Q++,ht instanceof w?P.prepend(st):gt(X=Y,Z,xe).call(X,st,rt.id,P,E)}gt(this,ot,Te).call(this,P,n.annotationCanvasMap)}static update(n){const{annotationCanvasMap:v,div:P,viewport:A}=n;(0,s.setLayerDimensions)(P,{rotation:A.rotation}),gt(this,ot,Te).call(this,P,v),P.hidden=!1}};let B=Y;Z=new WeakSet,xe=function(n,v,P,A){const E=n.firstChild||n;E.id=`${s.AnnotationPrefix}${v}`,P.append(n),A==null||A.moveElementInDOM(P,n,E,!1)},ot=new WeakSet,Te=function(n,v){if(v){for(const[P,A]of v){const E=n.querySelector(`[data-annotation-id="${P}"]`);if(!E)continue;const{firstChild:j}=E;j?j.nodeName==="CANVAS"?j.replaceWith(A):j.before(A):E.append(A)}v.clear()}},ft(B,Z),ft(B,ot),t.AnnotationLayer=B},(x,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function e(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}class r{static CMYK_G([i,p,g,m]){return["G",1-Math.min(1,.3*i+.59*g+.11*p+m)]}static G_CMYK([i]){return["CMYK",0,0,0,1-i]}static G_RGB([i]){return["RGB",i,i,i]}static G_HTML([i]){const p=e(i);return`#${p}${p}${p}`}static RGB_G([i,p,g]){return["G",.3*i+.59*p+.11*g]}static RGB_HTML([i,p,g]){const m=e(i),C=e(p),b=e(g);return`#${m}${C}${b}`}static T_HTML(){return"#00000000"}static CMYK_RGB([i,p,g,m]){return["RGB",1-Math.min(1,i+m),1-Math.min(1,g+m),1-Math.min(1,p+m)]}static CMYK_HTML(i){const p=this.CMYK_RGB(i).slice(1);return this.RGB_HTML(p)}static RGB_CMYK([i,p,g]){const m=1-i,C=1-p,b=1-g,M=Math.min(m,C,b);return["CMYK",m,C,b,M]}}t.ColorConverters=r},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var r=e(19);class s{static setupStorage(p,g,m,C,b){const M=C.getValue(g,{value:null});switch(m.name){case"textarea":if(M.value!==null&&(p.textContent=M.value),b==="print")break;p.addEventListener("input",S=>{C.setValue(g,{value:S.target.value})});break;case"input":if(m.attributes.type==="radio"||m.attributes.type==="checkbox"){if(M.value===m.attributes.xfaOn?p.setAttribute("checked",!0):M.value===m.attributes.xfaOff&&p.removeAttribute("checked"),b==="print")break;p.addEventListener("change",S=>{C.setValue(g,{value:S.target.checked?S.target.getAttribute("xfaOn"):S.target.getAttribute("xfaOff")})})}else{if(M.value!==null&&p.setAttribute("value",M.value),b==="print")break;p.addEventListener("input",S=>{C.setValue(g,{value:S.target.value})})}break;case"select":if(M.value!==null)for(const S of m.children)S.attributes.value===M.value&&(S.attributes.selected=!0);p.addEventListener("input",S=>{const d=S.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;C.setValue(g,{value:f})});break}}static setAttributes({html:p,element:g,storage:m=null,intent:C,linkService:b}){const{attributes:M}=g,S=p instanceof HTMLAnchorElement;M.type==="radio"&&(M.name=`${M.name}-${C}`);for(const[d,f]of Object.entries(M))if(f!=null)switch(d){case"class":f.length&&p.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":p.setAttribute("data-element-id",f);break;case"style":Object.assign(p.style,f);break;case"textContent":p.textContent=f;break;default:(!S||d!=="href"&&d!=="newWindow")&&p.setAttribute(d,f)}S&&b.addLinkAttributes(p,M.href,M.newWindow),m&&M.dataId&&this.setupStorage(p,M.dataId,g,m)}static render(p){var c;const g=p.annotationStorage,m=p.linkService,C=p.xfaHtml,b=p.intent||"display",M=document.createElement(C.name);C.attributes&&this.setAttributes({html:M,element:C,intent:b,linkService:m});const S=[[C,-1,M]],d=p.div;if(d.append(M),p.viewport){const a=`matrix(${p.viewport.transform.join(",")})`;d.style.transform=a}b!=="richText"&&d.setAttribute("class","xfaLayer xfaFont");const f=[];for(;S.length>0;){const[a,o,R]=S.at(-1);if(o+1===a.children.length){S.pop();continue}const L=a.children[++S.at(-1)[1]];if(L===null)continue;const{name:F}=L;if(F==="#text"){const w=document.createTextNode(L.value);f.push(w),R.append(w);continue}let u;if((c=L==null?void 0:L.attributes)!=null&&c.xmlns?u=document.createElementNS(L.attributes.xmlns,F):u=document.createElement(F),R.append(u),L.attributes&&this.setAttributes({html:u,element:L,storage:g,intent:b,linkService:m}),L.children&&L.children.length>0)S.push([L,-1,u]);else if(L.value){const w=document.createTextNode(L.value);r.XfaText.shouldBuildText(F)&&f.push(w),u.append(w)}}for(const a of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))a.setAttribute("readOnly",!0);return{textDivs:f}}static update(p){const g=`matrix(${p.viewport.transform.join(",")})`;p.div.style.transform=g,p.div.hidden=!1}}t.XfaLayer=s},(x,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var r=e(6),s=e(1),i=e(10);let p=class{constructor(){(0,s.unreachable)("Not implemented: SVGGraphics")}};t.SVGGraphics=p;{let c=function(u){let w=[];const y=[];for(const l of u){if(l.fn==="save"){w.push({fnId:92,fn:"group",items:[]}),y.push(w),w=w.at(-1).items;continue}l.fn==="restore"?w=y.pop():w.push(l)}return w},a=function(u){if(Number.isInteger(u))return u.toString();const w=u.toFixed(10);let y=w.length-1;if(w[y]!=="0")return w;do y--;while(w[y]==="0");return w.substring(0,w[y]==="."?y:y+1)},o=function(u){if(u[4]===0&&u[5]===0){if(u[1]===0&&u[2]===0)return u[0]===1&&u[3]===1?"":`scale(${a(u[0])} ${a(u[3])})`;if(u[0]===u[3]&&u[1]===-u[2]){const w=Math.acos(u[0])*180/Math.PI;return`rotate(${a(w)})`}}else if(u[0]===1&&u[1]===0&&u[2]===0&&u[3]===1)return`translate(${a(u[4])} ${a(u[5])})`;return`matrix(${a(u[0])} ${a(u[1])} ${a(u[2])} ${a(u[3])} ${a(u[4])} ${a(u[5])})`};const g={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},m="http://www.w3.org/XML/1998/namespace",C="http://www.w3.org/1999/xlink",b=["butt","round","square"],M=["miter","round","bevel"],S=function(u,w="",y=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!y)return URL.createObjectURL(new Blob([u],{type:w}));const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let h=`data:${w};base64,`;for(let I=0,k=u.length;I<k;I+=3){const T=u[I]&255,U=u[I+1]&255,_=u[I+2]&255,V=T>>2,lt=(T&3)<<4|U>>4,J=I+1<k?(U&15)<<2|_>>6:64,ct=I+2<k?_&63:64;h+=l[V]+l[lt]+l[J]+l[ct]}return h},d=function(){const u=new Uint8Array([137,80,78,71,13,10,26,10]),w=12,y=new Int32Array(256);for(let _=0;_<256;_++){let V=_;for(let lt=0;lt<8;lt++)V&1?V=3988292384^V>>1&2147483647:V=V>>1&2147483647;y[_]=V}function l(_,V,lt){let J=-1;for(let ct=V;ct<lt;ct++){const et=(J^_[ct])&255,pt=y[et];J=J>>>8^pt}return J^-1}function h(_,V,lt,J){let ct=J;const et=V.length;lt[ct]=et>>24&255,lt[ct+1]=et>>16&255,lt[ct+2]=et>>8&255,lt[ct+3]=et&255,ct+=4,lt[ct]=_.charCodeAt(0)&255,lt[ct+1]=_.charCodeAt(1)&255,lt[ct+2]=_.charCodeAt(2)&255,lt[ct+3]=_.charCodeAt(3)&255,ct+=4,lt.set(V,ct),ct+=V.length;const pt=l(lt,J+4,ct);lt[ct]=pt>>24&255,lt[ct+1]=pt>>16&255,lt[ct+2]=pt>>8&255,lt[ct+3]=pt&255}function I(_,V,lt){let J=1,ct=0;for(let et=V;et<lt;++et)J=(J+(_[et]&255))%65521,ct=(ct+J)%65521;return ct<<16|J}function k(_){if(!i.isNodeJS)return T(_);try{let V;parseInt(process.versions.node)>=8?V=_:V=Buffer.from(_);const lt=require$$5.deflateSync(V,{level:9});return lt instanceof Uint8Array?lt:new Uint8Array(lt)}catch(V){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+V)}return T(_)}function T(_){let V=_.length;const lt=65535,J=Math.ceil(V/lt),ct=new Uint8Array(2+V+J*5+4);let et=0;ct[et++]=120,ct[et++]=156;let pt=0;for(;V>lt;)ct[et++]=0,ct[et++]=255,ct[et++]=255,ct[et++]=0,ct[et++]=0,ct.set(_.subarray(pt,pt+lt),et),et+=lt,pt+=lt,V-=lt;ct[et++]=1,ct[et++]=V&255,ct[et++]=V>>8&255,ct[et++]=~V&65535&255,ct[et++]=(~V&65535)>>8&255,ct.set(_.subarray(pt),et),et+=_.length-pt;const at=I(_,0,_.length);return ct[et++]=at>>24&255,ct[et++]=at>>16&255,ct[et++]=at>>8&255,ct[et++]=at&255,ct}function U(_,V,lt,J){const ct=_.width,et=_.height;let pt,at,B;const O=_.data;switch(V){case s.ImageKind.GRAYSCALE_1BPP:at=0,pt=1,B=ct+7>>3;break;case s.ImageKind.RGB_24BPP:at=2,pt=8,B=ct*3;break;case s.ImageKind.RGBA_32BPP:at=6,pt=8,B=ct*4;break;default:throw new Error("invalid format")}const D=new Uint8Array((1+B)*et);let N=0,G=0;for(let Y=0;Y<et;++Y)D[N++]=0,D.set(O.subarray(G,G+B),N),G+=B,N+=B;if(V===s.ImageKind.GRAYSCALE_1BPP&&J){N=0;for(let Y=0;Y<et;Y++){N++;for(let W=0;W<B;W++)D[N++]^=255}}const H=new Uint8Array([ct>>24&255,ct>>16&255,ct>>8&255,ct&255,et>>24&255,et>>16&255,et>>8&255,et&255,pt,at,0,0,0]),Z=k(D),$=u.length+w*3+H.length+Z.length,ot=new Uint8Array($);let it=0;return ot.set(u,it),it+=u.length,h("IHDR",H,ot,it),it+=w+H.length,h("IDATA",Z,ot,it),it+=w+Z.length,h("IEND",new Uint8Array(0),ot,it),S(ot,"image/png",lt)}return function(V,lt,J){const ct=V.kind===void 0?s.ImageKind.GRAYSCALE_1BPP:V.kind;return U(V,ct,lt,J)}}();class f{constructor(){this.fontSizeScale=1,this.fontWeight=g.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=g.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(w,y){this.x=w,this.y=y}}let R=0,L=0,F=0;t.SVGGraphics=p=class{constructor(u,w,y=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new f,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=u,this.objs=w,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!y,this._operatorIdMapping=[];for(const l in s.OPS)this._operatorIdMapping[s.OPS[l]]=l}getObject(u,w=null){return typeof u=="string"?u.startsWith("g_")?this.commonObjs.get(u):this.objs.get(u):w}save(){this.transformStack.push(this.transformMatrix);const u=this.current;this.extraStack.push(u),this.current=u.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(u){this.save(),this.executeOpTree(u),this.restore()}loadDependencies(u){const w=u.fnArray,y=u.argsArray;for(let l=0,h=w.length;l<h;l++)if(w[l]===s.OPS.dependency)for(const I of y[l]){const k=I.startsWith("g_")?this.commonObjs:this.objs,T=new Promise(U=>{k.get(I,U)});this.current.dependencies.push(T)}return Promise.all(this.current.dependencies)}transform(u,w,y,l,h,I){const k=[u,w,y,l,h,I];this.transformMatrix=s.Util.transform(this.transformMatrix,k),this.tgrp=null}getSVG(u,w){this.viewport=w;const y=this._initialize(w);return this.loadDependencies(u).then(()=>(this.transformMatrix=s.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(u)),y))}convertOpList(u){const w=this._operatorIdMapping,y=u.argsArray,l=u.fnArray,h=[];for(let I=0,k=l.length;I<k;I++){const T=l[I];h.push({fnId:T,fn:w[T],args:y[I]})}return c(h)}executeOpTree(u){for(const w of u){const y=w.fn,l=w.fnId,h=w.args;switch(l|0){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(h);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(h[0],h[1]);break;case s.OPS.setFont:this.setFont(h);break;case s.OPS.showText:this.showText(h[0]);break;case s.OPS.showSpacedText:this.showText(h[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(h[0],h[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(h[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(h[0]);break;case s.OPS.setHScale:this.setHScale(h[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(h[0],h[1],h[2],h[3],h[4],h[5]);break;case s.OPS.setTextRise:this.setTextRise(h[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(h[0]);break;case s.OPS.setLineWidth:this.setLineWidth(h[0]);break;case s.OPS.setLineJoin:this.setLineJoin(h[0]);break;case s.OPS.setLineCap:this.setLineCap(h[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(h[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(h[0],h[1],h[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(h[0],h[1],h[2]);break;case s.OPS.setStrokeColorN:this.setStrokeColorN(h);break;case s.OPS.setFillColorN:this.setFillColorN(h);break;case s.OPS.shadingFill:this.shadingFill(h[0]);break;case s.OPS.setDash:this.setDash(h[0],h[1]);break;case s.OPS.setRenderingIntent:this.setRenderingIntent(h[0]);break;case s.OPS.setFlatness:this.setFlatness(h[0]);break;case s.OPS.setGState:this.setGState(h[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintImageXObject:this.paintImageXObject(h[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(h[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(h[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(h[0],h[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(h[0],h[1],h[2],h[3],h[4],h[5]);break;case s.OPS.constructPath:this.constructPath(h[0],h[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(w.items);break;default:(0,s.warn)(`Unimplemented operator ${y}`);break}}}setWordSpacing(u){this.current.wordSpacing=u}setCharSpacing(u){this.current.charSpacing=u}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(u,w,y,l,h,I){const k=this.current;k.textMatrix=k.lineMatrix=[u,w,y,l,h,I],k.textMatrixScale=Math.hypot(u,w),k.x=k.lineX=0,k.y=k.lineY=0,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${a(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",a(-k.y)),k.txtElement=this.svgFactory.createElement("svg:text"),k.txtElement.append(k.tspan)}beginText(){const u=this.current;u.x=u.lineX=0,u.y=u.lineY=0,u.textMatrix=s.IDENTITY_MATRIX,u.lineMatrix=s.IDENTITY_MATRIX,u.textMatrixScale=1,u.tspan=this.svgFactory.createElement("svg:tspan"),u.txtElement=this.svgFactory.createElement("svg:text"),u.txtgrp=this.svgFactory.createElement("svg:g"),u.xcoords=[],u.ycoords=[]}moveText(u,w){const y=this.current;y.x=y.lineX+=u,y.y=y.lineY+=w,y.xcoords=[],y.ycoords=[],y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${a(y.fontSize)}px`),y.tspan.setAttributeNS(null,"y",a(-y.y))}showText(u){const w=this.current,y=w.font,l=w.fontSize;if(l===0)return;const h=w.fontSizeScale,I=w.charSpacing,k=w.wordSpacing,T=w.fontDirection,U=w.textHScale*T,_=y.vertical,V=_?1:-1,lt=y.defaultVMetrics,J=l*w.fontMatrix[0];let ct=0;for(const at of u){if(at===null){ct+=T*k;continue}else if(typeof at=="number"){ct+=V*at*l/1e3;continue}const B=(at.isSpace?k:0)+I,O=at.fontChar;let D,N,G=at.width;if(_){let Z;const $=at.vmetric||lt;Z=at.vmetric?$[1]:G*.5,Z=-Z*J;const ot=$[2]*J;G=$?-$[0]:G,D=Z/h,N=(ct+ot)/h}else D=ct/h,N=0;(at.isInFont||y.missingFile)&&(w.xcoords.push(w.x+D),_&&w.ycoords.push(-w.y+N),w.tspan.textContent+=O);let H;_?H=G*J-B*T:H=G*J+B*T,ct+=H}w.tspan.setAttributeNS(null,"x",w.xcoords.map(a).join(" ")),_?w.tspan.setAttributeNS(null,"y",w.ycoords.map(a).join(" ")):w.tspan.setAttributeNS(null,"y",a(-w.y)),_?w.y-=ct:w.x+=ct*U,w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${a(w.fontSize)}px`),w.fontStyle!==g.fontStyle&&w.tspan.setAttributeNS(null,"font-style",w.fontStyle),w.fontWeight!==g.fontWeight&&w.tspan.setAttributeNS(null,"font-weight",w.fontWeight);const et=w.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;if(et===s.TextRenderingMode.FILL||et===s.TextRenderingMode.FILL_STROKE?(w.fillColor!==g.fillColor&&w.tspan.setAttributeNS(null,"fill",w.fillColor),w.fillAlpha<1&&w.tspan.setAttributeNS(null,"fill-opacity",w.fillAlpha)):w.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?w.tspan.setAttributeNS(null,"fill","transparent"):w.tspan.setAttributeNS(null,"fill","none"),et===s.TextRenderingMode.STROKE||et===s.TextRenderingMode.FILL_STROKE){const at=1/(w.textMatrixScale||1);this._setStrokeAttributes(w.tspan,at)}let pt=w.textMatrix;w.textRise!==0&&(pt=pt.slice(),pt[5]+=w.textRise),w.txtElement.setAttributeNS(null,"transform",`${o(pt)} scale(${a(U)}, -1)`),w.txtElement.setAttributeNS(m,"xml:space","preserve"),w.txtElement.append(w.tspan),w.txtgrp.append(w.txtElement),this._ensureTransformGroup().append(w.txtElement)}setLeadingMoveText(u,w){this.setLeading(-w),this.moveText(u,w)}addFontStyle(u){if(!u.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const w=S(u.data,u.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${u.loadedName}"; src: url(${w}); }
`}setFont(u){const w=this.current,y=this.commonObjs.get(u[0]);let l=u[1];w.font=y,this.embedFonts&&!y.missingFile&&!this.embeddedFonts[y.loadedName]&&(this.addFontStyle(y),this.embeddedFonts[y.loadedName]=y),w.fontMatrix=y.fontMatrix||s.FONT_IDENTITY_MATRIX;let h="normal";y.black?h="900":y.bold&&(h="bold");const I=y.italic?"italic":"normal";l<0?(l=-l,w.fontDirection=-1):w.fontDirection=1,w.fontSize=l,w.fontFamily=y.loadedName,w.fontWeight=h,w.fontStyle=I,w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"y",a(-w.y)),w.xcoords=[],w.ycoords=[]}endText(){var w;const u=this.current;u.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&((w=u.txtElement)!=null&&w.hasChildNodes())&&(u.element=u.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(u){u>0&&(this.current.lineWidth=u)}setLineCap(u){this.current.lineCap=b[u]}setLineJoin(u){this.current.lineJoin=M[u]}setMiterLimit(u){this.current.miterLimit=u}setStrokeAlpha(u){this.current.strokeAlpha=u}setStrokeRGBColor(u,w,y){this.current.strokeColor=s.Util.makeHexColor(u,w,y)}setFillAlpha(u){this.current.fillAlpha=u}setFillRGBColor(u,w,y){this.current.fillColor=s.Util.makeHexColor(u,w,y),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(u){this.current.strokeColor=this._makeColorN_Pattern(u)}setFillColorN(u){this.current.fillColor=this._makeColorN_Pattern(u)}shadingFill(u){const w=this.viewport.width,y=this.viewport.height,l=s.Util.inverseTransform(this.transformMatrix),h=s.Util.applyTransform([0,0],l),I=s.Util.applyTransform([0,y],l),k=s.Util.applyTransform([w,0],l),T=s.Util.applyTransform([w,y],l),U=Math.min(h[0],I[0],k[0],T[0]),_=Math.min(h[1],I[1],k[1],T[1]),V=Math.max(h[0],I[0],k[0],T[0]),lt=Math.max(h[1],I[1],k[1],T[1]),J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x",U),J.setAttributeNS(null,"y",_),J.setAttributeNS(null,"width",V-U),J.setAttributeNS(null,"height",lt-_),J.setAttributeNS(null,"fill",this._makeShadingPattern(u)),this.current.fillAlpha<1&&J.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(J)}_makeColorN_Pattern(u){return u[0]==="TilingPattern"?this._makeTilingPattern(u):this._makeShadingPattern(u)}_makeTilingPattern(u){const w=u[1],y=u[2],l=u[3]||s.IDENTITY_MATRIX,[h,I,k,T]=u[4],U=u[5],_=u[6],V=u[7],lt=`shading${F++}`,[J,ct,et,pt]=s.Util.normalizeRect([...s.Util.applyTransform([h,I],l),...s.Util.applyTransform([k,T],l)]),[at,B]=s.Util.singularValueDecompose2dScale(l),O=U*at,D=_*B,N=this.svgFactory.createElement("svg:pattern");N.setAttributeNS(null,"id",lt),N.setAttributeNS(null,"patternUnits","userSpaceOnUse"),N.setAttributeNS(null,"width",O),N.setAttributeNS(null,"height",D),N.setAttributeNS(null,"x",`${J}`),N.setAttributeNS(null,"y",`${ct}`);const G=this.svg,H=this.transformMatrix,Z=this.current.fillColor,$=this.current.strokeColor,ot=this.svgFactory.create(et-J,pt-ct);if(this.svg=ot,this.transformMatrix=l,V===2){const it=s.Util.makeHexColor(...w);this.current.fillColor=it,this.current.strokeColor=it}return this.executeOpTree(this.convertOpList(y)),this.svg=G,this.transformMatrix=H,this.current.fillColor=Z,this.current.strokeColor=$,N.append(ot.childNodes[0]),this.defs.append(N),`url(#${lt})`}_makeShadingPattern(u){switch(typeof u=="string"&&(u=this.objs.get(u)),u[0]){case"RadialAxial":const w=`shading${F++}`,y=u[3];let l;switch(u[1]){case"axial":const h=u[4],I=u[5];l=this.svgFactory.createElement("svg:linearGradient"),l.setAttributeNS(null,"id",w),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",h[0]),l.setAttributeNS(null,"y1",h[1]),l.setAttributeNS(null,"x2",I[0]),l.setAttributeNS(null,"y2",I[1]);break;case"radial":const k=u[4],T=u[5],U=u[6],_=u[7];l=this.svgFactory.createElement("svg:radialGradient"),l.setAttributeNS(null,"id",w),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",T[0]),l.setAttributeNS(null,"cy",T[1]),l.setAttributeNS(null,"r",_),l.setAttributeNS(null,"fx",k[0]),l.setAttributeNS(null,"fy",k[1]),l.setAttributeNS(null,"fr",U);break;default:throw new Error(`Unknown RadialAxial type: ${u[1]}`)}for(const h of y){const I=this.svgFactory.createElement("svg:stop");I.setAttributeNS(null,"offset",h[0]),I.setAttributeNS(null,"stop-color",h[1]),l.append(I)}return this.defs.append(l),`url(#${w})`;case"Mesh":return(0,s.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${u[0]}`)}}setDash(u,w){this.current.dashArray=u,this.current.dashPhase=w}constructPath(u,w){const y=this.current;let l=y.x,h=y.y,I=[],k=0;for(const T of u)switch(T|0){case s.OPS.rectangle:l=w[k++],h=w[k++];const U=w[k++],_=w[k++],V=l+U,lt=h+_;I.push("M",a(l),a(h),"L",a(V),a(h),"L",a(V),a(lt),"L",a(l),a(lt),"Z");break;case s.OPS.moveTo:l=w[k++],h=w[k++],I.push("M",a(l),a(h));break;case s.OPS.lineTo:l=w[k++],h=w[k++],I.push("L",a(l),a(h));break;case s.OPS.curveTo:l=w[k+4],h=w[k+5],I.push("C",a(w[k]),a(w[k+1]),a(w[k+2]),a(w[k+3]),a(l),a(h)),k+=6;break;case s.OPS.curveTo2:I.push("C",a(l),a(h),a(w[k]),a(w[k+1]),a(w[k+2]),a(w[k+3])),l=w[k+2],h=w[k+3],k+=4;break;case s.OPS.curveTo3:l=w[k+2],h=w[k+3],I.push("C",a(w[k]),a(w[k+1]),a(l),a(h),a(l),a(h)),k+=4;break;case s.OPS.closePath:I.push("Z");break}I=I.join(" "),y.path&&u.length>0&&u[0]!==s.OPS.rectangle&&u[0]!==s.OPS.moveTo?I=y.path.getAttributeNS(null,"d")+I:(y.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(y.path)),y.path.setAttributeNS(null,"d",I),y.path.setAttributeNS(null,"fill","none"),y.element=y.path,y.setCurrentPoint(l,h)}endPath(){const u=this.current;if(u.path=null,!this.pendingClip)return;if(!u.element){this.pendingClip=null;return}const w=`clippath${R++}`,y=this.svgFactory.createElement("svg:clipPath");y.setAttributeNS(null,"id",w),y.setAttributeNS(null,"transform",o(this.transformMatrix));const l=u.element.cloneNode(!0);if(this.pendingClip==="evenodd"?l.setAttributeNS(null,"clip-rule","evenodd"):l.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,y.append(l),this.defs.append(y),u.activeClipUrl){u.clipGroup=null;for(const h of this.extraStack)h.clipGroup=null;y.setAttributeNS(null,"clip-path",u.activeClipUrl)}u.activeClipUrl=`url(#${w})`,this.tgrp=null}clip(u){this.pendingClip=u}closePath(){const u=this.current;if(u.path){const w=`${u.path.getAttributeNS(null,"d")}Z`;u.path.setAttributeNS(null,"d",w)}}setLeading(u){this.current.leading=-u}setTextRise(u){this.current.textRise=u}setTextRenderingMode(u){this.current.textRenderingMode=u}setHScale(u){this.current.textHScale=u/100}setRenderingIntent(u){}setFlatness(u){}setGState(u){for(const[w,y]of u)switch(w){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y);break;case"CA":this.setStrokeAlpha(y);break;case"ca":this.setFillAlpha(y);break;default:(0,s.warn)(`Unimplemented graphic state operator ${w}`);break}}fill(){const u=this.current;u.element&&(u.element.setAttributeNS(null,"fill",u.fillColor),u.element.setAttributeNS(null,"fill-opacity",u.fillAlpha),this.endPath())}stroke(){const u=this.current;u.element&&(this._setStrokeAttributes(u.element),u.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(u,w=1){const y=this.current;let l=y.dashArray;w!==1&&l.length>0&&(l=l.map(function(h){return w*h})),u.setAttributeNS(null,"stroke",y.strokeColor),u.setAttributeNS(null,"stroke-opacity",y.strokeAlpha),u.setAttributeNS(null,"stroke-miterlimit",a(y.miterLimit)),u.setAttributeNS(null,"stroke-linecap",y.lineCap),u.setAttributeNS(null,"stroke-linejoin",y.lineJoin),u.setAttributeNS(null,"stroke-width",a(w*y.lineWidth)+"px"),u.setAttributeNS(null,"stroke-dasharray",l.map(a).join(" ")),u.setAttributeNS(null,"stroke-dashoffset",a(w*y.dashPhase)+"px")}eoFill(){var u;(u=this.current.element)==null||u.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var u;(u=this.current.element)==null||u.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const u=this.svgFactory.createElement("svg:rect");u.setAttributeNS(null,"x","0"),u.setAttributeNS(null,"y","0"),u.setAttributeNS(null,"width","1px"),u.setAttributeNS(null,"height","1px"),u.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(u)}paintImageXObject(u){const w=this.getObject(u);if(!w){(0,s.warn)(`Dependent image with object ID ${u} is not ready yet`);return}this.paintInlineImageXObject(w)}paintInlineImageXObject(u,w){const y=u.width,l=u.height,h=d(u,this.forceDataSchema,!!w),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",a(y)),I.setAttributeNS(null,"height",a(l)),this.current.element=I,this.clip("nonzero");const k=this.svgFactory.createElement("svg:image");k.setAttributeNS(C,"xlink:href",h),k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y",a(-l)),k.setAttributeNS(null,"width",a(y)+"px"),k.setAttributeNS(null,"height",a(l)+"px"),k.setAttributeNS(null,"transform",`scale(${a(1/y)} ${a(-1/l)})`),w?w.append(k):this._ensureTransformGroup().append(k)}paintImageMaskXObject(u){const w=this.getObject(u.data,u);if(w.bitmap){(0,s.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const y=this.current,l=w.width,h=w.height,I=y.fillColor;y.maskId=`mask${L++}`;const k=this.svgFactory.createElement("svg:mask");k.setAttributeNS(null,"id",y.maskId);const T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",a(l)),T.setAttributeNS(null,"height",a(h)),T.setAttributeNS(null,"fill",I),T.setAttributeNS(null,"mask",`url(#${y.maskId})`),this.defs.append(k),this._ensureTransformGroup().append(T),this.paintInlineImageXObject(w,k)}paintFormXObjectBegin(u,w){if(Array.isArray(u)&&u.length===6&&this.transform(u[0],u[1],u[2],u[3],u[4],u[5]),w){const y=w[2]-w[0],l=w[3]-w[1],h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x",w[0]),h.setAttributeNS(null,"y",w[1]),h.setAttributeNS(null,"width",a(y)),h.setAttributeNS(null,"height",a(l)),this.current.element=h,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(u){const w=this.svgFactory.create(u.width,u.height),y=this.svgFactory.createElement("svg:defs");w.append(y),this.defs=y;const l=this.svgFactory.createElement("svg:g");return l.setAttributeNS(null,"transform",o(u.transform)),w.append(l),this.svg=l,w}_ensureClipGroup(){if(!this.current.clipGroup){const u=this.svgFactory.createElement("svg:g");u.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(u),this.current.clipGroup=u}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",o(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(x){var t=__webpack_module_cache__[x];if(t!==void 0)return t.exports;var e=__webpack_module_cache__[x]={exports:{}};return __webpack_modules__[x](e,e.exports,__w_pdfjs_require__),e.exports}var __webpack_exports__={};return(()=>{var x=__webpack_exports__;Object.defineProperty(x,"__esModule",{value:!0}),Object.defineProperty(x,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(x,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(x,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(x,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(x,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return p.AnnotationEditorUIManager}}),Object.defineProperty(x,"AnnotationLayer",{enumerable:!0,get:function(){return g.AnnotationLayer}}),Object.defineProperty(x,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(x,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(x,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(x,"GlobalWorkerOptions",{enumerable:!0,get:function(){return m.GlobalWorkerOptions}}),Object.defineProperty(x,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(x,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(x,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(x,"PDFDataRangeTransport",{enumerable:!0,get:function(){return e.PDFDataRangeTransport}}),Object.defineProperty(x,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(x,"PDFWorker",{enumerable:!0,get:function(){return e.PDFWorker}}),Object.defineProperty(x,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(x,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(x,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(x,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(x,"SVGGraphics",{enumerable:!0,get:function(){return C.SVGGraphics}}),Object.defineProperty(x,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(x,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(x,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(x,"XfaLayer",{enumerable:!0,get:function(){return b.XfaLayer}}),Object.defineProperty(x,"build",{enumerable:!0,get:function(){return e.build}}),Object.defineProperty(x,"createPromiseCapability",{enumerable:!0,get:function(){return t.createPromiseCapability}}),Object.defineProperty(x,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(x,"getDocument",{enumerable:!0,get:function(){return e.getDocument}}),Object.defineProperty(x,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(x,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(x,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(x,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(x,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(x,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(x,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty(x,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(x,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(x,"updateTextLayer",{enumerable:!0,get:function(){return s.updateTextLayer}}),Object.defineProperty(x,"version",{enumerable:!0,get:function(){return e.version}});var t=__w_pdfjs_require__(1),e=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),s=__w_pdfjs_require__(26),i=__w_pdfjs_require__(27),p=__w_pdfjs_require__(5),g=__w_pdfjs_require__(32),m=__w_pdfjs_require__(14),C=__w_pdfjs_require__(35),b=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const PdfViewer_svelte_svelte_type_style_lang="";function create_fragment$4(x){let t,e;return{c(){t=element("div"),e=element("div"),this.h()},l(r){t=claim_element(r,"DIV",{class:!0});var s=children(t);e=claim_element(s,"DIV",{class:!0,style:!0}),children(e).forEach(detach),s.forEach(detach),this.h()},h(){attr(e,"class","pdf-wrapper svelte-r9i6p1"),set_style(e,"--scale-factor","1.2"),attr(t,"class","pdf-container svelte-r9i6p1")},m(r,s){insert_hydration(r,t,s),append_hydration(t,e),x[2](e)},p:noop,i:noop,o:noop,d(r){r&&detach(t),x[2](null)}}}function instance$4(x,t,e){pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.5.141/pdf.worker.min.js";let{url:r=""}=t,s;async function i(m){const C=m.getViewport({scale:1.2}),b=document.createElement("div");b.style.marginBottom="16px",b.style.position="relative",b.id=`page-${m._pageIndex+1}`;const M=document.createElement("canvas"),S=M.getContext("2d");if(!S)return;M.height=C.height,M.width=C.width,b.appendChild(M),s.appendChild(b),m.render({canvasContext:S,viewport:C});const d=document.createElement("div");d.className="textLayer";const f=await m.getTextContent();pdfExports.renderTextLayer({textContentSource:f,viewport:m.getViewport(),container:d}),b.appendChild(d)}let p=!1;onMount(async()=>{const m=await pdfExports.getDocument(r).promise;if(!p)for(let C=1;C<=m.numPages;C++)m.getPage(C).then(i)}),onDestroy(()=>{p=!0});function g(m){binding_callbacks[m?"unshift":"push"](()=>{s=m,e(0,s)})}return x.$$set=m=>{"url"in m&&e(1,r=m.url)},[s,r,g]}class PdfViewer extends SvelteComponent{constructor(t){super(),init(this,t,instance$4,create_fragment$4,safe_not_equal,{url:1})}}var jszip_min={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(x,t){(function(e){x.exports=e()})(function(){return function e(r,s,i){function p(C,b){if(!s[C]){if(!r[C]){var M=typeof commonjsRequire=="function"&&commonjsRequire;if(!b&&M)return M(C,!0);if(g)return g(C,!0);var S=new Error("Cannot find module '"+C+"'");throw S.code="MODULE_NOT_FOUND",S}var d=s[C]={exports:{}};r[C][0].call(d.exports,function(f){var c=r[C][1][f];return p(c||f)},d,d.exports,e,r,s,i)}return s[C].exports}for(var g=typeof commonjsRequire=="function"&&commonjsRequire,m=0;m<i.length;m++)p(i[m]);return p}({1:[function(e,r,s){var i=e("./utils"),p=e("./support"),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(m){for(var C,b,M,S,d,f,c,a=[],o=0,R=m.length,L=R,F=i.getTypeOf(m)!=="string";o<m.length;)L=R-o,M=F?(C=m[o++],b=o<R?m[o++]:0,o<R?m[o++]:0):(C=m.charCodeAt(o++),b=o<R?m.charCodeAt(o++):0,o<R?m.charCodeAt(o++):0),S=C>>2,d=(3&C)<<4|b>>4,f=1<L?(15&b)<<2|M>>6:64,c=2<L?63&M:64,a.push(g.charAt(S)+g.charAt(d)+g.charAt(f)+g.charAt(c));return a.join("")},s.decode=function(m){var C,b,M,S,d,f,c=0,a=0,o="data:";if(m.substr(0,o.length)===o)throw new Error("Invalid base64 input, it looks like a data url.");var R,L=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===g.charAt(64)&&L--,m.charAt(m.length-2)===g.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=p.uint8array?new Uint8Array(0|L):new Array(0|L);c<m.length;)C=g.indexOf(m.charAt(c++))<<2|(S=g.indexOf(m.charAt(c++)))>>4,b=(15&S)<<4|(d=g.indexOf(m.charAt(c++)))>>2,M=(3&d)<<6|(f=g.indexOf(m.charAt(c++))),R[a++]=C,d!==64&&(R[a++]=b),f!==64&&(R[a++]=M);return R}},{"./support":30,"./utils":32}],2:[function(e,r,s){var i=e("./external"),p=e("./stream/DataWorker"),g=e("./stream/Crc32Probe"),m=e("./stream/DataLengthProbe");function C(b,M,S,d,f){this.compressedSize=b,this.uncompressedSize=M,this.crc32=S,this.compression=d,this.compressedContent=f}C.prototype={getContentWorker:function(){var b=new p(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),M=this;return b.on("end",function(){if(this.streamInfo.data_length!==M.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new p(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(b,M,S){return b.pipe(new g).pipe(new m("uncompressedSize")).pipe(M.compressWorker(S)).pipe(new m("compressedSize")).withStreamInfo("compression",M)},r.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,s){var i=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,s){var i=e("./utils"),p=function(){for(var g,m=[],C=0;C<256;C++){g=C;for(var b=0;b<8;b++)g=1&g?3988292384^g>>>1:g>>>1;m[C]=g}return m}();r.exports=function(g,m){return g!==void 0&&g.length?i.getTypeOf(g)!=="string"?function(C,b,M,S){var d=p,f=S+M;C^=-1;for(var c=S;c<f;c++)C=C>>>8^d[255&(C^b[c])];return-1^C}(0|m,g,g.length,0):function(C,b,M,S){var d=p,f=S+M;C^=-1;for(var c=S;c<f;c++)C=C>>>8^d[255&(C^b.charCodeAt(c))];return-1^C}(0|m,g,g.length,0):0}},{"./utils":32}],5:[function(e,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,r,s){var i=null;i=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:i}},{lie:37}],7:[function(e,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",p=e("pako"),g=e("./utils"),m=e("./stream/GenericWorker"),C=i?"uint8array":"array";function b(M,S){m.call(this,"FlateWorker/"+M),this._pako=null,this._pakoAction=M,this._pakoOptions=S,this.meta={}}s.magic="\b\0",g.inherits(b,m),b.prototype.processChunk=function(M){this.meta=M.meta,this._pako===null&&this._createPako(),this._pako.push(g.transformTo(C,M.data),!1)},b.prototype.flush=function(){m.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new p[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var M=this;this._pako.onData=function(S){M.push({data:S,meta:M.meta})}},s.compressWorker=function(M){return new b("Deflate",M)},s.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,s){function i(d,f){var c,a="";for(c=0;c<f;c++)a+=String.fromCharCode(255&d),d>>>=8;return a}function p(d,f,c,a,o,R){var L,F,u=d.file,w=d.compression,y=R!==C.utf8encode,l=g.transformTo("string",R(u.name)),h=g.transformTo("string",C.utf8encode(u.name)),I=u.comment,k=g.transformTo("string",R(I)),T=g.transformTo("string",C.utf8encode(I)),U=h.length!==u.name.length,_=T.length!==I.length,V="",lt="",J="",ct=u.dir,et=u.date,pt={crc32:0,compressedSize:0,uncompressedSize:0};f&&!c||(pt.crc32=d.crc32,pt.compressedSize=d.compressedSize,pt.uncompressedSize=d.uncompressedSize);var at=0;f&&(at|=8),y||!U&&!_||(at|=2048);var B=0,O=0;ct&&(B|=16),o==="UNIX"?(O=798,B|=function(N,G){var H=N;return N||(H=G?16893:33204),(65535&H)<<16}(u.unixPermissions,ct)):(O=20,B|=function(N){return 63&(N||0)}(u.dosPermissions)),L=et.getUTCHours(),L<<=6,L|=et.getUTCMinutes(),L<<=5,L|=et.getUTCSeconds()/2,F=et.getUTCFullYear()-1980,F<<=4,F|=et.getUTCMonth()+1,F<<=5,F|=et.getUTCDate(),U&&(lt=i(1,1)+i(b(l),4)+h,V+="up"+i(lt.length,2)+lt),_&&(J=i(1,1)+i(b(k),4)+T,V+="uc"+i(J.length,2)+J);var D="";return D+=`
\0`,D+=i(at,2),D+=w.magic,D+=i(L,2),D+=i(F,2),D+=i(pt.crc32,4),D+=i(pt.compressedSize,4),D+=i(pt.uncompressedSize,4),D+=i(l.length,2),D+=i(V.length,2),{fileRecord:M.LOCAL_FILE_HEADER+D+l+V,dirRecord:M.CENTRAL_FILE_HEADER+i(O,2)+D+i(k.length,2)+"\0\0\0\0"+i(B,4)+i(a,4)+l+V+k}}var g=e("../utils"),m=e("../stream/GenericWorker"),C=e("../utf8"),b=e("../crc32"),M=e("../signature");function S(d,f,c,a){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=f,this.zipPlatform=c,this.encodeFileName=a,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}g.inherits(S,m),S.prototype.push=function(d){var f=d.meta.percent||0,c=this.entriesCount,a=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,m.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:c?(f+100*(c-a-1))/c:100}}))},S.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var f=this.streamFiles&&!d.file.dir;if(f){var c=p(d,f,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},S.prototype.closedSource=function(d){this.accumulate=!1;var f=this.streamFiles&&!d.file.dir,c=p(d,f,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),f)this.push({data:function(a){return M.DATA_DESCRIPTOR+i(a.crc32,4)+i(a.compressedSize,4)+i(a.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},S.prototype.flush=function(){for(var d=this.bytesWritten,f=0;f<this.dirRecords.length;f++)this.push({data:this.dirRecords[f],meta:{percent:100}});var c=this.bytesWritten-d,a=function(o,R,L,F,u){var w=g.transformTo("string",u(F));return M.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(o,2)+i(o,2)+i(R,4)+i(L,4)+i(w.length,2)+w}(this.dirRecords.length,c,d,this.zipComment,this.encodeFileName);this.push({data:a,meta:{percent:100}})},S.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},S.prototype.registerPrevious=function(d){this._sources.push(d);var f=this;return d.on("data",function(c){f.processChunk(c)}),d.on("end",function(){f.closedSource(f.previous.streamInfo),f._sources.length?f.prepareNextSource():f.end()}),d.on("error",function(c){f.error(c)}),this},S.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},S.prototype.error=function(d){var f=this._sources;if(!m.prototype.error.call(this,d))return!1;for(var c=0;c<f.length;c++)try{f[c].error(d)}catch{}return!0},S.prototype.lock=function(){m.prototype.lock.call(this);for(var d=this._sources,f=0;f<d.length;f++)d[f].lock()},r.exports=S},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,s){var i=e("../compressions"),p=e("./ZipFileWorker");s.generateWorker=function(g,m,C){var b=new p(m.streamFiles,C,m.platform,m.encodeFileName),M=0;try{g.forEach(function(S,d){M++;var f=function(R,L){var F=R||L,u=i[F];if(!u)throw new Error(F+" is not a valid compression method !");return u}(d.options.compression,m.compression),c=d.options.compressionOptions||m.compressionOptions||{},a=d.dir,o=d.date;d._compressWorker(f,c).withStreamInfo("file",{name:S,dir:a,date:o,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(b)}),b.entriesCount=M}catch(S){b.error(S)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var p=new i;for(var g in this)typeof this[g]!="function"&&(p[g]=this[g]);return p}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(p,g){return new i().loadAsync(p,g)},i.external=e("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,s){var i=e("./utils"),p=e("./external"),g=e("./utf8"),m=e("./zipEntries"),C=e("./stream/Crc32Probe"),b=e("./nodejsUtils");function M(S){return new p.Promise(function(d,f){var c=S.decompressed.getContentWorker().pipe(new C);c.on("error",function(a){f(a)}).on("end",function(){c.streamInfo.crc32!==S.decompressed.crc32?f(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}r.exports=function(S,d){var f=this;return d=i.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),b.isNode&&b.isStream(S)?p.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",S,!0,d.optimizedBinaryString,d.base64).then(function(c){var a=new m(d);return a.load(c),a}).then(function(c){var a=[p.Promise.resolve(c)],o=c.files;if(d.checkCRC32)for(var R=0;R<o.length;R++)a.push(M(o[R]));return p.Promise.all(a)}).then(function(c){for(var a=c.shift(),o=a.files,R=0;R<o.length;R++){var L=o[R],F=L.fileNameStr,u=i.resolve(L.fileNameStr);f.file(u,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:d.createFolders}),L.dir||(f.file(u).unsafeOriginalName=F)}return a.zipComment.length&&(f.comment=a.zipComment),f})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,s){var i=e("../utils"),p=e("../stream/GenericWorker");function g(m,C){p.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(C)}i.inherits(g,p),g.prototype._bindStream=function(m){var C=this;(this._stream=m).pause(),m.on("data",function(b){C.push({data:b,meta:{percent:0}})}).on("error",function(b){C.isPaused?this.generatedError=b:C.error(b)}).on("end",function(){C.isPaused?C._upstreamEnded=!0:C.end()})},g.prototype.pause=function(){return!!p.prototype.pause.call(this)&&(this._stream.pause(),!0)},g.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=g},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,s){var i=e("readable-stream").Readable;function p(g,m,C){i.call(this,m),this._helper=g;var b=this;g.on("data",function(M,S){b.push(M)||b._helper.pause(),C&&C(S)}).on("error",function(M){b.emit("error",M)}).on("end",function(){b.push(null)})}e("../utils").inherits(p,i),p.prototype._read=function(){this._helper.resume()},r.exports=p},{"../utils":32,"readable-stream":16}],14:[function(e,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,p){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,p);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,p)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var p=new Buffer(i);return p.fill(0),p},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,r,s){function i(u,w,y){var l,h=g.getTypeOf(w),I=g.extend(y||{},b);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(u=o(u)),I.createFolders&&(l=a(u))&&R.call(this,l,!0);var k=h==="string"&&I.binary===!1&&I.base64===!1;y&&y.binary!==void 0||(I.binary=!k),(w instanceof M&&w.uncompressedSize===0||I.dir||!w||w.length===0)&&(I.base64=!1,I.binary=!0,w="",I.compression="STORE",h="string");var T=null;T=w instanceof M||w instanceof m?w:f.isNode&&f.isStream(w)?new c(u,w):g.prepareContent(u,w,I.binary,I.optimizedBinaryString,I.base64);var U=new S(u,T,I);this.files[u]=U}var p=e("./utf8"),g=e("./utils"),m=e("./stream/GenericWorker"),C=e("./stream/StreamHelper"),b=e("./defaults"),M=e("./compressedObject"),S=e("./zipObject"),d=e("./generate"),f=e("./nodejsUtils"),c=e("./nodejs/NodejsStreamInputAdapter"),a=function(u){u.slice(-1)==="/"&&(u=u.substring(0,u.length-1));var w=u.lastIndexOf("/");return 0<w?u.substring(0,w):""},o=function(u){return u.slice(-1)!=="/"&&(u+="/"),u},R=function(u,w){return w=w!==void 0?w:b.createFolders,u=o(u),this.files[u]||i.call(this,u,null,{dir:!0,createFolders:w}),this.files[u]};function L(u){return Object.prototype.toString.call(u)==="[object RegExp]"}var F={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(u){var w,y,l;for(w in this.files)l=this.files[w],(y=w.slice(this.root.length,w.length))&&w.slice(0,this.root.length)===this.root&&u(y,l)},filter:function(u){var w=[];return this.forEach(function(y,l){u(y,l)&&w.push(l)}),w},file:function(u,w,y){if(arguments.length!==1)return u=this.root+u,i.call(this,u,w,y),this;if(L(u)){var l=u;return this.filter(function(I,k){return!k.dir&&l.test(I)})}var h=this.files[this.root+u];return h&&!h.dir?h:null},folder:function(u){if(!u)return this;if(L(u))return this.filter(function(h,I){return I.dir&&u.test(h)});var w=this.root+u,y=R.call(this,w),l=this.clone();return l.root=y.name,l},remove:function(u){u=this.root+u;var w=this.files[u];if(w||(u.slice(-1)!=="/"&&(u+="/"),w=this.files[u]),w&&!w.dir)delete this.files[u];else for(var y=this.filter(function(h,I){return I.name.slice(0,u.length)===u}),l=0;l<y.length;l++)delete this.files[y[l].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(u){var w,y={};try{if((y=g.extend(u||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:p.utf8encode})).type=y.type.toLowerCase(),y.compression=y.compression.toUpperCase(),y.type==="binarystring"&&(y.type="string"),!y.type)throw new Error("No output type specified.");g.checkSupport(y.type),y.platform!=="darwin"&&y.platform!=="freebsd"&&y.platform!=="linux"&&y.platform!=="sunos"||(y.platform="UNIX"),y.platform==="win32"&&(y.platform="DOS");var l=y.comment||this.comment||"";w=d.generateWorker(this,y,l)}catch(h){(w=new m("error")).error(h)}return new C(w,y.type||"string",y.mimeType)},generateAsync:function(u,w){return this.generateInternalStream(u).accumulate(w)},generateNodeStream:function(u,w){return(u=u||{}).type||(u.type="nodebuffer"),this.generateInternalStream(u).toNodejsStream(w)}};r.exports=F},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,s){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,s){var i=e("./DataReader");function p(g){i.call(this,g);for(var m=0;m<this.data.length;m++)g[m]=255&g[m]}e("../utils").inherits(p,i),p.prototype.byteAt=function(g){return this.data[this.zero+g]},p.prototype.lastIndexOfSignature=function(g){for(var m=g.charCodeAt(0),C=g.charCodeAt(1),b=g.charCodeAt(2),M=g.charCodeAt(3),S=this.length-4;0<=S;--S)if(this.data[S]===m&&this.data[S+1]===C&&this.data[S+2]===b&&this.data[S+3]===M)return S-this.zero;return-1},p.prototype.readAndCheckSignature=function(g){var m=g.charCodeAt(0),C=g.charCodeAt(1),b=g.charCodeAt(2),M=g.charCodeAt(3),S=this.readData(4);return m===S[0]&&C===S[1]&&b===S[2]&&M===S[3]},p.prototype.readData=function(g){if(this.checkOffset(g),g===0)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,m},r.exports=p},{"../utils":32,"./DataReader":18}],18:[function(e,r,s){var i=e("../utils");function p(g){this.data=g,this.length=g.length,this.index=0,this.zero=0}p.prototype={checkOffset:function(g){this.checkIndex(this.index+g)},checkIndex:function(g){if(this.length<this.zero+g||g<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+g+"). Corrupted zip ?")},setIndex:function(g){this.checkIndex(g),this.index=g},skip:function(g){this.setIndex(this.index+g)},byteAt:function(){},readInt:function(g){var m,C=0;for(this.checkOffset(g),m=this.index+g-1;m>=this.index;m--)C=(C<<8)+this.byteAt(m);return this.index+=g,C},readString:function(g){return i.transformTo("string",this.readData(g))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var g=this.readInt(4);return new Date(Date.UTC(1980+(g>>25&127),(g>>21&15)-1,g>>16&31,g>>11&31,g>>5&63,(31&g)<<1))}},r.exports=p},{"../utils":32}],19:[function(e,r,s){var i=e("./Uint8ArrayReader");function p(g){i.call(this,g)}e("../utils").inherits(p,i),p.prototype.readData=function(g){this.checkOffset(g);var m=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,m},r.exports=p},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,s){var i=e("./DataReader");function p(g){i.call(this,g)}e("../utils").inherits(p,i),p.prototype.byteAt=function(g){return this.data.charCodeAt(this.zero+g)},p.prototype.lastIndexOfSignature=function(g){return this.data.lastIndexOf(g)-this.zero},p.prototype.readAndCheckSignature=function(g){return g===this.readData(4)},p.prototype.readData=function(g){this.checkOffset(g);var m=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,m},r.exports=p},{"../utils":32,"./DataReader":18}],21:[function(e,r,s){var i=e("./ArrayReader");function p(g){i.call(this,g)}e("../utils").inherits(p,i),p.prototype.readData=function(g){if(this.checkOffset(g),g===0)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+g);return this.index+=g,m},r.exports=p},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,s){var i=e("../utils"),p=e("../support"),g=e("./ArrayReader"),m=e("./StringReader"),C=e("./NodeBufferReader"),b=e("./Uint8ArrayReader");r.exports=function(M){var S=i.getTypeOf(M);return i.checkSupport(S),S!=="string"||p.uint8array?S==="nodebuffer"?new C(M):p.uint8array?new b(i.transformTo("uint8array",M)):new g(i.transformTo("array",M)):new m(M)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,s){var i=e("./GenericWorker"),p=e("../utils");function g(m){i.call(this,"ConvertWorker to "+m),this.destType=m}p.inherits(g,i),g.prototype.processChunk=function(m){this.push({data:p.transformTo(this.destType,m.data),meta:m.meta})},r.exports=g},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,s){var i=e("./GenericWorker"),p=e("../crc32");function g(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(g,i),g.prototype.processChunk=function(m){this.streamInfo.crc32=p(m.data,this.streamInfo.crc32||0),this.push(m)},r.exports=g},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,s){var i=e("../utils"),p=e("./GenericWorker");function g(m){p.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}i.inherits(g,p),g.prototype.processChunk=function(m){if(m){var C=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=C+m.data.length}p.prototype.processChunk.call(this,m)},r.exports=g},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,s){var i=e("../utils"),p=e("./GenericWorker");function g(m){p.call(this,"DataWorker");var C=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function(b){C.dataIsReady=!0,C.data=b,C.max=b&&b.length||0,C.type=i.getTypeOf(b),C.isPaused||C._tickAndRepeat()},function(b){C.error(b)})}i.inherits(g,p),g.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this.data=null},g.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},g.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},g.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,C=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,C);break;case"uint8array":m=this.data.subarray(this.index,C);break;case"array":case"nodebuffer":m=this.data.slice(this.index,C)}return this.index=C,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=g},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,s){function i(p){this.name=p||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(p){this.emit("data",p)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(p){this.emit("error",p)}return!0},error:function(p){return!this.isFinished&&(this.isPaused?this.generatedError=p:(this.isFinished=!0,this.emit("error",p),this.previous&&this.previous.error(p),this.cleanUp()),!0)},on:function(p,g){return this._listeners[p].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(p,g){if(this._listeners[p])for(var m=0;m<this._listeners[p].length;m++)this._listeners[p][m].call(this,g)},pipe:function(p){return p.registerPrevious(this)},registerPrevious:function(p){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=p.streamInfo,this.mergeStreamInfo(),this.previous=p;var g=this;return p.on("data",function(m){g.processChunk(m)}),p.on("end",function(){g.end()}),p.on("error",function(m){g.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var p=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),p=!0),this.previous&&this.previous.resume(),!p},flush:function(){},processChunk:function(p){this.push(p)},withStreamInfo:function(p,g){return this.extraStreamInfo[p]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var p in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,p)&&(this.streamInfo[p]=this.extraStreamInfo[p])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var p="Worker "+this.name;return this.previous?this.previous+" -> "+p:p}},r.exports=i},{}],29:[function(e,r,s){var i=e("../utils"),p=e("./ConvertWorker"),g=e("./GenericWorker"),m=e("../base64"),C=e("../support"),b=e("../external"),M=null;if(C.nodestream)try{M=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function S(f,c){return new b.Promise(function(a,o){var R=[],L=f._internalType,F=f._outputType,u=f._mimeType;f.on("data",function(w,y){R.push(w),c&&c(y)}).on("error",function(w){R=[],o(w)}).on("end",function(){try{var w=function(y,l,h){switch(y){case"blob":return i.newBlob(i.transformTo("arraybuffer",l),h);case"base64":return m.encode(l);default:return i.transformTo(y,l)}}(F,function(y,l){var h,I=0,k=null,T=0;for(h=0;h<l.length;h++)T+=l[h].length;switch(y){case"string":return l.join("");case"array":return Array.prototype.concat.apply([],l);case"uint8array":for(k=new Uint8Array(T),h=0;h<l.length;h++)k.set(l[h],I),I+=l[h].length;return k;case"nodebuffer":return Buffer.concat(l);default:throw new Error("concat : unsupported type '"+y+"'")}}(L,R),u);a(w)}catch(y){o(y)}R=[]}).resume()})}function d(f,c,a){var o=c;switch(c){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=c,this._mimeType=a,i.checkSupport(o),this._worker=f.pipe(new p(o)),f.lock()}catch(R){this._worker=new g("error"),this._worker.error(R)}}d.prototype={accumulate:function(f){return S(this,f)},on:function(f,c){var a=this;return f==="data"?this._worker.on(f,function(o){c.call(a,o.data,o.meta)}):this._worker.on(f,function(){i.delay(c,arguments,a)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(f){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new M(this,{objectMode:this._outputType!=="nodebuffer"},f)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);p.append(i),s.blob=p.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,s){for(var i=e("./utils"),p=e("./support"),g=e("./nodejsUtils"),m=e("./stream/GenericWorker"),C=new Array(256),b=0;b<256;b++)C[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;C[254]=C[254]=1;function M(){m.call(this,"utf-8 decode"),this.leftOver=null}function S(){m.call(this,"utf-8 encode")}s.utf8encode=function(d){return p.nodebuffer?g.newBufferFrom(d,"utf-8"):function(f){var c,a,o,R,L,F=f.length,u=0;for(R=0;R<F;R++)(64512&(a=f.charCodeAt(R)))==55296&&R+1<F&&(64512&(o=f.charCodeAt(R+1)))==56320&&(a=65536+(a-55296<<10)+(o-56320),R++),u+=a<128?1:a<2048?2:a<65536?3:4;for(c=p.uint8array?new Uint8Array(u):new Array(u),R=L=0;L<u;R++)(64512&(a=f.charCodeAt(R)))==55296&&R+1<F&&(64512&(o=f.charCodeAt(R+1)))==56320&&(a=65536+(a-55296<<10)+(o-56320),R++),a<128?c[L++]=a:(a<2048?c[L++]=192|a>>>6:(a<65536?c[L++]=224|a>>>12:(c[L++]=240|a>>>18,c[L++]=128|a>>>12&63),c[L++]=128|a>>>6&63),c[L++]=128|63&a);return c}(d)},s.utf8decode=function(d){return p.nodebuffer?i.transformTo("nodebuffer",d).toString("utf-8"):function(f){var c,a,o,R,L=f.length,F=new Array(2*L);for(c=a=0;c<L;)if((o=f[c++])<128)F[a++]=o;else if(4<(R=C[o]))F[a++]=65533,c+=R-1;else{for(o&=R===2?31:R===3?15:7;1<R&&c<L;)o=o<<6|63&f[c++],R--;1<R?F[a++]=65533:o<65536?F[a++]=o:(o-=65536,F[a++]=55296|o>>10&1023,F[a++]=56320|1023&o)}return F.length!==a&&(F.subarray?F=F.subarray(0,a):F.length=a),i.applyFromCharCode(F)}(d=i.transformTo(p.uint8array?"uint8array":"array",d))},i.inherits(M,m),M.prototype.processChunk=function(d){var f=i.transformTo(p.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(p.uint8array){var c=f;(f=new Uint8Array(c.length+this.leftOver.length)).set(this.leftOver,0),f.set(c,this.leftOver.length)}else f=this.leftOver.concat(f);this.leftOver=null}var a=function(R,L){var F;for((L=L||R.length)>R.length&&(L=R.length),F=L-1;0<=F&&(192&R[F])==128;)F--;return F<0||F===0?L:F+C[R[F]]>L?F:L}(f),o=f;a!==f.length&&(p.uint8array?(o=f.subarray(0,a),this.leftOver=f.subarray(a,f.length)):(o=f.slice(0,a),this.leftOver=f.slice(a,f.length))),this.push({data:s.utf8decode(o),meta:d.meta})},M.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=M,i.inherits(S,m),S.prototype.processChunk=function(d){this.push({data:s.utf8encode(d.data),meta:d.meta})},s.Utf8EncodeWorker=S},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,s){var i=e("./support"),p=e("./base64"),g=e("./nodejsUtils"),m=e("./external");function C(c){return c}function b(c,a){for(var o=0;o<c.length;++o)a[o]=255&c.charCodeAt(o);return a}e("setimmediate"),s.newBlob=function(c,a){s.checkSupport("blob");try{return new Blob([c],{type:a})}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return o.append(c),o.getBlob(a)}catch{throw new Error("Bug : can't construct the Blob.")}}};var M={stringifyByChunk:function(c,a,o){var R=[],L=0,F=c.length;if(F<=o)return String.fromCharCode.apply(null,c);for(;L<F;)a==="array"||a==="nodebuffer"?R.push(String.fromCharCode.apply(null,c.slice(L,Math.min(L+o,F)))):R.push(String.fromCharCode.apply(null,c.subarray(L,Math.min(L+o,F)))),L+=o;return R.join("")},stringifyByChar:function(c){for(var a="",o=0;o<c.length;o++)a+=String.fromCharCode(c[o]);return a},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,g.allocBuffer(1)).length===1}catch{return!1}}()}};function S(c){var a=65536,o=s.getTypeOf(c),R=!0;if(o==="uint8array"?R=M.applyCanBeUsed.uint8array:o==="nodebuffer"&&(R=M.applyCanBeUsed.nodebuffer),R)for(;1<a;)try{return M.stringifyByChunk(c,o,a)}catch{a=Math.floor(a/2)}return M.stringifyByChar(c)}function d(c,a){for(var o=0;o<c.length;o++)a[o]=c[o];return a}s.applyFromCharCode=S;var f={};f.string={string:C,array:function(c){return b(c,new Array(c.length))},arraybuffer:function(c){return f.string.uint8array(c).buffer},uint8array:function(c){return b(c,new Uint8Array(c.length))},nodebuffer:function(c){return b(c,g.allocBuffer(c.length))}},f.array={string:S,array:C,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return g.newBufferFrom(c)}},f.arraybuffer={string:function(c){return S(new Uint8Array(c))},array:function(c){return d(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:C,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return g.newBufferFrom(new Uint8Array(c))}},f.uint8array={string:S,array:function(c){return d(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:C,nodebuffer:function(c){return g.newBufferFrom(c)}},f.nodebuffer={string:S,array:function(c){return d(c,new Array(c.length))},arraybuffer:function(c){return f.nodebuffer.uint8array(c).buffer},uint8array:function(c){return d(c,new Uint8Array(c.length))},nodebuffer:C},s.transformTo=function(c,a){if(a=a||"",!c)return a;s.checkSupport(c);var o=s.getTypeOf(a);return f[o][c](a)},s.resolve=function(c){for(var a=c.split("/"),o=[],R=0;R<a.length;R++){var L=a[R];L==="."||L===""&&R!==0&&R!==a.length-1||(L===".."?o.pop():o.push(L))}return o.join("/")},s.getTypeOf=function(c){return typeof c=="string"?"string":Object.prototype.toString.call(c)==="[object Array]"?"array":i.nodebuffer&&g.isBuffer(c)?"nodebuffer":i.uint8array&&c instanceof Uint8Array?"uint8array":i.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(c){if(!i[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(c){var a,o,R="";for(o=0;o<(c||"").length;o++)R+="\\x"+((a=c.charCodeAt(o))<16?"0":"")+a.toString(16).toUpperCase();return R},s.delay=function(c,a,o){setImmediate(function(){c.apply(o||null,a||[])})},s.inherits=function(c,a){function o(){}o.prototype=a.prototype,c.prototype=new o},s.extend=function(){var c,a,o={};for(c=0;c<arguments.length;c++)for(a in arguments[c])Object.prototype.hasOwnProperty.call(arguments[c],a)&&o[a]===void 0&&(o[a]=arguments[c][a]);return o},s.prepareContent=function(c,a,o,R,L){return m.Promise.resolve(a).then(function(F){return i.blob&&(F instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(F))!==-1)&&typeof FileReader<"u"?new m.Promise(function(u,w){var y=new FileReader;y.onload=function(l){u(l.target.result)},y.onerror=function(l){w(l.target.error)},y.readAsArrayBuffer(F)}):F}).then(function(F){var u=s.getTypeOf(F);return u?(u==="arraybuffer"?F=s.transformTo("uint8array",F):u==="string"&&(L?F=p.decode(F):o&&R!==!0&&(F=function(w){return b(w,i.uint8array?new Uint8Array(w.length):new Array(w.length))}(F))),F):m.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,s){var i=e("./reader/readerFor"),p=e("./utils"),g=e("./signature"),m=e("./zipEntry"),C=e("./support");function b(M){this.files=[],this.loadOptions=M}b.prototype={checkSignature:function(M){if(!this.reader.readAndCheckSignature(M)){this.reader.index-=4;var S=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+p.pretty(S)+", expected "+p.pretty(M)+")")}},isSignature:function(M,S){var d=this.reader.index;this.reader.setIndex(M);var f=this.reader.readString(4)===S;return this.reader.setIndex(d),f},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var M=this.reader.readData(this.zipCommentLength),S=C.uint8array?"uint8array":"array",d=p.transformTo(S,M);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var M,S,d,f=this.zip64EndOfCentralSize-44;0<f;)M=this.reader.readInt(2),S=this.reader.readInt(4),d=this.reader.readData(S),this.zip64ExtensibleData[M]={id:M,length:S,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var M,S;for(M=0;M<this.files.length;M++)S=this.files[M],this.reader.setIndex(S.localHeaderOffset),this.checkSignature(g.LOCAL_FILE_HEADER),S.readLocalPart(this.reader),S.handleUTF8(),S.processAttributes()},readCentralDir:function(){var M;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(g.CENTRAL_FILE_HEADER);)(M=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(M);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var M=this.reader.lastIndexOfSignature(g.CENTRAL_DIRECTORY_END);if(M<0)throw this.isSignature(0,g.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(M);var S=M;if(this.checkSignature(g.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===p.MAX_VALUE_16BITS||this.diskWithCentralDirStart===p.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===p.MAX_VALUE_16BITS||this.centralDirRecords===p.MAX_VALUE_16BITS||this.centralDirSize===p.MAX_VALUE_32BITS||this.centralDirOffset===p.MAX_VALUE_32BITS){if(this.zip64=!0,(M=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(M),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,g.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var f=S-d;if(0<f)this.isSignature(S,g.CENTRAL_FILE_HEADER)||(this.reader.zero=f);else if(f<0)throw new Error("Corrupted zip: missing "+Math.abs(f)+" bytes.")},prepareReader:function(M){this.reader=i(M)},load:function(M){this.prepareReader(M),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,s){var i=e("./reader/readerFor"),p=e("./utils"),g=e("./compressedObject"),m=e("./crc32"),C=e("./utf8"),b=e("./compressions"),M=e("./support");function S(d,f){this.options=d,this.loadOptions=f}S.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var f,c;if(d.skip(22),this.fileNameLength=d.readInt(2),c=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((f=function(a){for(var o in b)if(Object.prototype.hasOwnProperty.call(b,o)&&b[o].magic===a)return b[o];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+p.pretty(this.compressionMethod)+" unknown (inner file : "+p.transformTo("string",this.fileName)+")");this.decompressed=new g(this.compressedSize,this.uncompressedSize,this.crc32,f,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var f=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(f),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===p.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===p.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===p.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===p.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var f,c,a,o=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<o;)f=d.readInt(2),c=d.readInt(2),a=d.readData(c),this.extraFields[f]={id:f,length:c,value:a};d.setIndex(o)},handleUTF8:function(){var d=M.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=C.utf8decode(this.fileName),this.fileCommentStr=C.utf8decode(this.fileComment);else{var f=this.findExtraFieldUnicodePath();if(f!==null)this.fileNameStr=f;else{var c=p.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var a=this.findExtraFieldUnicodeComment();if(a!==null)this.fileCommentStr=a;else{var o=p.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var f=i(d.value);return f.readInt(1)!==1||m(this.fileName)!==f.readInt(4)?null:C.utf8decode(f.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var f=i(d.value);return f.readInt(1)!==1||m(this.fileComment)!==f.readInt(4)?null:C.utf8decode(f.readData(d.length-5))}return null}},r.exports=S},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,s){function i(f,c,a){this.name=f,this.dir=a.dir,this.date=a.date,this.comment=a.comment,this.unixPermissions=a.unixPermissions,this.dosPermissions=a.dosPermissions,this._data=c,this._dataBinary=a.binary,this.options={compression:a.compression,compressionOptions:a.compressionOptions}}var p=e("./stream/StreamHelper"),g=e("./stream/DataWorker"),m=e("./utf8"),C=e("./compressedObject"),b=e("./stream/GenericWorker");i.prototype={internalStream:function(f){var c=null,a="string";try{if(!f)throw new Error("No output type specified.");var o=(a=f.toLowerCase())==="string"||a==="text";a!=="binarystring"&&a!=="text"||(a="string"),c=this._decompressWorker();var R=!this._dataBinary;R&&!o&&(c=c.pipe(new m.Utf8EncodeWorker)),!R&&o&&(c=c.pipe(new m.Utf8DecodeWorker))}catch(L){(c=new b("error")).error(L)}return new p(c,a,"")},async:function(f,c){return this.internalStream(f).accumulate(c)},nodeStream:function(f,c){return this.internalStream(f||"nodebuffer").toNodejsStream(c)},_compressWorker:function(f,c){if(this._data instanceof C&&this._data.compression.magic===f.magic)return this._data.getCompressedWorker();var a=this._decompressWorker();return this._dataBinary||(a=a.pipe(new m.Utf8EncodeWorker)),C.createWorkerFrom(a,f,c)},_decompressWorker:function(){return this._data instanceof C?this._data.getContentWorker():this._data instanceof b?this._data:new g(this._data)}};for(var M=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],S=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<M.length;d++)i.prototype[M[d]]=S;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,s){(function(i){var p,g,m=i.MutationObserver||i.WebKitMutationObserver;if(m){var C=0,b=new m(f),M=i.document.createTextNode("");b.observe(M,{characterData:!0}),p=function(){M.data=C=++C%2}}else if(i.setImmediate||i.MessageChannel===void 0)p="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var c=i.document.createElement("script");c.onreadystatechange=function(){f(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},i.document.documentElement.appendChild(c)}:function(){setTimeout(f,0)};else{var S=new i.MessageChannel;S.port1.onmessage=f,p=function(){S.port2.postMessage(0)}}var d=[];function f(){var c,a;g=!0;for(var o=d.length;o;){for(a=d,d=[],c=-1;++c<o;)a[c]();o=d.length}g=!1}r.exports=function(c){d.push(c)!==1||g||p()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,s){var i=e("immediate");function p(){}var g={},m=["REJECTED"],C=["FULFILLED"],b=["PENDING"];function M(o){if(typeof o!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,o!==p&&c(this,o)}function S(o,R,L){this.promise=o,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function d(o,R,L){i(function(){var F;try{F=R(L)}catch(u){return g.reject(o,u)}F===o?g.reject(o,new TypeError("Cannot resolve promise with itself")):g.resolve(o,F)})}function f(o){var R=o&&o.then;if(o&&(typeof o=="object"||typeof o=="function")&&typeof R=="function")return function(){R.apply(o,arguments)}}function c(o,R){var L=!1;function F(y){L||(L=!0,g.reject(o,y))}function u(y){L||(L=!0,g.resolve(o,y))}var w=a(function(){R(u,F)});w.status==="error"&&F(w.value)}function a(o,R){var L={};try{L.value=o(R),L.status="success"}catch(F){L.status="error",L.value=F}return L}(r.exports=M).prototype.finally=function(o){if(typeof o!="function")return this;var R=this.constructor;return this.then(function(L){return R.resolve(o()).then(function(){return L})},function(L){return R.resolve(o()).then(function(){throw L})})},M.prototype.catch=function(o){return this.then(null,o)},M.prototype.then=function(o,R){if(typeof o!="function"&&this.state===C||typeof R!="function"&&this.state===m)return this;var L=new this.constructor(p);return this.state!==b?d(L,this.state===C?o:R,this.outcome):this.queue.push(new S(L,o,R)),L},S.prototype.callFulfilled=function(o){g.resolve(this.promise,o)},S.prototype.otherCallFulfilled=function(o){d(this.promise,this.onFulfilled,o)},S.prototype.callRejected=function(o){g.reject(this.promise,o)},S.prototype.otherCallRejected=function(o){d(this.promise,this.onRejected,o)},g.resolve=function(o,R){var L=a(f,R);if(L.status==="error")return g.reject(o,L.value);var F=L.value;if(F)c(o,F);else{o.state=C,o.outcome=R;for(var u=-1,w=o.queue.length;++u<w;)o.queue[u].callFulfilled(R)}return o},g.reject=function(o,R){o.state=m,o.outcome=R;for(var L=-1,F=o.queue.length;++L<F;)o.queue[L].callRejected(R);return o},M.resolve=function(o){return o instanceof this?o:g.resolve(new this(p),o)},M.reject=function(o){var R=new this(p);return g.reject(R,o)},M.all=function(o){var R=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=o.length,F=!1;if(!L)return this.resolve([]);for(var u=new Array(L),w=0,y=-1,l=new this(p);++y<L;)h(o[y],y);return l;function h(I,k){R.resolve(I).then(function(T){u[k]=T,++w!==L||F||(F=!0,g.resolve(l,u))},function(T){F||(F=!0,g.reject(l,T))})}},M.race=function(o){var R=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=o.length,F=!1;if(!L)return this.resolve([]);for(var u=-1,w=new this(p);++u<L;)y=o[u],R.resolve(y).then(function(l){F||(F=!0,g.resolve(w,l))},function(l){F||(F=!0,g.reject(w,l))});var y;return w}},{immediate:36}],38:[function(e,r,s){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,s){var i=e("./zlib/deflate"),p=e("./utils/common"),g=e("./utils/strings"),m=e("./zlib/messages"),C=e("./zlib/zstream"),b=Object.prototype.toString,M=0,S=-1,d=0,f=8;function c(o){if(!(this instanceof c))return new c(o);this.options=p.assign({level:S,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},o||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C,this.strm.avail_out=0;var L=i.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(L!==M)throw new Error(m[L]);if(R.header&&i.deflateSetHeader(this.strm,R.header),R.dictionary){var F;if(F=typeof R.dictionary=="string"?g.string2buf(R.dictionary):b.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(L=i.deflateSetDictionary(this.strm,F))!==M)throw new Error(m[L]);this._dict_set=!0}}function a(o,R){var L=new c(R);if(L.push(o,!0),L.err)throw L.msg||m[L.err];return L.result}c.prototype.push=function(o,R){var L,F,u=this.strm,w=this.options.chunkSize;if(this.ended)return!1;F=R===~~R?R:R===!0?4:0,typeof o=="string"?u.input=g.string2buf(o):b.call(o)==="[object ArrayBuffer]"?u.input=new Uint8Array(o):u.input=o,u.next_in=0,u.avail_in=u.input.length;do{if(u.avail_out===0&&(u.output=new p.Buf8(w),u.next_out=0,u.avail_out=w),(L=i.deflate(u,F))!==1&&L!==M)return this.onEnd(L),!(this.ended=!0);u.avail_out!==0&&(u.avail_in!==0||F!==4&&F!==2)||(this.options.to==="string"?this.onData(g.buf2binstring(p.shrinkBuf(u.output,u.next_out))):this.onData(p.shrinkBuf(u.output,u.next_out)))}while((0<u.avail_in||u.avail_out===0)&&L!==1);return F===4?(L=i.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===M):F!==2||(this.onEnd(M),!(u.avail_out=0))},c.prototype.onData=function(o){this.chunks.push(o)},c.prototype.onEnd=function(o){o===M&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},s.Deflate=c,s.deflate=a,s.deflateRaw=function(o,R){return(R=R||{}).raw=!0,a(o,R)},s.gzip=function(o,R){return(R=R||{}).gzip=!0,a(o,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,s){var i=e("./zlib/inflate"),p=e("./utils/common"),g=e("./utils/strings"),m=e("./zlib/constants"),C=e("./zlib/messages"),b=e("./zlib/zstream"),M=e("./zlib/gzheader"),S=Object.prototype.toString;function d(c){if(!(this instanceof d))return new d(c);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},c||{});var a=this.options;a.raw&&0<=a.windowBits&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),!(0<=a.windowBits&&a.windowBits<16)||c&&c.windowBits||(a.windowBits+=32),15<a.windowBits&&a.windowBits<48&&!(15&a.windowBits)&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var o=i.inflateInit2(this.strm,a.windowBits);if(o!==m.Z_OK)throw new Error(C[o]);this.header=new M,i.inflateGetHeader(this.strm,this.header)}function f(c,a){var o=new d(a);if(o.push(c,!0),o.err)throw o.msg||C[o.err];return o.result}d.prototype.push=function(c,a){var o,R,L,F,u,w,y=this.strm,l=this.options.chunkSize,h=this.options.dictionary,I=!1;if(this.ended)return!1;R=a===~~a?a:a===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof c=="string"?y.input=g.binstring2buf(c):S.call(c)==="[object ArrayBuffer]"?y.input=new Uint8Array(c):y.input=c,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new p.Buf8(l),y.next_out=0,y.avail_out=l),(o=i.inflate(y,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&h&&(w=typeof h=="string"?g.string2buf(h):S.call(h)==="[object ArrayBuffer]"?new Uint8Array(h):h,o=i.inflateSetDictionary(this.strm,w)),o===m.Z_BUF_ERROR&&I===!0&&(o=m.Z_OK,I=!1),o!==m.Z_STREAM_END&&o!==m.Z_OK)return this.onEnd(o),!(this.ended=!0);y.next_out&&(y.avail_out!==0&&o!==m.Z_STREAM_END&&(y.avail_in!==0||R!==m.Z_FINISH&&R!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=g.utf8border(y.output,y.next_out),F=y.next_out-L,u=g.buf2string(y.output,L),y.next_out=F,y.avail_out=l-F,F&&p.arraySet(y.output,y.output,L,F,0),this.onData(u)):this.onData(p.shrinkBuf(y.output,y.next_out)))),y.avail_in===0&&y.avail_out===0&&(I=!0)}while((0<y.avail_in||y.avail_out===0)&&o!==m.Z_STREAM_END);return o===m.Z_STREAM_END&&(R=m.Z_FINISH),R===m.Z_FINISH?(o=i.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===m.Z_OK):R!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(y.avail_out=0))},d.prototype.onData=function(c){this.chunks.push(c)},d.prototype.onEnd=function(c){c===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},s.Inflate=d,s.inflate=f,s.inflateRaw=function(c,a){return(a=a||{}).raw=!0,f(c,a)},s.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(m){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var b=C.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var M in b)b.hasOwnProperty(M)&&(m[M]=b[M])}}return m},s.shrinkBuf=function(m,C){return m.length===C?m:m.subarray?m.subarray(0,C):(m.length=C,m)};var p={arraySet:function(m,C,b,M,S){if(C.subarray&&m.subarray)m.set(C.subarray(b,b+M),S);else for(var d=0;d<M;d++)m[S+d]=C[b+d]},flattenChunks:function(m){var C,b,M,S,d,f;for(C=M=0,b=m.length;C<b;C++)M+=m[C].length;for(f=new Uint8Array(M),C=S=0,b=m.length;C<b;C++)d=m[C],f.set(d,S),S+=d.length;return f}},g={arraySet:function(m,C,b,M,S){for(var d=0;d<M;d++)m[S+d]=C[b+d]},flattenChunks:function(m){return[].concat.apply([],m)}};s.setTyped=function(m){m?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,p)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,g))},s.setTyped(i)},{}],42:[function(e,r,s){var i=e("./common"),p=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch{p=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g=!1}for(var m=new i.Buf8(256),C=0;C<256;C++)m[C]=252<=C?6:248<=C?5:240<=C?4:224<=C?3:192<=C?2:1;function b(M,S){if(S<65537&&(M.subarray&&g||!M.subarray&&p))return String.fromCharCode.apply(null,i.shrinkBuf(M,S));for(var d="",f=0;f<S;f++)d+=String.fromCharCode(M[f]);return d}m[254]=m[254]=1,s.string2buf=function(M){var S,d,f,c,a,o=M.length,R=0;for(c=0;c<o;c++)(64512&(d=M.charCodeAt(c)))==55296&&c+1<o&&(64512&(f=M.charCodeAt(c+1)))==56320&&(d=65536+(d-55296<<10)+(f-56320),c++),R+=d<128?1:d<2048?2:d<65536?3:4;for(S=new i.Buf8(R),c=a=0;a<R;c++)(64512&(d=M.charCodeAt(c)))==55296&&c+1<o&&(64512&(f=M.charCodeAt(c+1)))==56320&&(d=65536+(d-55296<<10)+(f-56320),c++),d<128?S[a++]=d:(d<2048?S[a++]=192|d>>>6:(d<65536?S[a++]=224|d>>>12:(S[a++]=240|d>>>18,S[a++]=128|d>>>12&63),S[a++]=128|d>>>6&63),S[a++]=128|63&d);return S},s.buf2binstring=function(M){return b(M,M.length)},s.binstring2buf=function(M){for(var S=new i.Buf8(M.length),d=0,f=S.length;d<f;d++)S[d]=M.charCodeAt(d);return S},s.buf2string=function(M,S){var d,f,c,a,o=S||M.length,R=new Array(2*o);for(d=f=0;d<o;)if((c=M[d++])<128)R[f++]=c;else if(4<(a=m[c]))R[f++]=65533,d+=a-1;else{for(c&=a===2?31:a===3?15:7;1<a&&d<o;)c=c<<6|63&M[d++],a--;1<a?R[f++]=65533:c<65536?R[f++]=c:(c-=65536,R[f++]=55296|c>>10&1023,R[f++]=56320|1023&c)}return b(R,f)},s.utf8border=function(M,S){var d;for((S=S||M.length)>M.length&&(S=M.length),d=S-1;0<=d&&(192&M[d])==128;)d--;return d<0||d===0?S:d+m[M[d]]>S?d:S}},{"./common":41}],43:[function(e,r,s){r.exports=function(i,p,g,m){for(var C=65535&i|0,b=i>>>16&65535|0,M=0;g!==0;){for(g-=M=2e3<g?2e3:g;b=b+(C=C+p[m++]|0)|0,--M;);C%=65521,b%=65521}return C|b<<16|0}},{}],44:[function(e,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,s){var i=function(){for(var p,g=[],m=0;m<256;m++){p=m;for(var C=0;C<8;C++)p=1&p?3988292384^p>>>1:p>>>1;g[m]=p}return g}();r.exports=function(p,g,m,C){var b=i,M=C+m;p^=-1;for(var S=C;S<M;S++)p=p>>>8^b[255&(p^g[S])];return-1^p}},{}],46:[function(e,r,s){var i,p=e("../utils/common"),g=e("./trees"),m=e("./adler32"),C=e("./crc32"),b=e("./messages"),M=0,S=4,d=0,f=-2,c=-1,a=4,o=2,R=8,L=9,F=286,u=30,w=19,y=2*F+1,l=15,h=3,I=258,k=I+h+1,T=42,U=113,_=1,V=2,lt=3,J=4;function ct(n,v){return n.msg=b[v],v}function et(n){return(n<<1)-(4<n?9:0)}function pt(n){for(var v=n.length;0<=--v;)n[v]=0}function at(n){var v=n.state,P=v.pending;P>n.avail_out&&(P=n.avail_out),P!==0&&(p.arraySet(n.output,v.pending_buf,v.pending_out,P,n.next_out),n.next_out+=P,v.pending_out+=P,n.total_out+=P,n.avail_out-=P,v.pending-=P,v.pending===0&&(v.pending_out=0))}function B(n,v){g._tr_flush_block(n,0<=n.block_start?n.block_start:-1,n.strstart-n.block_start,v),n.block_start=n.strstart,at(n.strm)}function O(n,v){n.pending_buf[n.pending++]=v}function D(n,v){n.pending_buf[n.pending++]=v>>>8&255,n.pending_buf[n.pending++]=255&v}function N(n,v){var P,A,E=n.max_chain_length,j=n.strstart,Q=n.prev_length,K=n.nice_match,X=n.strstart>n.w_size-k?n.strstart-(n.w_size-k):0,rt=n.window,ht=n.w_mask,st=n.prev,dt=n.strstart+I,mt=rt[j+Q-1],At=rt[j+Q];n.prev_length>=n.good_match&&(E>>=2),K>n.lookahead&&(K=n.lookahead);do if(rt[(P=v)+Q]===At&&rt[P+Q-1]===mt&&rt[P]===rt[j]&&rt[++P]===rt[j+1]){j+=2,P++;do;while(rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&rt[++j]===rt[++P]&&j<dt);if(A=I-(dt-j),j=dt-I,Q<A){if(n.match_start=v,K<=(Q=A))break;mt=rt[j+Q-1],At=rt[j+Q]}}while((v=st[v&ht])>X&&--E!=0);return Q<=n.lookahead?Q:n.lookahead}function G(n){var v,P,A,E,j,Q,K,X,rt,ht,st=n.w_size;do{if(E=n.window_size-n.lookahead-n.strstart,n.strstart>=st+(st-k)){for(p.arraySet(n.window,n.window,st,st,0),n.match_start-=st,n.strstart-=st,n.block_start-=st,v=P=n.hash_size;A=n.head[--v],n.head[v]=st<=A?A-st:0,--P;);for(v=P=st;A=n.prev[--v],n.prev[v]=st<=A?A-st:0,--P;);E+=st}if(n.strm.avail_in===0)break;if(Q=n.strm,K=n.window,X=n.strstart+n.lookahead,rt=E,ht=void 0,ht=Q.avail_in,rt<ht&&(ht=rt),P=ht===0?0:(Q.avail_in-=ht,p.arraySet(K,Q.input,Q.next_in,ht,X),Q.state.wrap===1?Q.adler=m(Q.adler,K,ht,X):Q.state.wrap===2&&(Q.adler=C(Q.adler,K,ht,X)),Q.next_in+=ht,Q.total_in+=ht,ht),n.lookahead+=P,n.lookahead+n.insert>=h)for(j=n.strstart-n.insert,n.ins_h=n.window[j],n.ins_h=(n.ins_h<<n.hash_shift^n.window[j+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[j+h-1])&n.hash_mask,n.prev[j&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=j,j++,n.insert--,!(n.lookahead+n.insert<h)););}while(n.lookahead<k&&n.strm.avail_in!==0)}function H(n,v){for(var P,A;;){if(n.lookahead<k){if(G(n),n.lookahead<k&&v===M)return _;if(n.lookahead===0)break}if(P=0,n.lookahead>=h&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+h-1])&n.hash_mask,P=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),P!==0&&n.strstart-P<=n.w_size-k&&(n.match_length=N(n,P)),n.match_length>=h)if(A=g._tr_tally(n,n.strstart-n.match_start,n.match_length-h),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=h){for(n.match_length--;n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+h-1])&n.hash_mask,P=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart,--n.match_length!=0;);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else A=g._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(A&&(B(n,!1),n.strm.avail_out===0))return _}return n.insert=n.strstart<h-1?n.strstart:h-1,v===S?(B(n,!0),n.strm.avail_out===0?lt:J):n.last_lit&&(B(n,!1),n.strm.avail_out===0)?_:V}function Z(n,v){for(var P,A,E;;){if(n.lookahead<k){if(G(n),n.lookahead<k&&v===M)return _;if(n.lookahead===0)break}if(P=0,n.lookahead>=h&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+h-1])&n.hash_mask,P=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=h-1,P!==0&&n.prev_length<n.max_lazy_match&&n.strstart-P<=n.w_size-k&&(n.match_length=N(n,P),n.match_length<=5&&(n.strategy===1||n.match_length===h&&4096<n.strstart-n.match_start)&&(n.match_length=h-1)),n.prev_length>=h&&n.match_length<=n.prev_length){for(E=n.strstart+n.lookahead-h,A=g._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-h),n.lookahead-=n.prev_length-1,n.prev_length-=2;++n.strstart<=E&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+h-1])&n.hash_mask,P=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),--n.prev_length!=0;);if(n.match_available=0,n.match_length=h-1,n.strstart++,A&&(B(n,!1),n.strm.avail_out===0))return _}else if(n.match_available){if((A=g._tr_tally(n,0,n.window[n.strstart-1]))&&B(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return _}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(A=g._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<h-1?n.strstart:h-1,v===S?(B(n,!0),n.strm.avail_out===0?lt:J):n.last_lit&&(B(n,!1),n.strm.avail_out===0)?_:V}function $(n,v,P,A,E){this.good_length=n,this.max_lazy=v,this.nice_length=P,this.max_chain=A,this.func=E}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new p.Buf16(2*y),this.dyn_dtree=new p.Buf16(2*(2*u+1)),this.bl_tree=new p.Buf16(2*(2*w+1)),pt(this.dyn_ltree),pt(this.dyn_dtree),pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new p.Buf16(l+1),this.heap=new p.Buf16(2*F+1),pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new p.Buf16(2*F+1),pt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function it(n){var v;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=o,(v=n.state).pending=0,v.pending_out=0,v.wrap<0&&(v.wrap=-v.wrap),v.status=v.wrap?T:U,n.adler=v.wrap===2?0:1,v.last_flush=M,g._tr_init(v),d):ct(n,f)}function Y(n){var v=it(n);return v===d&&function(P){P.window_size=2*P.w_size,pt(P.head),P.max_lazy_match=i[P.level].max_lazy,P.good_match=i[P.level].good_length,P.nice_match=i[P.level].nice_length,P.max_chain_length=i[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=h-1,P.match_available=0,P.ins_h=0}(n.state),v}function W(n,v,P,A,E,j){if(!n)return f;var Q=1;if(v===c&&(v=6),A<0?(Q=0,A=-A):15<A&&(Q=2,A-=16),E<1||L<E||P!==R||A<8||15<A||v<0||9<v||j<0||a<j)return ct(n,f);A===8&&(A=9);var K=new ot;return(n.state=K).strm=n,K.wrap=Q,K.gzhead=null,K.w_bits=A,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=E+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+h-1)/h),K.window=new p.Buf8(2*K.w_size),K.head=new p.Buf16(K.hash_size),K.prev=new p.Buf16(K.w_size),K.lit_bufsize=1<<E+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new p.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=v,K.strategy=j,K.method=P,Y(n)}i=[new $(0,0,0,0,function(n,v){var P=65535;for(P>n.pending_buf_size-5&&(P=n.pending_buf_size-5);;){if(n.lookahead<=1){if(G(n),n.lookahead===0&&v===M)return _;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var A=n.block_start+P;if((n.strstart===0||n.strstart>=A)&&(n.lookahead=n.strstart-A,n.strstart=A,B(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-k&&(B(n,!1),n.strm.avail_out===0))return _}return n.insert=0,v===S?(B(n,!0),n.strm.avail_out===0?lt:J):(n.strstart>n.block_start&&(B(n,!1),n.strm.avail_out),_)}),new $(4,4,8,4,H),new $(4,5,16,8,H),new $(4,6,32,32,H),new $(4,4,16,16,Z),new $(8,16,32,32,Z),new $(8,16,128,128,Z),new $(8,32,128,256,Z),new $(32,128,258,1024,Z),new $(32,258,258,4096,Z)],s.deflateInit=function(n,v){return W(n,v,R,15,8,0)},s.deflateInit2=W,s.deflateReset=Y,s.deflateResetKeep=it,s.deflateSetHeader=function(n,v){return n&&n.state?n.state.wrap!==2?f:(n.state.gzhead=v,d):f},s.deflate=function(n,v){var P,A,E,j;if(!n||!n.state||5<v||v<0)return n?ct(n,f):f;if(A=n.state,!n.output||!n.input&&n.avail_in!==0||A.status===666&&v!==S)return ct(n,n.avail_out===0?-5:f);if(A.strm=n,P=A.last_flush,A.last_flush=v,A.status===T)if(A.wrap===2)n.adler=0,O(A,31),O(A,139),O(A,8),A.gzhead?(O(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),O(A,255&A.gzhead.time),O(A,A.gzhead.time>>8&255),O(A,A.gzhead.time>>16&255),O(A,A.gzhead.time>>24&255),O(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),O(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(O(A,255&A.gzhead.extra.length),O(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(n.adler=C(n.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(O(A,0),O(A,0),O(A,0),O(A,0),O(A,0),O(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),O(A,3),A.status=U);else{var Q=R+(A.w_bits-8<<4)<<8;Q|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(Q|=32),Q+=31-Q%31,A.status=U,D(A,Q),A.strstart!==0&&(D(A,n.adler>>>16),D(A,65535&n.adler)),n.adler=1}if(A.status===69)if(A.gzhead.extra){for(E=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),at(n),E=A.pending,A.pending!==A.pending_buf_size));)O(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),at(n),E=A.pending,A.pending===A.pending_buf_size)){j=1;break}j=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,O(A,j)}while(j!==0);A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),j===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),at(n),E=A.pending,A.pending===A.pending_buf_size)){j=1;break}j=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,O(A,j)}while(j!==0);A.gzhead.hcrc&&A.pending>E&&(n.adler=C(n.adler,A.pending_buf,A.pending-E,E)),j===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&at(n),A.pending+2<=A.pending_buf_size&&(O(A,255&n.adler),O(A,n.adler>>8&255),n.adler=0,A.status=U)):A.status=U),A.pending!==0){if(at(n),n.avail_out===0)return A.last_flush=-1,d}else if(n.avail_in===0&&et(v)<=et(P)&&v!==S)return ct(n,-5);if(A.status===666&&n.avail_in!==0)return ct(n,-5);if(n.avail_in!==0||A.lookahead!==0||v!==M&&A.status!==666){var K=A.strategy===2?function(X,rt){for(var ht;;){if(X.lookahead===0&&(G(X),X.lookahead===0)){if(rt===M)return _;break}if(X.match_length=0,ht=g._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++,ht&&(B(X,!1),X.strm.avail_out===0))return _}return X.insert=0,rt===S?(B(X,!0),X.strm.avail_out===0?lt:J):X.last_lit&&(B(X,!1),X.strm.avail_out===0)?_:V}(A,v):A.strategy===3?function(X,rt){for(var ht,st,dt,mt,At=X.window;;){if(X.lookahead<=I){if(G(X),X.lookahead<=I&&rt===M)return _;if(X.lookahead===0)break}if(X.match_length=0,X.lookahead>=h&&0<X.strstart&&(st=At[dt=X.strstart-1])===At[++dt]&&st===At[++dt]&&st===At[++dt]){mt=X.strstart+I;do;while(st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&st===At[++dt]&&dt<mt);X.match_length=I-(mt-dt),X.match_length>X.lookahead&&(X.match_length=X.lookahead)}if(X.match_length>=h?(ht=g._tr_tally(X,1,X.match_length-h),X.lookahead-=X.match_length,X.strstart+=X.match_length,X.match_length=0):(ht=g._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++),ht&&(B(X,!1),X.strm.avail_out===0))return _}return X.insert=0,rt===S?(B(X,!0),X.strm.avail_out===0?lt:J):X.last_lit&&(B(X,!1),X.strm.avail_out===0)?_:V}(A,v):i[A.level].func(A,v);if(K!==lt&&K!==J||(A.status=666),K===_||K===lt)return n.avail_out===0&&(A.last_flush=-1),d;if(K===V&&(v===1?g._tr_align(A):v!==5&&(g._tr_stored_block(A,0,0,!1),v===3&&(pt(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),at(n),n.avail_out===0))return A.last_flush=-1,d}return v!==S?d:A.wrap<=0?1:(A.wrap===2?(O(A,255&n.adler),O(A,n.adler>>8&255),O(A,n.adler>>16&255),O(A,n.adler>>24&255),O(A,255&n.total_in),O(A,n.total_in>>8&255),O(A,n.total_in>>16&255),O(A,n.total_in>>24&255)):(D(A,n.adler>>>16),D(A,65535&n.adler)),at(n),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?d:1)},s.deflateEnd=function(n){var v;return n&&n.state?(v=n.state.status)!==T&&v!==69&&v!==73&&v!==91&&v!==103&&v!==U&&v!==666?ct(n,f):(n.state=null,v===U?ct(n,-3):d):f},s.deflateSetDictionary=function(n,v){var P,A,E,j,Q,K,X,rt,ht=v.length;if(!n||!n.state||(j=(P=n.state).wrap)===2||j===1&&P.status!==T||P.lookahead)return f;for(j===1&&(n.adler=m(n.adler,v,ht,0)),P.wrap=0,ht>=P.w_size&&(j===0&&(pt(P.head),P.strstart=0,P.block_start=0,P.insert=0),rt=new p.Buf8(P.w_size),p.arraySet(rt,v,ht-P.w_size,P.w_size,0),v=rt,ht=P.w_size),Q=n.avail_in,K=n.next_in,X=n.input,n.avail_in=ht,n.next_in=0,n.input=v,G(P);P.lookahead>=h;){for(A=P.strstart,E=P.lookahead-(h-1);P.ins_h=(P.ins_h<<P.hash_shift^P.window[A+h-1])&P.hash_mask,P.prev[A&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=A,A++,--E;);P.strstart=A,P.lookahead=h-1,G(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=h-1,P.match_available=0,n.next_in=K,n.input=X,n.avail_in=Q,P.wrap=j,d},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,s){r.exports=function(i,p){var g,m,C,b,M,S,d,f,c,a,o,R,L,F,u,w,y,l,h,I,k,T,U,_,V;g=i.state,m=i.next_in,_=i.input,C=m+(i.avail_in-5),b=i.next_out,V=i.output,M=b-(p-i.avail_out),S=b+(i.avail_out-257),d=g.dmax,f=g.wsize,c=g.whave,a=g.wnext,o=g.window,R=g.hold,L=g.bits,F=g.lencode,u=g.distcode,w=(1<<g.lenbits)-1,y=(1<<g.distbits)-1;t:do{L<15&&(R+=_[m++]<<L,L+=8,R+=_[m++]<<L,L+=8),l=F[R&w];e:for(;;){if(R>>>=h=l>>>24,L-=h,(h=l>>>16&255)===0)V[b++]=65535&l;else{if(!(16&h)){if(!(64&h)){l=F[(65535&l)+(R&(1<<h)-1)];continue e}if(32&h){g.mode=12;break t}i.msg="invalid literal/length code",g.mode=30;break t}I=65535&l,(h&=15)&&(L<h&&(R+=_[m++]<<L,L+=8),I+=R&(1<<h)-1,R>>>=h,L-=h),L<15&&(R+=_[m++]<<L,L+=8,R+=_[m++]<<L,L+=8),l=u[R&y];r:for(;;){if(R>>>=h=l>>>24,L-=h,!(16&(h=l>>>16&255))){if(!(64&h)){l=u[(65535&l)+(R&(1<<h)-1)];continue r}i.msg="invalid distance code",g.mode=30;break t}if(k=65535&l,L<(h&=15)&&(R+=_[m++]<<L,(L+=8)<h&&(R+=_[m++]<<L,L+=8)),d<(k+=R&(1<<h)-1)){i.msg="invalid distance too far back",g.mode=30;break t}if(R>>>=h,L-=h,(h=b-M)<k){if(c<(h=k-h)&&g.sane){i.msg="invalid distance too far back",g.mode=30;break t}if(U=o,(T=0)===a){if(T+=f-h,h<I){for(I-=h;V[b++]=o[T++],--h;);T=b-k,U=V}}else if(a<h){if(T+=f+a-h,(h-=a)<I){for(I-=h;V[b++]=o[T++],--h;);if(T=0,a<I){for(I-=h=a;V[b++]=o[T++],--h;);T=b-k,U=V}}}else if(T+=a-h,h<I){for(I-=h;V[b++]=o[T++],--h;);T=b-k,U=V}for(;2<I;)V[b++]=U[T++],V[b++]=U[T++],V[b++]=U[T++],I-=3;I&&(V[b++]=U[T++],1<I&&(V[b++]=U[T++]))}else{for(T=b-k;V[b++]=V[T++],V[b++]=V[T++],V[b++]=V[T++],2<(I-=3););I&&(V[b++]=V[T++],1<I&&(V[b++]=V[T++]))}break}}break}}while(m<C&&b<S);m-=I=L>>3,R&=(1<<(L-=I<<3))-1,i.next_in=m,i.next_out=b,i.avail_in=m<C?C-m+5:5-(m-C),i.avail_out=b<S?S-b+257:257-(b-S),g.hold=R,g.bits=L}},{}],49:[function(e,r,s){var i=e("../utils/common"),p=e("./adler32"),g=e("./crc32"),m=e("./inffast"),C=e("./inftrees"),b=1,M=2,S=0,d=-2,f=1,c=852,a=592;function o(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(T){var U;return T&&T.state?(U=T.state,T.total_in=T.total_out=U.total=0,T.msg="",U.wrap&&(T.adler=1&U.wrap),U.mode=f,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new i.Buf32(c),U.distcode=U.distdyn=new i.Buf32(a),U.sane=1,U.back=-1,S):d}function F(T){var U;return T&&T.state?((U=T.state).wsize=0,U.whave=0,U.wnext=0,L(T)):d}function u(T,U){var _,V;return T&&T.state?(V=T.state,U<0?(_=0,U=-U):(_=1+(U>>4),U<48&&(U&=15)),U&&(U<8||15<U)?d:(V.window!==null&&V.wbits!==U&&(V.window=null),V.wrap=_,V.wbits=U,F(T))):d}function w(T,U){var _,V;return T?(V=new R,(T.state=V).window=null,(_=u(T,U))!==S&&(T.state=null),_):d}var y,l,h=!0;function I(T){if(h){var U;for(y=new i.Buf32(512),l=new i.Buf32(32),U=0;U<144;)T.lens[U++]=8;for(;U<256;)T.lens[U++]=9;for(;U<280;)T.lens[U++]=7;for(;U<288;)T.lens[U++]=8;for(C(b,T.lens,0,288,y,0,T.work,{bits:9}),U=0;U<32;)T.lens[U++]=5;C(M,T.lens,0,32,l,0,T.work,{bits:5}),h=!1}T.lencode=y,T.lenbits=9,T.distcode=l,T.distbits=5}function k(T,U,_,V){var lt,J=T.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new i.Buf8(J.wsize)),V>=J.wsize?(i.arraySet(J.window,U,_-J.wsize,J.wsize,0),J.wnext=0,J.whave=J.wsize):(V<(lt=J.wsize-J.wnext)&&(lt=V),i.arraySet(J.window,U,_-V,lt,J.wnext),(V-=lt)?(i.arraySet(J.window,U,_-V,V,0),J.wnext=V,J.whave=J.wsize):(J.wnext+=lt,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=lt))),0}s.inflateReset=F,s.inflateReset2=u,s.inflateResetKeep=L,s.inflateInit=function(T){return w(T,15)},s.inflateInit2=w,s.inflate=function(T,U){var _,V,lt,J,ct,et,pt,at,B,O,D,N,G,H,Z,$,ot,it,Y,W,n,v,P,A,E=0,j=new i.Buf8(4),Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return d;(_=T.state).mode===12&&(_.mode=13),ct=T.next_out,lt=T.output,pt=T.avail_out,J=T.next_in,V=T.input,et=T.avail_in,at=_.hold,B=_.bits,O=et,D=pt,v=S;t:for(;;)switch(_.mode){case f:if(_.wrap===0){_.mode=13;break}for(;B<16;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(2&_.wrap&&at===35615){j[_.check=0]=255&at,j[1]=at>>>8&255,_.check=g(_.check,j,2,0),B=at=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&at)<<8)+(at>>8))%31){T.msg="incorrect header check",_.mode=30;break}if((15&at)!=8){T.msg="unknown compression method",_.mode=30;break}if(B-=4,n=8+(15&(at>>>=4)),_.wbits===0)_.wbits=n;else if(n>_.wbits){T.msg="invalid window size",_.mode=30;break}_.dmax=1<<n,T.adler=_.check=1,_.mode=512&at?10:12,B=at=0;break;case 2:for(;B<16;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(_.flags=at,(255&_.flags)!=8){T.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){T.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=at>>8&1),512&_.flags&&(j[0]=255&at,j[1]=at>>>8&255,_.check=g(_.check,j,2,0)),B=at=0,_.mode=3;case 3:for(;B<32;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.head&&(_.head.time=at),512&_.flags&&(j[0]=255&at,j[1]=at>>>8&255,j[2]=at>>>16&255,j[3]=at>>>24&255,_.check=g(_.check,j,4,0)),B=at=0,_.mode=4;case 4:for(;B<16;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.head&&(_.head.xflags=255&at,_.head.os=at>>8),512&_.flags&&(j[0]=255&at,j[1]=at>>>8&255,_.check=g(_.check,j,2,0)),B=at=0,_.mode=5;case 5:if(1024&_.flags){for(;B<16;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.length=at,_.head&&(_.head.extra_len=at),512&_.flags&&(j[0]=255&at,j[1]=at>>>8&255,_.check=g(_.check,j,2,0)),B=at=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(et<(N=_.length)&&(N=et),N&&(_.head&&(n=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),i.arraySet(_.head.extra,V,J,N,n)),512&_.flags&&(_.check=g(_.check,V,N,J)),et-=N,J+=N,_.length-=N),_.length))break t;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(et===0)break t;for(N=0;n=V[J+N++],_.head&&n&&_.length<65536&&(_.head.name+=String.fromCharCode(n)),n&&N<et;);if(512&_.flags&&(_.check=g(_.check,V,N,J)),et-=N,J+=N,n)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(et===0)break t;for(N=0;n=V[J+N++],_.head&&n&&_.length<65536&&(_.head.comment+=String.fromCharCode(n)),n&&N<et;);if(512&_.flags&&(_.check=g(_.check,V,N,J)),et-=N,J+=N,n)break t}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;B<16;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(at!==(65535&_.check)){T.msg="header crc mismatch",_.mode=30;break}B=at=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),T.adler=_.check=0,_.mode=12;break;case 10:for(;B<32;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}T.adler=_.check=o(at),B=at=0,_.mode=11;case 11:if(_.havedict===0)return T.next_out=ct,T.avail_out=pt,T.next_in=J,T.avail_in=et,_.hold=at,_.bits=B,2;T.adler=_.check=1,_.mode=12;case 12:if(U===5||U===6)break t;case 13:if(_.last){at>>>=7&B,B-=7&B,_.mode=27;break}for(;B<3;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}switch(_.last=1&at,B-=1,3&(at>>>=1)){case 0:_.mode=14;break;case 1:if(I(_),_.mode=20,U!==6)break;at>>>=2,B-=2;break t;case 2:_.mode=17;break;case 3:T.msg="invalid block type",_.mode=30}at>>>=2,B-=2;break;case 14:for(at>>>=7&B,B-=7&B;B<32;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if((65535&at)!=(at>>>16^65535)){T.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&at,B=at=0,_.mode=15,U===6)break t;case 15:_.mode=16;case 16:if(N=_.length){if(et<N&&(N=et),pt<N&&(N=pt),N===0)break t;i.arraySet(lt,V,J,N,ct),et-=N,J+=N,pt-=N,ct+=N,_.length-=N;break}_.mode=12;break;case 17:for(;B<14;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(_.nlen=257+(31&at),at>>>=5,B-=5,_.ndist=1+(31&at),at>>>=5,B-=5,_.ncode=4+(15&at),at>>>=4,B-=4,286<_.nlen||30<_.ndist){T.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;B<3;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.lens[Q[_.have++]]=7&at,at>>>=3,B-=3}for(;_.have<19;)_.lens[Q[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,P={bits:_.lenbits},v=C(0,_.lens,0,19,_.lencode,0,_.work,P),_.lenbits=P.bits,v){T.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;$=(E=_.lencode[at&(1<<_.lenbits)-1])>>>16&255,ot=65535&E,!((Z=E>>>24)<=B);){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(ot<16)at>>>=Z,B-=Z,_.lens[_.have++]=ot;else{if(ot===16){for(A=Z+2;B<A;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(at>>>=Z,B-=Z,_.have===0){T.msg="invalid bit length repeat",_.mode=30;break}n=_.lens[_.have-1],N=3+(3&at),at>>>=2,B-=2}else if(ot===17){for(A=Z+3;B<A;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}B-=Z,n=0,N=3+(7&(at>>>=Z)),at>>>=3,B-=3}else{for(A=Z+7;B<A;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}B-=Z,n=0,N=11+(127&(at>>>=Z)),at>>>=7,B-=7}if(_.have+N>_.nlen+_.ndist){T.msg="invalid bit length repeat",_.mode=30;break}for(;N--;)_.lens[_.have++]=n}}if(_.mode===30)break;if(_.lens[256]===0){T.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,P={bits:_.lenbits},v=C(b,_.lens,0,_.nlen,_.lencode,0,_.work,P),_.lenbits=P.bits,v){T.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,P={bits:_.distbits},v=C(M,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,P),_.distbits=P.bits,v){T.msg="invalid distances set",_.mode=30;break}if(_.mode=20,U===6)break t;case 20:_.mode=21;case 21:if(6<=et&&258<=pt){T.next_out=ct,T.avail_out=pt,T.next_in=J,T.avail_in=et,_.hold=at,_.bits=B,m(T,D),ct=T.next_out,lt=T.output,pt=T.avail_out,J=T.next_in,V=T.input,et=T.avail_in,at=_.hold,B=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;$=(E=_.lencode[at&(1<<_.lenbits)-1])>>>16&255,ot=65535&E,!((Z=E>>>24)<=B);){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if($&&!(240&$)){for(it=Z,Y=$,W=ot;$=(E=_.lencode[W+((at&(1<<it+Y)-1)>>it)])>>>16&255,ot=65535&E,!(it+(Z=E>>>24)<=B);){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}at>>>=it,B-=it,_.back+=it}if(at>>>=Z,B-=Z,_.back+=Z,_.length=ot,$===0){_.mode=26;break}if(32&$){_.back=-1,_.mode=12;break}if(64&$){T.msg="invalid literal/length code",_.mode=30;break}_.extra=15&$,_.mode=22;case 22:if(_.extra){for(A=_.extra;B<A;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.length+=at&(1<<_.extra)-1,at>>>=_.extra,B-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;$=(E=_.distcode[at&(1<<_.distbits)-1])>>>16&255,ot=65535&E,!((Z=E>>>24)<=B);){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(!(240&$)){for(it=Z,Y=$,W=ot;$=(E=_.distcode[W+((at&(1<<it+Y)-1)>>it)])>>>16&255,ot=65535&E,!(it+(Z=E>>>24)<=B);){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}at>>>=it,B-=it,_.back+=it}if(at>>>=Z,B-=Z,_.back+=Z,64&$){T.msg="invalid distance code",_.mode=30;break}_.offset=ot,_.extra=15&$,_.mode=24;case 24:if(_.extra){for(A=_.extra;B<A;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}_.offset+=at&(1<<_.extra)-1,at>>>=_.extra,B-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){T.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(pt===0)break t;if(N=D-pt,_.offset>N){if((N=_.offset-N)>_.whave&&_.sane){T.msg="invalid distance too far back",_.mode=30;break}G=N>_.wnext?(N-=_.wnext,_.wsize-N):_.wnext-N,N>_.length&&(N=_.length),H=_.window}else H=lt,G=ct-_.offset,N=_.length;for(pt<N&&(N=pt),pt-=N,_.length-=N;lt[ct++]=H[G++],--N;);_.length===0&&(_.mode=21);break;case 26:if(pt===0)break t;lt[ct++]=_.length,pt--,_.mode=21;break;case 27:if(_.wrap){for(;B<32;){if(et===0)break t;et--,at|=V[J++]<<B,B+=8}if(D-=pt,T.total_out+=D,_.total+=D,D&&(T.adler=_.check=_.flags?g(_.check,lt,D,ct-D):p(_.check,lt,D,ct-D)),D=pt,(_.flags?at:o(at))!==_.check){T.msg="incorrect data check",_.mode=30;break}B=at=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;B<32;){if(et===0)break t;et--,at+=V[J++]<<B,B+=8}if(at!==(4294967295&_.total)){T.msg="incorrect length check",_.mode=30;break}B=at=0}_.mode=29;case 29:v=1;break t;case 30:v=-3;break t;case 31:return-4;case 32:default:return d}return T.next_out=ct,T.avail_out=pt,T.next_in=J,T.avail_in=et,_.hold=at,_.bits=B,(_.wsize||D!==T.avail_out&&_.mode<30&&(_.mode<27||U!==4))&&k(T,T.output,T.next_out,D-T.avail_out)?(_.mode=31,-4):(O-=T.avail_in,D-=T.avail_out,T.total_in+=O,T.total_out+=D,_.total+=D,_.wrap&&D&&(T.adler=_.check=_.flags?g(_.check,lt,D,T.next_out-D):p(_.check,lt,D,T.next_out-D)),T.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(O==0&&D===0||U===4)&&v===S&&(v=-5),v)},s.inflateEnd=function(T){if(!T||!T.state)return d;var U=T.state;return U.window&&(U.window=null),T.state=null,S},s.inflateGetHeader=function(T,U){var _;return T&&T.state&&2&(_=T.state).wrap?((_.head=U).done=!1,S):d},s.inflateSetDictionary=function(T,U){var _,V=U.length;return T&&T.state?(_=T.state).wrap!==0&&_.mode!==11?d:_.mode===11&&p(1,U,V,0)!==_.check?-3:k(T,U,V,V)?(_.mode=31,-4):(_.havedict=1,S):d},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,s){var i=e("../utils/common"),p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],C=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(b,M,S,d,f,c,a,o){var R,L,F,u,w,y,l,h,I,k=o.bits,T=0,U=0,_=0,V=0,lt=0,J=0,ct=0,et=0,pt=0,at=0,B=null,O=0,D=new i.Buf16(16),N=new i.Buf16(16),G=null,H=0;for(T=0;T<=15;T++)D[T]=0;for(U=0;U<d;U++)D[M[S+U]]++;for(lt=k,V=15;1<=V&&D[V]===0;V--);if(V<lt&&(lt=V),V===0)return f[c++]=20971520,f[c++]=20971520,o.bits=1,0;for(_=1;_<V&&D[_]===0;_++);for(lt<_&&(lt=_),T=et=1;T<=15;T++)if(et<<=1,(et-=D[T])<0)return-1;if(0<et&&(b===0||V!==1))return-1;for(N[1]=0,T=1;T<15;T++)N[T+1]=N[T]+D[T];for(U=0;U<d;U++)M[S+U]!==0&&(a[N[M[S+U]]++]=U);if(y=b===0?(B=G=a,19):b===1?(B=p,O-=257,G=g,H-=257,256):(B=m,G=C,-1),T=_,w=c,ct=U=at=0,F=-1,u=(pt=1<<(J=lt))-1,b===1&&852<pt||b===2&&592<pt)return 1;for(;;){for(l=T-ct,I=a[U]<y?(h=0,a[U]):a[U]>y?(h=G[H+a[U]],B[O+a[U]]):(h=96,0),R=1<<T-ct,_=L=1<<J;f[w+(at>>ct)+(L-=R)]=l<<24|h<<16|I|0,L!==0;);for(R=1<<T-1;at&R;)R>>=1;if(R!==0?(at&=R-1,at+=R):at=0,U++,--D[T]==0){if(T===V)break;T=M[S+a[U]]}if(lt<T&&(at&u)!==F){for(ct===0&&(ct=lt),w+=_,et=1<<(J=T-ct);J+ct<V&&!((et-=D[J+ct])<=0);)J++,et<<=1;if(pt+=1<<J,b===1&&852<pt||b===2&&592<pt)return 1;f[F=at&u]=lt<<24|J<<16|w-c|0}}return at!==0&&(f[w+at]=T-ct<<24|64<<16|0),o.bits=lt,0}},{"../utils/common":41}],51:[function(e,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,s){var i=e("../utils/common"),p=0,g=1;function m(E){for(var j=E.length;0<=--j;)E[j]=0}var C=0,b=29,M=256,S=M+1+b,d=30,f=19,c=2*S+1,a=15,o=16,R=7,L=256,F=16,u=17,w=18,y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(2*(S+2));m(k);var T=new Array(2*d);m(T);var U=new Array(512);m(U);var _=new Array(256);m(_);var V=new Array(b);m(V);var lt,J,ct,et=new Array(d);function pt(E,j,Q,K,X){this.static_tree=E,this.extra_bits=j,this.extra_base=Q,this.elems=K,this.max_length=X,this.has_stree=E&&E.length}function at(E,j){this.dyn_tree=E,this.max_code=0,this.stat_desc=j}function B(E){return E<256?U[E]:U[256+(E>>>7)]}function O(E,j){E.pending_buf[E.pending++]=255&j,E.pending_buf[E.pending++]=j>>>8&255}function D(E,j,Q){E.bi_valid>o-Q?(E.bi_buf|=j<<E.bi_valid&65535,O(E,E.bi_buf),E.bi_buf=j>>o-E.bi_valid,E.bi_valid+=Q-o):(E.bi_buf|=j<<E.bi_valid&65535,E.bi_valid+=Q)}function N(E,j,Q){D(E,Q[2*j],Q[2*j+1])}function G(E,j){for(var Q=0;Q|=1&E,E>>>=1,Q<<=1,0<--j;);return Q>>>1}function H(E,j,Q){var K,X,rt=new Array(a+1),ht=0;for(K=1;K<=a;K++)rt[K]=ht=ht+Q[K-1]<<1;for(X=0;X<=j;X++){var st=E[2*X+1];st!==0&&(E[2*X]=G(rt[st]++,st))}}function Z(E){var j;for(j=0;j<S;j++)E.dyn_ltree[2*j]=0;for(j=0;j<d;j++)E.dyn_dtree[2*j]=0;for(j=0;j<f;j++)E.bl_tree[2*j]=0;E.dyn_ltree[2*L]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function $(E){8<E.bi_valid?O(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function ot(E,j,Q,K){var X=2*j,rt=2*Q;return E[X]<E[rt]||E[X]===E[rt]&&K[j]<=K[Q]}function it(E,j,Q){for(var K=E.heap[Q],X=Q<<1;X<=E.heap_len&&(X<E.heap_len&&ot(j,E.heap[X+1],E.heap[X],E.depth)&&X++,!ot(j,K,E.heap[X],E.depth));)E.heap[Q]=E.heap[X],Q=X,X<<=1;E.heap[Q]=K}function Y(E,j,Q){var K,X,rt,ht,st=0;if(E.last_lit!==0)for(;K=E.pending_buf[E.d_buf+2*st]<<8|E.pending_buf[E.d_buf+2*st+1],X=E.pending_buf[E.l_buf+st],st++,K===0?N(E,X,j):(N(E,(rt=_[X])+M+1,j),(ht=y[rt])!==0&&D(E,X-=V[rt],ht),N(E,rt=B(--K),Q),(ht=l[rt])!==0&&D(E,K-=et[rt],ht)),st<E.last_lit;);N(E,L,j)}function W(E,j){var Q,K,X,rt=j.dyn_tree,ht=j.stat_desc.static_tree,st=j.stat_desc.has_stree,dt=j.stat_desc.elems,mt=-1;for(E.heap_len=0,E.heap_max=c,Q=0;Q<dt;Q++)rt[2*Q]!==0?(E.heap[++E.heap_len]=mt=Q,E.depth[Q]=0):rt[2*Q+1]=0;for(;E.heap_len<2;)rt[2*(X=E.heap[++E.heap_len]=mt<2?++mt:0)]=1,E.depth[X]=0,E.opt_len--,st&&(E.static_len-=ht[2*X+1]);for(j.max_code=mt,Q=E.heap_len>>1;1<=Q;Q--)it(E,rt,Q);for(X=dt;Q=E.heap[1],E.heap[1]=E.heap[E.heap_len--],it(E,rt,1),K=E.heap[1],E.heap[--E.heap_max]=Q,E.heap[--E.heap_max]=K,rt[2*X]=rt[2*Q]+rt[2*K],E.depth[X]=(E.depth[Q]>=E.depth[K]?E.depth[Q]:E.depth[K])+1,rt[2*Q+1]=rt[2*K+1]=X,E.heap[1]=X++,it(E,rt,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(At,yt){var wt,q,nt,tt,_t,Et,ut=yt.dyn_tree,bt=yt.max_code,St=yt.stat_desc.static_tree,kt=yt.stat_desc.has_stree,Rt=yt.stat_desc.extra_bits,Tt=yt.stat_desc.extra_base,xt=yt.stat_desc.max_length,Ct=0;for(tt=0;tt<=a;tt++)At.bl_count[tt]=0;for(ut[2*At.heap[At.heap_max]+1]=0,wt=At.heap_max+1;wt<c;wt++)xt<(tt=ut[2*ut[2*(q=At.heap[wt])+1]+1]+1)&&(tt=xt,Ct++),ut[2*q+1]=tt,bt<q||(At.bl_count[tt]++,_t=0,Tt<=q&&(_t=Rt[q-Tt]),Et=ut[2*q],At.opt_len+=Et*(tt+_t),kt&&(At.static_len+=Et*(St[2*q+1]+_t)));if(Ct!==0){do{for(tt=xt-1;At.bl_count[tt]===0;)tt--;At.bl_count[tt]--,At.bl_count[tt+1]+=2,At.bl_count[xt]--,Ct-=2}while(0<Ct);for(tt=xt;tt!==0;tt--)for(q=At.bl_count[tt];q!==0;)bt<(nt=At.heap[--wt])||(ut[2*nt+1]!==tt&&(At.opt_len+=(tt-ut[2*nt+1])*ut[2*nt],ut[2*nt+1]=tt),q--)}}(E,j),H(rt,mt,E.bl_count)}function n(E,j,Q){var K,X,rt=-1,ht=j[1],st=0,dt=7,mt=4;for(ht===0&&(dt=138,mt=3),j[2*(Q+1)+1]=65535,K=0;K<=Q;K++)X=ht,ht=j[2*(K+1)+1],++st<dt&&X===ht||(st<mt?E.bl_tree[2*X]+=st:X!==0?(X!==rt&&E.bl_tree[2*X]++,E.bl_tree[2*F]++):st<=10?E.bl_tree[2*u]++:E.bl_tree[2*w]++,rt=X,mt=(st=0)===ht?(dt=138,3):X===ht?(dt=6,3):(dt=7,4))}function v(E,j,Q){var K,X,rt=-1,ht=j[1],st=0,dt=7,mt=4;for(ht===0&&(dt=138,mt=3),K=0;K<=Q;K++)if(X=ht,ht=j[2*(K+1)+1],!(++st<dt&&X===ht)){if(st<mt)for(;N(E,X,E.bl_tree),--st!=0;);else X!==0?(X!==rt&&(N(E,X,E.bl_tree),st--),N(E,F,E.bl_tree),D(E,st-3,2)):st<=10?(N(E,u,E.bl_tree),D(E,st-3,3)):(N(E,w,E.bl_tree),D(E,st-11,7));rt=X,mt=(st=0)===ht?(dt=138,3):X===ht?(dt=6,3):(dt=7,4)}}m(et);var P=!1;function A(E,j,Q,K){D(E,(C<<1)+(K?1:0),3),function(X,rt,ht,st){$(X),st&&(O(X,ht),O(X,~ht)),i.arraySet(X.pending_buf,X.window,rt,ht,X.pending),X.pending+=ht}(E,j,Q,!0)}s._tr_init=function(E){P||(function(){var j,Q,K,X,rt,ht=new Array(a+1);for(X=K=0;X<b-1;X++)for(V[X]=K,j=0;j<1<<y[X];j++)_[K++]=X;for(_[K-1]=X,X=rt=0;X<16;X++)for(et[X]=rt,j=0;j<1<<l[X];j++)U[rt++]=X;for(rt>>=7;X<d;X++)for(et[X]=rt<<7,j=0;j<1<<l[X]-7;j++)U[256+rt++]=X;for(Q=0;Q<=a;Q++)ht[Q]=0;for(j=0;j<=143;)k[2*j+1]=8,j++,ht[8]++;for(;j<=255;)k[2*j+1]=9,j++,ht[9]++;for(;j<=279;)k[2*j+1]=7,j++,ht[7]++;for(;j<=287;)k[2*j+1]=8,j++,ht[8]++;for(H(k,S+1,ht),j=0;j<d;j++)T[2*j+1]=5,T[2*j]=G(j,5);lt=new pt(k,y,M+1,S,a),J=new pt(T,l,0,d,a),ct=new pt(new Array(0),h,0,f,R)}(),P=!0),E.l_desc=new at(E.dyn_ltree,lt),E.d_desc=new at(E.dyn_dtree,J),E.bl_desc=new at(E.bl_tree,ct),E.bi_buf=0,E.bi_valid=0,Z(E)},s._tr_stored_block=A,s._tr_flush_block=function(E,j,Q,K){var X,rt,ht=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(st){var dt,mt=4093624447;for(dt=0;dt<=31;dt++,mt>>>=1)if(1&mt&&st.dyn_ltree[2*dt]!==0)return p;if(st.dyn_ltree[18]!==0||st.dyn_ltree[20]!==0||st.dyn_ltree[26]!==0)return g;for(dt=32;dt<M;dt++)if(st.dyn_ltree[2*dt]!==0)return g;return p}(E)),W(E,E.l_desc),W(E,E.d_desc),ht=function(st){var dt;for(n(st,st.dyn_ltree,st.l_desc.max_code),n(st,st.dyn_dtree,st.d_desc.max_code),W(st,st.bl_desc),dt=f-1;3<=dt&&st.bl_tree[2*I[dt]+1]===0;dt--);return st.opt_len+=3*(dt+1)+5+5+4,dt}(E),X=E.opt_len+3+7>>>3,(rt=E.static_len+3+7>>>3)<=X&&(X=rt)):X=rt=Q+5,Q+4<=X&&j!==-1?A(E,j,Q,K):E.strategy===4||rt===X?(D(E,2+(K?1:0),3),Y(E,k,T)):(D(E,4+(K?1:0),3),function(st,dt,mt,At){var yt;for(D(st,dt-257,5),D(st,mt-1,5),D(st,At-4,4),yt=0;yt<At;yt++)D(st,st.bl_tree[2*I[yt]+1],3);v(st,st.dyn_ltree,dt-1),v(st,st.dyn_dtree,mt-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,ht+1),Y(E,E.dyn_ltree,E.dyn_dtree)),Z(E),K&&$(E)},s._tr_tally=function(E,j,Q){return E.pending_buf[E.d_buf+2*E.last_lit]=j>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&j,E.pending_buf[E.l_buf+E.last_lit]=255&Q,E.last_lit++,j===0?E.dyn_ltree[2*Q]++:(E.matches++,j--,E.dyn_ltree[2*(_[Q]+M+1)]++,E.dyn_dtree[2*B(j)]++),E.last_lit===E.lit_bufsize-1},s._tr_align=function(E){D(E,2,3),N(E,L,k),function(j){j.bi_valid===16?(O(j,j.bi_buf),j.bi_buf=0,j.bi_valid=0):8<=j.bi_valid&&(j.pending_buf[j.pending++]=255&j.bi_buf,j.bi_buf>>=8,j.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(e,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,s){(function(i){(function(p,g){if(!p.setImmediate){var m,C,b,M,S=1,d={},f=!1,c=p.document,a=Object.getPrototypeOf&&Object.getPrototypeOf(p);a=a&&a.setTimeout?a:p,m={}.toString.call(p.process)==="[object process]"?function(F){process.nextTick(function(){R(F)})}:function(){if(p.postMessage&&!p.importScripts){var F=!0,u=p.onmessage;return p.onmessage=function(){F=!1},p.postMessage("","*"),p.onmessage=u,F}}()?(M="setImmediate$"+Math.random()+"$",p.addEventListener?p.addEventListener("message",L,!1):p.attachEvent("onmessage",L),function(F){p.postMessage(M+F,"*")}):p.MessageChannel?((b=new MessageChannel).port1.onmessage=function(F){R(F.data)},function(F){b.port2.postMessage(F)}):c&&"onreadystatechange"in c.createElement("script")?(C=c.documentElement,function(F){var u=c.createElement("script");u.onreadystatechange=function(){R(F),u.onreadystatechange=null,C.removeChild(u),u=null},C.appendChild(u)}):function(F){setTimeout(R,0,F)},a.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var u=new Array(arguments.length-1),w=0;w<u.length;w++)u[w]=arguments[w+1];var y={callback:F,args:u};return d[S]=y,m(S),S++},a.clearImmediate=o}function o(F){delete d[F]}function R(F){if(f)setTimeout(R,0,F);else{var u=d[F];if(u){f=!0;try{(function(w){var y=w.callback,l=w.args;switch(l.length){case 0:y();break;case 1:y(l[0]);break;case 2:y(l[0],l[1]);break;case 3:y(l[0],l[1],l[2]);break;default:y.apply(g,l)}})(u)}finally{o(F),f=!1}}}}function L(F){F.source===p&&typeof F.data=="string"&&F.data.indexOf(M)===0&&R(+F.data.slice(M.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(jszip_min);var jszip_minExports=jszip_min.exports;const JSZip=getDefaultExportFromCjs(jszip_minExports);var RelationshipTypes;(function(x){x.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",x.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",x.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",x.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",x.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",x.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",x.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",x.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",x.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",x.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",x.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",x.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",x.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",x.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",x.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",x.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",x.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",x.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",x.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended"})(RelationshipTypes||(RelationshipTypes={}));function parseRelationships(x,t){return t.elements(x).map(e=>({id:t.attr(e,"Id"),type:t.attr(e,"Type"),target:t.attr(e,"Target"),targetMode:t.attr(e,"TargetMode")}))}const ns$1={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",drawingml:"http://schemas.openxmlformats.org/drawingml/2006/main",picture:"http://schemas.openxmlformats.org/drawingml/2006/picture",compatibility:"http://schemas.openxmlformats.org/markup-compatibility/2006",math:"http://schemas.openxmlformats.org/officeDocument/2006/math"},LengthUsage={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt"},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"},LineHeight:{mul:1/240,unit:""},VmlEmu:{mul:1/12700,unit:""}};function convertLength(x,t=LengthUsage.Dxa){return x==null||/.+(p[xt]|[%])$/.test(x)?x:`${(parseInt(x)*t.mul).toFixed(2)}${t.unit}`}function convertBoolean(x,t=!1){switch(x){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return t}}function parseCommonProperty(x,t,e){if(x.namespaceURI!=ns$1.wordml)return!1;switch(x.localName){case"color":t.color=e.attr(x,"val");break;case"sz":t.fontSize=e.lengthAttr(x,"val",LengthUsage.FontSize);break;default:return!1}return!0}function parseXmlString(x,t=!1){t&&(x=x.replace(/<[?].*[?]>/,"")),x=removeUTF8BOM(x);const e=new DOMParser().parseFromString(x,"application/xml"),r=hasXmlParserError(e);if(r)throw new Error(r);return e}function hasXmlParserError(x){var t;return(t=x.getElementsByTagName("parsererror")[0])==null?void 0:t.textContent}function removeUTF8BOM(x){return x.charCodeAt(0)===65279?x.substring(1):x}function serializeXmlString(x){return new XMLSerializer().serializeToString(x)}class XmlParser{elements(t,e=null){const r=[];for(let s=0,i=t.childNodes.length;s<i;s++){let p=t.childNodes.item(s);p.nodeType==1&&(e==null||p.localName==e)&&r.push(p)}return r}element(t,e){for(let r=0,s=t.childNodes.length;r<s;r++){let i=t.childNodes.item(r);if(i.nodeType==1&&i.localName==e)return i}return null}elementAttr(t,e,r){var s=this.element(t,e);return s?this.attr(s,r):void 0}attrs(t){return Array.from(t.attributes)}attr(t,e){for(let r=0,s=t.attributes.length;r<s;r++){let i=t.attributes.item(r);if(i.localName==e)return i.value}return null}intAttr(t,e,r=null){var s=this.attr(t,e);return s?parseInt(s):r}hexAttr(t,e,r=null){var s=this.attr(t,e);return s?parseInt(s,16):r}floatAttr(t,e,r=null){var s=this.attr(t,e);return s?parseFloat(s):r}boolAttr(t,e,r=null){return convertBoolean(this.attr(t,e),r)}lengthAttr(t,e,r=LengthUsage.Dxa){return convertLength(this.attr(t,e),r)}}const globalXmlParser=new XmlParser;class Part{constructor(t,e){this._package=t,this.path=e}async load(){this.rels=await this._package.loadRelationships(this.path);const t=await this._package.load(this.path),e=this._package.parseXmlDocument(t);this._package.options.keepOrigin&&(this._xmlDocument=e),this.parseXml(e.firstElementChild)}save(){this._package.update(this.path,serializeXmlString(this._xmlDocument))}parseXml(t){}}const embedFontTypeMap={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function parseFonts(x,t){return t.elements(x).map(e=>parseFont(e,t))}function parseFont(x,t){let e={name:t.attr(x,"name"),embedFontRefs:[]};for(let r of t.elements(x))switch(r.localName){case"family":e.family=t.attr(r,"val");break;case"altName":e.altName=t.attr(r,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":e.embedFontRefs.push(parseEmbedFontRef(r,t));break}return e}function parseEmbedFontRef(x,t){return{id:t.attr(x,"id"),key:t.attr(x,"fontKey"),type:embedFontTypeMap[x.localName]}}class FontTablePart extends Part{parseXml(t){this.fonts=parseFonts(t,this._package.xmlParser)}}function escapeClassName(x){return x==null?void 0:x.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function encloseFontFamily(x){return/^[^"'].*\s.*[^"']$/.test(x)?`'${x}'`:x}function splitPath(x){let t=x.lastIndexOf("/")+1,e=t==0?"":x.substring(0,t),r=t==0?x:x.substring(t);return[e,r]}function resolvePath(x,t){try{const e="http://docx/";return new URL(x,e+t).toString().substring(e.length)}catch{return`${t}${x}`}}function keyBy(x,t){return x.reduce((e,r)=>(e[t(r)]=r,e),{})}function blobToBase64(x){return new Promise((t,e)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=()=>e(),r.readAsDataURL(x)})}function isObject(x){return x&&typeof x=="object"&&!Array.isArray(x)}function isString(x){return typeof x=="string"||x instanceof String}function mergeDeep(x,...t){if(!t.length)return x;const e=t.shift();if(isObject(x)&&isObject(e))for(const r in e)if(isObject(e[r])){const s=x[r]??(x[r]={});mergeDeep(s,e[r])}else x[r]=e[r];return mergeDeep(x,...t)}function asArray(x){return Array.isArray(x)?x:[x]}class OpenXmlPackage{constructor(t,e){this._zip=t,this.options=e,this.xmlParser=new XmlParser}get(t){const e=normalizePath(t);return this._zip.files[e]??this._zip.files[e.replace(/\//g,"\\")]}update(t,e){this._zip.file(t,e)}static async load(t,e){const r=await JSZip.loadAsync(t);return new OpenXmlPackage(r,e)}save(t="blob"){return this._zip.generateAsync({type:t})}load(t,e="string"){var r;return((r=this.get(t))==null?void 0:r.async(e))??Promise.resolve(null)}async loadRelationships(t=null){let e="_rels/.rels";if(t!=null){const[s,i]=splitPath(t);e=`${s}_rels/${i}.rels`}const r=await this.load(e);return r?parseRelationships(this.parseXmlDocument(r).firstElementChild,this.xmlParser):null}parseXmlDocument(t){return parseXmlString(t,this.options.trimXmlDeclaration)}}function normalizePath(x){return x.startsWith("/")?x.substr(1):x}class DocumentPart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.body=this._documentParser.parseDocumentFile(t)}}function parseBorder(x,t){return{type:t.attr(x,"val"),color:t.attr(x,"color"),size:t.lengthAttr(x,"sz",LengthUsage.Border),offset:t.lengthAttr(x,"space",LengthUsage.Point),frame:t.boolAttr(x,"frame"),shadow:t.boolAttr(x,"shadow")}}function parseBorders(x,t){var e={};for(let r of t.elements(x))switch(r.localName){case"left":e.left=parseBorder(r,t);break;case"top":e.top=parseBorder(r,t);break;case"right":e.right=parseBorder(r,t);break;case"bottom":e.bottom=parseBorder(r,t);break}return e}var SectionType;(function(x){x.Continuous="continuous",x.NextPage="nextPage",x.NextColumn="nextColumn",x.EvenPage="evenPage",x.OddPage="oddPage"})(SectionType||(SectionType={}));function parseSectionProperties(x,t=globalXmlParser){var e={};for(let r of t.elements(x))switch(r.localName){case"pgSz":e.pageSize={width:t.lengthAttr(r,"w"),height:t.lengthAttr(r,"h"),orientation:t.attr(r,"orient")};break;case"type":e.type=t.attr(r,"val");break;case"pgMar":e.pageMargins={left:t.lengthAttr(r,"left"),right:t.lengthAttr(r,"right"),top:t.lengthAttr(r,"top"),bottom:t.lengthAttr(r,"bottom"),header:t.lengthAttr(r,"header"),footer:t.lengthAttr(r,"footer"),gutter:t.lengthAttr(r,"gutter")};break;case"cols":e.columns=parseColumns(r,t);break;case"headerReference":(e.headerRefs??(e.headerRefs=[])).push(parseFooterHeaderReference(r,t));break;case"footerReference":(e.footerRefs??(e.footerRefs=[])).push(parseFooterHeaderReference(r,t));break;case"titlePg":e.titlePage=t.boolAttr(r,"val",!0);break;case"pgBorders":e.pageBorders=parseBorders(r,t);break;case"pgNumType":e.pageNumber=parsePageNumber(r,t);break}return e}function parseColumns(x,t){return{numberOfColumns:t.intAttr(x,"num"),space:t.lengthAttr(x,"space"),separator:t.boolAttr(x,"sep"),equalWidth:t.boolAttr(x,"equalWidth",!0),columns:t.elements(x,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function parsePageNumber(x,t){return{chapSep:t.attr(x,"chapSep"),chapStyle:t.attr(x,"chapStyle"),format:t.attr(x,"fmt"),start:t.intAttr(x,"start")}}function parseFooterHeaderReference(x,t){return{id:t.attr(x,"id"),type:t.attr(x,"type")}}function parseLineSpacing(x,t){return{before:t.lengthAttr(x,"before"),after:t.lengthAttr(x,"after"),line:t.intAttr(x,"line"),lineRule:t.attr(x,"lineRule")}}function parseRunProperties(x,t){let e={};for(let r of t.elements(x))parseRunProperty(r,e,t);return e}function parseRunProperty(x,t,e){return!!parseCommonProperty(x,t,e)}function parseParagraphProperties(x,t){let e={};for(let r of t.elements(x))parseParagraphProperty(r,e,t);return e}function parseParagraphProperty(x,t,e){if(x.namespaceURI!=ns$1.wordml)return!1;if(parseCommonProperty(x,t,e))return!0;switch(x.localName){case"tabs":t.tabs=parseTabs(x,e);break;case"sectPr":t.sectionProps=parseSectionProperties(x,e);break;case"numPr":t.numbering=parseNumbering$1(x,e);break;case"spacing":return t.lineSpacing=parseLineSpacing(x,e),!1;case"textAlignment":return t.textAlignment=e.attr(x,"val"),!1;case"keepLines":t.keepLines=e.boolAttr(x,"val",!0);break;case"keepNext":t.keepNext=e.boolAttr(x,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=e.boolAttr(x,"val",!0);break;case"outlineLvl":t.outlineLevel=e.intAttr(x,"val");break;case"pStyle":t.styleName=e.attr(x,"val");break;case"rPr":t.runProps=parseRunProperties(x,e);break;default:return!1}return!0}function parseTabs(x,t){return t.elements(x,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}function parseNumbering$1(x,t){var e={};for(let r of t.elements(x))switch(r.localName){case"numId":e.id=t.attr(r,"val");break;case"ilvl":e.level=t.intAttr(r,"val");break}return e}function parseNumberingPart(x,t){let e={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let r of t.elements(x))switch(r.localName){case"num":e.numberings.push(parseNumbering(r,t));break;case"abstractNum":e.abstractNumberings.push(parseAbstractNumbering(r,t));break;case"numPicBullet":e.bulletPictures.push(parseNumberingBulletPicture(r,t));break}return e}function parseNumbering(x,t){let e={id:t.attr(x,"numId"),overrides:[]};for(let r of t.elements(x))switch(r.localName){case"abstractNumId":e.abstractId=t.attr(r,"val");break;case"lvlOverride":e.overrides.push(parseNumberingLevelOverrride(r,t));break}return e}function parseAbstractNumbering(x,t){let e={id:t.attr(x,"abstractNumId"),levels:[]};for(let r of t.elements(x))switch(r.localName){case"name":e.name=t.attr(r,"val");break;case"multiLevelType":e.multiLevelType=t.attr(r,"val");break;case"numStyleLink":e.numberingStyleLink=t.attr(r,"val");break;case"styleLink":e.styleLink=t.attr(r,"val");break;case"lvl":e.levels.push(parseNumberingLevel(r,t));break}return e}function parseNumberingLevel(x,t){let e={level:t.intAttr(x,"ilvl")};for(let r of t.elements(x))switch(r.localName){case"start":e.start=t.attr(r,"val");break;case"lvlRestart":e.restart=t.intAttr(r,"val");break;case"numFmt":e.format=t.attr(r,"val");break;case"lvlText":e.text=t.attr(r,"val");break;case"lvlJc":e.justification=t.attr(r,"val");break;case"lvlPicBulletId":e.bulletPictureId=t.attr(r,"val");break;case"pStyle":e.paragraphStyle=t.attr(r,"val");break;case"pPr":e.paragraphProps=parseParagraphProperties(r,t);break;case"rPr":e.runProps=parseRunProperties(r,t);break}return e}function parseNumberingLevelOverrride(x,t){let e={level:t.intAttr(x,"ilvl")};for(let r of t.elements(x))switch(r.localName){case"startOverride":e.start=t.intAttr(r,"val");break;case"lvl":e.numberingLevel=parseNumberingLevel(r,t);break}return e}function parseNumberingBulletPicture(x,t){var e=t.element(x,"pict"),r=e&&t.element(e,"shape"),s=r&&t.element(r,"imagedata");return s?{id:t.attr(x,"numPicBulletId"),referenceId:t.attr(s,"id"),style:t.attr(r,"style")}:null}class NumberingPart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){Object.assign(this,parseNumberingPart(t,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(t)}}class StylesPart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.styles=this._documentParser.parseStylesFile(t)}}var DomType;(function(x){x.Document="document",x.Paragraph="paragraph",x.Run="run",x.Break="break",x.NoBreakHyphen="noBreakHyphen",x.Table="table",x.Row="row",x.Cell="cell",x.Hyperlink="hyperlink",x.SmartTag="smartTag",x.Drawing="drawing",x.Image="image",x.Text="text",x.Tab="tab",x.Symbol="symbol",x.BookmarkStart="bookmarkStart",x.BookmarkEnd="bookmarkEnd",x.Footer="footer",x.Header="header",x.FootnoteReference="footnoteReference",x.EndnoteReference="endnoteReference",x.Footnote="footnote",x.Endnote="endnote",x.SimpleField="simpleField",x.ComplexField="complexField",x.Instruction="instruction",x.VmlPicture="vmlPicture",x.MmlMath="mmlMath",x.MmlMathParagraph="mmlMathParagraph",x.MmlFraction="mmlFraction",x.MmlFunction="mmlFunction",x.MmlFunctionName="mmlFunctionName",x.MmlNumerator="mmlNumerator",x.MmlDenominator="mmlDenominator",x.MmlRadical="mmlRadical",x.MmlBase="mmlBase",x.MmlDegree="mmlDegree",x.MmlSuperscript="mmlSuperscript",x.MmlSubscript="mmlSubscript",x.MmlPreSubSuper="mmlPreSubSuper",x.MmlSubArgument="mmlSubArgument",x.MmlSuperArgument="mmlSuperArgument",x.MmlNary="mmlNary",x.MmlDelimiter="mmlDelimiter",x.MmlRun="mmlRun",x.MmlEquationArray="mmlEquationArray",x.MmlLimit="mmlLimit",x.MmlLimitLower="mmlLimitLower",x.MmlMatrix="mmlMatrix",x.MmlMatrixRow="mmlMatrixRow",x.MmlBox="mmlBox",x.MmlBar="mmlBar",x.MmlGroupChar="mmlGroupChar",x.VmlElement="vmlElement",x.Inserted="inserted",x.Deleted="deleted",x.DeletedText="deletedText",x.Comment="comment",x.CommentReference="commentReference",x.CommentRangeStart="commentRangeStart",x.CommentRangeEnd="commentRangeEnd"})(DomType||(DomType={}));class OpenXmlElementBase{constructor(){this.children=[],this.cssStyle={}}}class WmlHeader extends OpenXmlElementBase{constructor(){super(...arguments),this.type=DomType.Header}}class WmlFooter extends OpenXmlElementBase{constructor(){super(...arguments),this.type=DomType.Footer}}class BaseHeaderFooterPart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(t)}}class HeaderPart extends BaseHeaderFooterPart{createRootElement(){return new WmlHeader}}class FooterPart extends BaseHeaderFooterPart{createRootElement(){return new WmlFooter}}function parseExtendedProps(x,t){const e={};for(let r of t.elements(x))switch(r.localName){case"Template":e.template=r.textContent;break;case"Pages":e.pages=safeParseToInt(r.textContent);break;case"Words":e.words=safeParseToInt(r.textContent);break;case"Characters":e.characters=safeParseToInt(r.textContent);break;case"Application":e.application=r.textContent;break;case"Lines":e.lines=safeParseToInt(r.textContent);break;case"Paragraphs":e.paragraphs=safeParseToInt(r.textContent);break;case"Company":e.company=r.textContent;break;case"AppVersion":e.appVersion=r.textContent;break}return e}function safeParseToInt(x){if(!(typeof x>"u"))return parseInt(x)}class ExtendedPropsPart extends Part{parseXml(t){this.props=parseExtendedProps(t,this._package.xmlParser)}}function parseCoreProps(x,t){const e={};for(let r of t.elements(x))switch(r.localName){case"title":e.title=r.textContent;break;case"description":e.description=r.textContent;break;case"subject":e.subject=r.textContent;break;case"creator":e.creator=r.textContent;break;case"keywords":e.keywords=r.textContent;break;case"language":e.language=r.textContent;break;case"lastModifiedBy":e.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(e.revision=parseInt(r.textContent));break}return e}class CorePropsPart extends Part{parseXml(t){this.props=parseCoreProps(t,this._package.xmlParser)}}class DmlTheme{}function parseTheme(x,t){var e=new DmlTheme,r=t.element(x,"themeElements");for(let s of t.elements(r))switch(s.localName){case"clrScheme":e.colorScheme=parseColorScheme(s,t);break;case"fontScheme":e.fontScheme=parseFontScheme(s,t);break}return e}function parseColorScheme(x,t){var e={name:t.attr(x,"name"),colors:{}};for(let i of t.elements(x)){var r=t.element(i,"srgbClr"),s=t.element(i,"sysClr");r?e.colors[i.localName]=t.attr(r,"val"):s&&(e.colors[i.localName]=t.attr(s,"lastClr"))}return e}function parseFontScheme(x,t){var e={name:t.attr(x,"name")};for(let r of t.elements(x))switch(r.localName){case"majorFont":e.majorFont=parseFontInfo(r,t);break;case"minorFont":e.minorFont=parseFontInfo(r,t);break}return e}function parseFontInfo(x,t){return{latinTypeface:t.elementAttr(x,"latin","typeface"),eaTypeface:t.elementAttr(x,"ea","typeface"),csTypeface:t.elementAttr(x,"cs","typeface")}}class ThemePart extends Part{constructor(t,e){super(t,e)}parseXml(t){this.theme=parseTheme(t,this._package.xmlParser)}}class WmlBaseNote{}class WmlFootnote extends WmlBaseNote{constructor(){super(...arguments),this.type=DomType.Footnote}}class WmlEndnote extends WmlBaseNote{constructor(){super(...arguments),this.type=DomType.Endnote}}class BaseNotePart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}}class FootnotesPart extends BaseNotePart{constructor(t,e,r){super(t,e,r)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"footnote",WmlFootnote)}}class EndnotesPart extends BaseNotePart{constructor(t,e,r){super(t,e,r)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"endnote",WmlEndnote)}}function parseSettings(x,t){var e={};for(let r of t.elements(x))switch(r.localName){case"defaultTabStop":e.defaultTabStop=t.lengthAttr(r,"val");break;case"footnotePr":e.footnoteProps=parseNoteProperties(r,t);break;case"endnotePr":e.endnoteProps=parseNoteProperties(r,t);break;case"autoHyphenation":e.autoHyphenation=t.boolAttr(r,"val");break}return e}function parseNoteProperties(x,t){var e={defaultNoteIds:[]};for(let r of t.elements(x))switch(r.localName){case"numFmt":e.nummeringFormat=t.attr(r,"val");break;case"footnote":case"endnote":e.defaultNoteIds.push(t.attr(r,"id"));break}return e}class SettingsPart extends Part{constructor(t,e){super(t,e)}parseXml(t){this.settings=parseSettings(t,this._package.xmlParser)}}function parseCustomProps(x,t){return t.elements(x,"property").map(e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}})}class CustomPropsPart extends Part{parseXml(t){this.props=parseCustomProps(t,this._package.xmlParser)}}class CommentsPart extends Part{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.comments=this._documentParser.parseComments(t),this.commentMap=keyBy(this.comments,e=>e.id)}}class CommentsExtendedPart extends Part{constructor(t,e){super(t,e),this.comments=[]}parseXml(t){const e=this._package.xmlParser;for(let r of e.elements(t,"commentEx"))this.comments.push({paraId:e.attr(r,"paraId"),paraIdParent:e.attr(r,"paraIdParent"),done:e.boolAttr(r,"done")});this.commentMap=keyBy(this.comments,r=>r.paraId)}}const topLevelRels=[{type:RelationshipTypes.OfficeDocument,target:"word/document.xml"},{type:RelationshipTypes.ExtendedProperties,target:"docProps/app.xml"},{type:RelationshipTypes.CoreProperties,target:"docProps/core.xml"},{type:RelationshipTypes.CustomProperties,target:"docProps/custom.xml"}];class WordDocument{constructor(){this.parts=[],this.partsMap={}}static async load(t,e,r){var s=new WordDocument;return s._options=r,s._parser=e,s._package=await OpenXmlPackage.load(t,r),s.rels=await s._package.loadRelationships(),await Promise.all(topLevelRels.map(i=>{const p=s.rels.find(g=>g.type===i.type)??i;return s.loadRelationshipPart(p.target,p.type)})),s}save(t="blob"){return this._package.save(t)}async loadRelationshipPart(t,e){var s;if(this.partsMap[t])return this.partsMap[t];if(!this._package.get(t))return null;let r=null;switch(e){case RelationshipTypes.OfficeDocument:this.documentPart=r=new DocumentPart(this._package,t,this._parser);break;case RelationshipTypes.FontTable:this.fontTablePart=r=new FontTablePart(this._package,t);break;case RelationshipTypes.Numbering:this.numberingPart=r=new NumberingPart(this._package,t,this._parser);break;case RelationshipTypes.Styles:this.stylesPart=r=new StylesPart(this._package,t,this._parser);break;case RelationshipTypes.Theme:this.themePart=r=new ThemePart(this._package,t);break;case RelationshipTypes.Footnotes:this.footnotesPart=r=new FootnotesPart(this._package,t,this._parser);break;case RelationshipTypes.Endnotes:this.endnotesPart=r=new EndnotesPart(this._package,t,this._parser);break;case RelationshipTypes.Footer:r=new FooterPart(this._package,t,this._parser);break;case RelationshipTypes.Header:r=new HeaderPart(this._package,t,this._parser);break;case RelationshipTypes.CoreProperties:this.corePropsPart=r=new CorePropsPart(this._package,t);break;case RelationshipTypes.ExtendedProperties:this.extendedPropsPart=r=new ExtendedPropsPart(this._package,t);break;case RelationshipTypes.CustomProperties:r=new CustomPropsPart(this._package,t);break;case RelationshipTypes.Settings:this.settingsPart=r=new SettingsPart(this._package,t);break;case RelationshipTypes.Comments:this.commentsPart=r=new CommentsPart(this._package,t,this._parser);break;case RelationshipTypes.CommentsExtended:this.commentsExtendedPart=r=new CommentsExtendedPart(this._package,t);break}if(r==null)return Promise.resolve(null);if(this.partsMap[t]=r,this.parts.push(r),await r.load(),((s=r.rels)==null?void 0:s.length)>0){const[i]=splitPath(r.path);await Promise.all(r.rels.map(p=>this.loadRelationshipPart(resolvePath(p.target,i),p.type)))}return r}async loadDocumentImage(t,e){const r=await this.loadResource(e??this.documentPart,t,"blob");return this.blobToURL(r)}async loadNumberingImage(t){const e=await this.loadResource(this.numberingPart,t,"blob");return this.blobToURL(e)}async loadFont(t,e){const r=await this.loadResource(this.fontTablePart,t,"uint8array");return r&&this.blobToURL(new Blob([deobfuscate(r,e)]))}blobToURL(t){return t?this._options.useBase64URL?blobToBase64(t):URL.createObjectURL(t):null}findPartByRelId(t,e=null){var r=(e.rels??this.rels).find(i=>i.id==t);const s=e?splitPath(e.path)[0]:"";return r?this.partsMap[resolvePath(r.target,s)]:null}getPathById(t,e){const r=t.rels.find(i=>i.id==e),[s]=splitPath(t.path);return r?resolvePath(r.target,s):null}loadResource(t,e,r){const s=this.getPathById(t,e);return s?this._package.load(s,r):Promise.resolve(null)}}function deobfuscate(x,t){const r=t.replace(/{|}|-/g,""),s=new Array(16);for(let i=0;i<16;i++)s[16-i-1]=parseInt(r.substr(i*2,2),16);for(let i=0;i<32;i++)x[i]=x[i]^s[i%16];return x}function parseBookmarkStart(x,t){return{type:DomType.BookmarkStart,id:t.attr(x,"id"),name:t.attr(x,"name"),colFirst:t.intAttr(x,"colFirst"),colLast:t.intAttr(x,"colLast")}}function parseBookmarkEnd(x,t){return{type:DomType.BookmarkEnd,id:t.attr(x,"id")}}class VmlElement extends OpenXmlElementBase{constructor(){super(...arguments),this.type=DomType.VmlElement,this.attrs={}}}function parseVmlElement(x,t){var e=new VmlElement;switch(x.localName){case"rect":e.tagName="rect",Object.assign(e.attrs,{width:"100%",height:"100%"});break;case"oval":e.tagName="ellipse",Object.assign(e.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":e.tagName="line";break;case"shape":e.tagName="g";break;case"textbox":e.tagName="foreignObject",Object.assign(e.attrs,{width:"100%",height:"100%"});break;default:return null}for(const r of globalXmlParser.attrs(x))switch(r.localName){case"style":e.cssStyleText=r.value;break;case"fillcolor":e.attrs.fill=r.value;break;case"from":const[s,i]=parsePoint(r.value);Object.assign(e.attrs,{x1:s,y1:i});break;case"to":const[p,g]=parsePoint(r.value);Object.assign(e.attrs,{x2:p,y2:g});break}for(const r of globalXmlParser.elements(x))switch(r.localName){case"stroke":Object.assign(e.attrs,parseStroke(r));break;case"fill":Object.assign(e.attrs,parseFill());break;case"imagedata":e.tagName="image",Object.assign(e.attrs,{width:"100%",height:"100%"}),e.imageHref={id:globalXmlParser.attr(r,"id"),title:globalXmlParser.attr(r,"title")};break;case"txbxContent":e.children.push(...t.parseBodyElements(r));break;default:const s=parseVmlElement(r,t);s&&e.children.push(s);break}return e}function parseStroke(x){return{stroke:globalXmlParser.attr(x,"color"),"stroke-width":globalXmlParser.lengthAttr(x,"weight",LengthUsage.Emu)??"1px"}}function parseFill(x){return{}}function parsePoint(x){return x.split(",")}class WmlComment extends OpenXmlElementBase{constructor(){super(...arguments),this.type=DomType.Comment}}class WmlCommentReference extends OpenXmlElementBase{constructor(t){super(),this.id=t,this.type=DomType.CommentReference}}class WmlCommentRangeStart extends OpenXmlElementBase{constructor(t){super(),this.id=t,this.type=DomType.CommentRangeStart}}class WmlCommentRangeEnd extends OpenXmlElementBase{constructor(t){super(),this.id=t,this.type=DomType.CommentRangeEnd}}var autos={shd:"inherit",color:"black",borderColor:"black",highlight:"transparent"};const supportedNamespaceURIs=[],mmlTagMap={oMath:DomType.MmlMath,oMathPara:DomType.MmlMathParagraph,f:DomType.MmlFraction,func:DomType.MmlFunction,fName:DomType.MmlFunctionName,num:DomType.MmlNumerator,den:DomType.MmlDenominator,rad:DomType.MmlRadical,deg:DomType.MmlDegree,e:DomType.MmlBase,sSup:DomType.MmlSuperscript,sSub:DomType.MmlSubscript,sPre:DomType.MmlPreSubSuper,sup:DomType.MmlSuperArgument,sub:DomType.MmlSubArgument,d:DomType.MmlDelimiter,nary:DomType.MmlNary,eqArr:DomType.MmlEquationArray,lim:DomType.MmlLimit,limLow:DomType.MmlLimitLower,m:DomType.MmlMatrix,mr:DomType.MmlMatrixRow,box:DomType.MmlBox,bar:DomType.MmlBar,groupChr:DomType.MmlGroupChar};class DocumentParser{constructor(t){this.options={ignoreWidth:!1,debug:!1,...t}}parseNotes(t,e,r){var s=[];for(let i of globalXmlParser.elements(t,e)){const p=new r;p.id=globalXmlParser.attr(i,"id"),p.noteType=globalXmlParser.attr(i,"type"),p.children=this.parseBodyElements(i),s.push(p)}return s}parseComments(t){var e=[];for(let r of globalXmlParser.elements(t,"comment")){const s=new WmlComment;s.id=globalXmlParser.attr(r,"id"),s.author=globalXmlParser.attr(r,"author"),s.initials=globalXmlParser.attr(r,"initials"),s.date=globalXmlParser.attr(r,"date"),s.children=this.parseBodyElements(r),e.push(s)}return e}parseDocumentFile(t){var e=globalXmlParser.element(t,"body"),r=globalXmlParser.element(t,"background"),s=globalXmlParser.element(e,"sectPr");return{type:DomType.Document,children:this.parseBodyElements(e),props:s?parseSectionProperties(s,globalXmlParser):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(t){var e={},r=xmlUtil.colorAttr(t,"color");return r&&(e["background-color"]=r),e}parseBodyElements(t){var e=[];for(let r of globalXmlParser.elements(t))switch(r.localName){case"p":e.push(this.parseParagraph(r));break;case"tbl":e.push(this.parseTable(r));break;case"sdt":e.push(...this.parseSdt(r,s=>this.parseBodyElements(s)));break}return e}parseStylesFile(t){var e=[];return xmlUtil.foreach(t,r=>{switch(r.localName){case"style":e.push(this.parseStyle(r));break;case"docDefaults":e.push(this.parseDefaultStyles(r));break}}),e}parseDefaultStyles(t){var e={id:null,name:null,target:null,basedOn:null,styles:[]};return xmlUtil.foreach(t,r=>{switch(r.localName){case"rPrDefault":var s=globalXmlParser.element(r,"rPr");s&&e.styles.push({target:"span",values:this.parseDefaultProperties(s,{})});break;case"pPrDefault":var i=globalXmlParser.element(r,"pPr");i&&e.styles.push({target:"p",values:this.parseDefaultProperties(i,{})});break}}),e}parseStyle(t){var e={id:globalXmlParser.attr(t,"styleId"),isDefault:globalXmlParser.boolAttr(t,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(globalXmlParser.attr(t,"type")){case"paragraph":e.target="p";break;case"table":e.target="table";break;case"character":e.target="span";break}return xmlUtil.foreach(t,r=>{switch(r.localName){case"basedOn":e.basedOn=globalXmlParser.attr(r,"val");break;case"name":e.name=globalXmlParser.attr(r,"val");break;case"link":e.linked=globalXmlParser.attr(r,"val");break;case"next":e.next=globalXmlParser.attr(r,"val");break;case"aliases":e.aliases=globalXmlParser.attr(r,"val").split(",");break;case"pPr":e.styles.push({target:"p",values:this.parseDefaultProperties(r,{})}),e.paragraphProps=parseParagraphProperties(r,globalXmlParser);break;case"rPr":e.styles.push({target:"span",values:this.parseDefaultProperties(r,{})}),e.runProps=parseRunProperties(r,globalXmlParser);break;case"tblPr":case"tcPr":e.styles.push({target:"td",values:this.parseDefaultProperties(r,{})});break;case"tblStylePr":for(let s of this.parseTableStyle(r))e.styles.push(s);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${r.localName}`)}}),e}parseTableStyle(t){var e=[],r=globalXmlParser.attr(t,"type"),s="",i="";switch(r){case"firstRow":i=".first-row",s="tr.first-row td";break;case"lastRow":i=".last-row",s="tr.last-row td";break;case"firstCol":i=".first-col",s="td.first-col";break;case"lastCol":i=".last-col",s="td.last-col";break;case"band1Vert":i=":not(.no-vband)",s="td.odd-col";break;case"band2Vert":i=":not(.no-vband)",s="td.even-col";break;case"band1Horz":i=":not(.no-hband)",s="tr.odd-row";break;case"band2Horz":i=":not(.no-hband)",s="tr.even-row";break;default:return[]}return xmlUtil.foreach(t,p=>{switch(p.localName){case"pPr":e.push({target:`${s} p`,mod:i,values:this.parseDefaultProperties(p,{})});break;case"rPr":e.push({target:`${s} span`,mod:i,values:this.parseDefaultProperties(p,{})});break;case"tblPr":case"tcPr":e.push({target:s,mod:i,values:this.parseDefaultProperties(p,{})});break}}),e}parseNumberingFile(t){var e=[],r={},s=[];return xmlUtil.foreach(t,i=>{switch(i.localName){case"abstractNum":this.parseAbstractNumbering(i,s).forEach(m=>e.push(m));break;case"numPicBullet":s.push(this.parseNumberingPicBullet(i));break;case"num":var p=globalXmlParser.attr(i,"numId"),g=globalXmlParser.elementAttr(i,"abstractNumId","val");r[g]=p;break}}),e.forEach(i=>i.id=r[i.id]),e}parseNumberingPicBullet(t){var e=globalXmlParser.element(t,"pict"),r=e&&globalXmlParser.element(e,"shape"),s=r&&globalXmlParser.element(r,"imagedata");return s?{id:globalXmlParser.intAttr(t,"numPicBulletId"),src:globalXmlParser.attr(s,"id"),style:globalXmlParser.attr(r,"style")}:null}parseAbstractNumbering(t,e){var r=[],s=globalXmlParser.attr(t,"abstractNumId");return xmlUtil.foreach(t,i=>{switch(i.localName){case"lvl":r.push(this.parseNumberingLevel(s,i,e));break}}),r}parseNumberingLevel(t,e,r){var s={id:t,level:globalXmlParser.intAttr(e,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return xmlUtil.foreach(e,i=>{switch(i.localName){case"start":s.start=globalXmlParser.intAttr(i,"val");break;case"pPr":this.parseDefaultProperties(i,s.pStyle);break;case"rPr":this.parseDefaultProperties(i,s.rStyle);break;case"lvlPicBulletId":var p=globalXmlParser.intAttr(i,"val");s.bullet=r.find(g=>(g==null?void 0:g.id)==p);break;case"lvlText":s.levelText=globalXmlParser.attr(i,"val");break;case"pStyle":s.pStyleName=globalXmlParser.attr(i,"val");break;case"numFmt":s.format=globalXmlParser.attr(i,"val");break;case"suff":s.suff=globalXmlParser.attr(i,"val");break}}),s}parseSdt(t,e){const r=globalXmlParser.element(t,"sdtContent");return r?e(r):[]}parseInserted(t,e){var r;return{type:DomType.Inserted,children:((r=e(t))==null?void 0:r.children)??[]}}parseDeleted(t,e){var r;return{type:DomType.Deleted,children:((r=e(t))==null?void 0:r.children)??[]}}parseParagraph(t){var e={type:DomType.Paragraph,children:[]};for(let r of globalXmlParser.elements(t))switch(r.localName){case"pPr":this.parseParagraphProperties(r,e);break;case"r":e.children.push(this.parseRun(r,e));break;case"hyperlink":e.children.push(this.parseHyperlink(r,e));break;case"smartTag":e.children.push(this.parseSmartTag(r,e));break;case"bookmarkStart":e.children.push(parseBookmarkStart(r,globalXmlParser));break;case"bookmarkEnd":e.children.push(parseBookmarkEnd(r,globalXmlParser));break;case"commentRangeStart":e.children.push(new WmlCommentRangeStart(globalXmlParser.attr(r,"id")));break;case"commentRangeEnd":e.children.push(new WmlCommentRangeEnd(globalXmlParser.attr(r,"id")));break;case"oMath":case"oMathPara":e.children.push(this.parseMathElement(r));break;case"sdt":e.children.push(...this.parseSdt(r,s=>this.parseParagraph(s).children));break;case"ins":e.children.push(this.parseInserted(r,s=>this.parseParagraph(s)));break;case"del":e.children.push(this.parseDeleted(r,s=>this.parseParagraph(s)));break}return e}parseParagraphProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,r=>{if(parseParagraphProperty(r,e,globalXmlParser))return!0;switch(r.localName){case"pStyle":e.styleName=globalXmlParser.attr(r,"val");break;case"cnfStyle":e.className=values.classNameOfCnfStyle(r);break;case"framePr":this.parseFrame(r,e);break;case"rPr":break;default:return!1}return!0})}parseFrame(t,e){var r=globalXmlParser.attr(t,"dropCap");r=="drop"&&(e.cssStyle.float="left")}parseHyperlink(t,e){var r={type:DomType.Hyperlink,parent:e,children:[]},s=globalXmlParser.attr(t,"anchor"),i=globalXmlParser.attr(t,"id");return s&&(r.href="#"+s),i&&(r.id=i),xmlUtil.foreach(t,p=>{switch(p.localName){case"r":r.children.push(this.parseRun(p,r));break}}),r}parseSmartTag(t,e){var r={type:DomType.SmartTag,parent:e,children:[]},s=globalXmlParser.attr(t,"uri"),i=globalXmlParser.attr(t,"element");return s&&(r.uri=s),i&&(r.element=i),xmlUtil.foreach(t,p=>{switch(p.localName){case"r":r.children.push(this.parseRun(p,r));break}}),r}parseRun(t,e){var r={type:DomType.Run,parent:e,children:[]};return xmlUtil.foreach(t,s=>{switch(s=this.checkAlternateContent(s),s.localName){case"t":r.children.push({type:DomType.Text,text:s.textContent});break;case"delText":r.children.push({type:DomType.DeletedText,text:s.textContent});break;case"commentReference":r.children.push(new WmlCommentReference(globalXmlParser.attr(s,"id")));break;case"fldSimple":r.children.push({type:DomType.SimpleField,instruction:globalXmlParser.attr(s,"instr"),lock:globalXmlParser.boolAttr(s,"lock",!1),dirty:globalXmlParser.boolAttr(s,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:DomType.Instruction,text:s.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:DomType.ComplexField,charType:globalXmlParser.attr(s,"fldCharType"),lock:globalXmlParser.boolAttr(s,"lock",!1),dirty:globalXmlParser.boolAttr(s,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:DomType.NoBreakHyphen});break;case"br":r.children.push({type:DomType.Break,break:globalXmlParser.attr(s,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:DomType.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:DomType.Symbol,font:globalXmlParser.attr(s,"font"),char:globalXmlParser.attr(s,"char")});break;case"tab":r.children.push({type:DomType.Tab});break;case"footnoteReference":r.children.push({type:DomType.FootnoteReference,id:globalXmlParser.attr(s,"id")});break;case"endnoteReference":r.children.push({type:DomType.EndnoteReference,id:globalXmlParser.attr(s,"id")});break;case"drawing":let i=this.parseDrawing(s);i&&(r.children=[i]);break;case"pict":r.children.push(this.parseVmlPicture(s));break;case"rPr":this.parseRunProperties(s,r);break}}),r}parseMathElement(t){const e=`${t.localName}Pr`,r={type:mmlTagMap[t.localName],children:[]};for(const i of globalXmlParser.elements(t))if(mmlTagMap[i.localName])r.children.push(this.parseMathElement(i));else if(i.localName=="r"){var s=this.parseRun(i);s.type=DomType.MmlRun,r.children.push(s)}else i.localName==e&&(r.props=this.parseMathProperies(i));return r}parseMathProperies(t){const e={};for(const r of globalXmlParser.elements(t))switch(r.localName){case"chr":e.char=globalXmlParser.attr(r,"val");break;case"vertJc":e.verticalJustification=globalXmlParser.attr(r,"val");break;case"pos":e.position=globalXmlParser.attr(r,"val");break;case"degHide":e.hideDegree=globalXmlParser.boolAttr(r,"val");break;case"begChr":e.beginChar=globalXmlParser.attr(r,"val");break;case"endChr":e.endChar=globalXmlParser.attr(r,"val");break}return e}parseRunProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,r=>{switch(r.localName){case"rStyle":e.styleName=globalXmlParser.attr(r,"val");break;case"vertAlign":e.verticalAlign=values.valueOfVertAlign(r,!0);break;default:return!1}return!0})}parseVmlPicture(t){const e={type:DomType.VmlPicture,children:[]};for(const r of globalXmlParser.elements(t)){const s=parseVmlElement(r,this);s&&e.children.push(s)}return e}checkAlternateContent(t){var i;if(t.localName!="AlternateContent")return t;var e=globalXmlParser.element(t,"Choice");if(e){var r=globalXmlParser.attr(e,"Requires"),s=t.lookupNamespaceURI(r);if(supportedNamespaceURIs.includes(s))return e.firstElementChild}return(i=globalXmlParser.element(t,"Fallback"))==null?void 0:i.firstElementChild}parseDrawing(t){for(var e of globalXmlParser.elements(t))switch(e.localName){case"inline":case"anchor":return this.parseDrawingWrapper(e)}}parseDrawingWrapper(t){var e={type:DomType.Drawing,children:[],cssStyle:{}},r=t.localName=="anchor";let s=null,i=globalXmlParser.boolAttr(t,"simplePos");globalXmlParser.boolAttr(t,"behindDoc");let p={relative:"page",align:"left",offset:"0"},g={relative:"page",align:"top",offset:"0"};for(var m of globalXmlParser.elements(t))switch(m.localName){case"simplePos":i&&(p.offset=globalXmlParser.lengthAttr(m,"x",LengthUsage.Emu),g.offset=globalXmlParser.lengthAttr(m,"y",LengthUsage.Emu));break;case"extent":e.cssStyle.width=globalXmlParser.lengthAttr(m,"cx",LengthUsage.Emu),e.cssStyle.height=globalXmlParser.lengthAttr(m,"cy",LengthUsage.Emu);break;case"positionH":case"positionV":if(!i){let S=m.localName=="positionH"?p:g;var C=globalXmlParser.element(m,"align"),b=globalXmlParser.element(m,"posOffset");S.relative=globalXmlParser.attr(m,"relativeFrom")??S.relative,C&&(S.align=C.textContent),b&&(S.offset=xmlUtil.sizeValue(b,LengthUsage.Emu))}break;case"wrapTopAndBottom":s="wrapTopAndBottom";break;case"wrapNone":s="wrapNone";break;case"graphic":var M=this.parseGraphic(m);M&&e.children.push(M);break}return s=="wrapTopAndBottom"?(e.cssStyle.display="block",p.align&&(e.cssStyle["text-align"]=p.align,e.cssStyle.width="100%")):s=="wrapNone"?(e.cssStyle.display="block",e.cssStyle.position="relative",e.cssStyle.width="0px",e.cssStyle.height="0px",p.offset&&(e.cssStyle.left=p.offset),g.offset&&(e.cssStyle.top=g.offset)):r&&(p.align=="left"||p.align=="right")&&(e.cssStyle.float=p.align),e}parseGraphic(t){var e=globalXmlParser.element(t,"graphicData");for(let r of globalXmlParser.elements(e))switch(r.localName){case"pic":return this.parsePicture(r)}return null}parsePicture(t){var e={type:DomType.Image,src:"",cssStyle:{}},r=globalXmlParser.element(t,"blipFill"),s=globalXmlParser.element(r,"blip");e.src=globalXmlParser.attr(s,"embed");var i=globalXmlParser.element(t,"spPr"),p=globalXmlParser.element(i,"xfrm");e.cssStyle.position="relative";for(var g of globalXmlParser.elements(p))switch(g.localName){case"ext":e.cssStyle.width=globalXmlParser.lengthAttr(g,"cx",LengthUsage.Emu),e.cssStyle.height=globalXmlParser.lengthAttr(g,"cy",LengthUsage.Emu);break;case"off":e.cssStyle.left=globalXmlParser.lengthAttr(g,"x",LengthUsage.Emu),e.cssStyle.top=globalXmlParser.lengthAttr(g,"y",LengthUsage.Emu);break}return e}parseTable(t){var e={type:DomType.Table,children:[]};return xmlUtil.foreach(t,r=>{switch(r.localName){case"tr":e.children.push(this.parseTableRow(r));break;case"tblGrid":e.columns=this.parseTableColumns(r);break;case"tblPr":this.parseTableProperties(r,e);break}}),e}parseTableColumns(t){var e=[];return xmlUtil.foreach(t,r=>{switch(r.localName){case"gridCol":e.push({width:globalXmlParser.lengthAttr(r,"w")});break}}),e}parseTableProperties(t,e){switch(e.cssStyle={},e.cellStyle={},this.parseDefaultProperties(t,e.cssStyle,e.cellStyle,r=>{switch(r.localName){case"tblStyle":e.styleName=globalXmlParser.attr(r,"val");break;case"tblLook":e.className=values.classNameOftblLook(r);break;case"tblpPr":this.parseTablePosition(r,e);break;case"tblStyleColBandSize":e.colBandSize=globalXmlParser.intAttr(r,"val");break;case"tblStyleRowBandSize":e.rowBandSize=globalXmlParser.intAttr(r,"val");break;default:return!1}return!0}),e.cssStyle["text-align"]){case"center":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto",e.cssStyle["margin-right"]="auto";break;case"right":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto";break}}parseTablePosition(t,e){var r=globalXmlParser.lengthAttr(t,"topFromText"),s=globalXmlParser.lengthAttr(t,"bottomFromText"),i=globalXmlParser.lengthAttr(t,"rightFromText"),p=globalXmlParser.lengthAttr(t,"leftFromText");e.cssStyle.float="left",e.cssStyle["margin-bottom"]=values.addSize(e.cssStyle["margin-bottom"],s),e.cssStyle["margin-left"]=values.addSize(e.cssStyle["margin-left"],p),e.cssStyle["margin-right"]=values.addSize(e.cssStyle["margin-right"],i),e.cssStyle["margin-top"]=values.addSize(e.cssStyle["margin-top"],r)}parseTableRow(t){var e={type:DomType.Row,children:[]};return xmlUtil.foreach(t,r=>{switch(r.localName){case"tc":e.children.push(this.parseTableCell(r));break;case"trPr":this.parseTableRowProperties(r,e);break}}),e}parseTableRowProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,r=>{switch(r.localName){case"cnfStyle":e.className=values.classNameOfCnfStyle(r);break;case"tblHeader":e.isHeader=globalXmlParser.boolAttr(r,"val");break;default:return!1}return!0})}parseTableCell(t){var e={type:DomType.Cell,children:[]};return xmlUtil.foreach(t,r=>{switch(r.localName){case"tbl":e.children.push(this.parseTable(r));break;case"p":e.children.push(this.parseParagraph(r));break;case"tcPr":this.parseTableCellProperties(r,e);break}}),e}parseTableCellProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,r=>{switch(r.localName){case"gridSpan":e.span=globalXmlParser.intAttr(r,"val",null);break;case"vMerge":e.verticalMerge=globalXmlParser.attr(r,"val")??"continue";break;case"cnfStyle":e.className=values.classNameOfCnfStyle(r);break;default:return!1}return!0}),this.parseTableCellVerticalText(t,e)}parseTableCellVerticalText(t,e){const r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};xmlUtil.foreach(t,s=>{if(s.localName==="textDirection"){const i=globalXmlParser.attr(s,"val"),p=r[i]||{writingMode:"horizontal-tb"};e.cssStyle["writing-mode"]=p.writingMode,e.cssStyle.transform=p.transform}})}parseDefaultProperties(t,e=null,r=null,s=null){return e=e||{},xmlUtil.foreach(t,i=>{if(!(s!=null&&s(i)))switch(i.localName){case"jc":e["text-align"]=values.valueOfJc(i);break;case"textAlignment":e["vertical-align"]=values.valueOfTextAlignment(i);break;case"color":e.color=xmlUtil.colorAttr(i,"val",null,autos.color);break;case"sz":e["font-size"]=e["min-height"]=globalXmlParser.lengthAttr(i,"val",LengthUsage.FontSize);break;case"shd":e["background-color"]=xmlUtil.colorAttr(i,"fill",null,autos.shd);break;case"highlight":e["background-color"]=xmlUtil.colorAttr(i,"val",null,autos.highlight);break;case"vertAlign":break;case"position":e.verticalAlign=globalXmlParser.lengthAttr(i,"val",LengthUsage.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":e.width=values.valueOfSize(i,"w");break;case"trHeight":this.parseTrHeight(i,e);break;case"strike":e["text-decoration"]=globalXmlParser.boolAttr(i,"val",!0)?"line-through":"none";break;case"b":e["font-weight"]=globalXmlParser.boolAttr(i,"val",!0)?"bold":"normal";break;case"i":e["font-style"]=globalXmlParser.boolAttr(i,"val",!0)?"italic":"normal";break;case"caps":e["text-transform"]=globalXmlParser.boolAttr(i,"val",!0)?"uppercase":"none";break;case"smallCaps":e["font-variant"]=globalXmlParser.boolAttr(i,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(i,e);break;case"ind":case"tblInd":this.parseIndentation(i,e);break;case"rFonts":this.parseFont(i,e);break;case"tblBorders":this.parseBorderProperties(i,r||e);break;case"tblCellSpacing":e["border-spacing"]=values.valueOfMargin(i),e["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(i,e);break;case"bdr":e.border=values.valueOfBorder(i);break;case"tcBorders":this.parseBorderProperties(i,e);break;case"vanish":globalXmlParser.boolAttr(i,"val",!0)&&(e.display="none");break;case"kern":break;case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(i,r||e);break;case"tblLayout":e["table-layout"]=values.valueOfTblLayout(i);break;case"vAlign":e["vertical-align"]=values.valueOfTextAlignment(i);break;case"spacing":t.localName=="pPr"&&this.parseSpacing(i,e);break;case"wordWrap":globalXmlParser.boolAttr(i,"val")&&(e["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":e.hyphens=globalXmlParser.boolAttr(i,"val",!0)?"none":"auto";break;case"lang":e.$lang=globalXmlParser.attr(i,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${t.localName}.${i.localName}`);break}}),e}parseUnderline(t,e){var r=globalXmlParser.attr(t,"val");if(r!=null){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":e["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":e["text-decoration"]="underline dotted";break;case"double":e["text-decoration"]="underline double";break;case"single":case"thick":e["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":e["text-decoration"]="underline wavy";break;case"words":e["text-decoration"]="underline";break;case"none":e["text-decoration"]="none";break}var s=xmlUtil.colorAttr(t,"color");s&&(e["text-decoration-color"]=s)}}parseFont(t,e){var r=globalXmlParser.attr(t,"ascii"),s=values.themeValue(t,"asciiTheme"),i=globalXmlParser.attr(t,"eastAsia"),p=[r,s,i].filter(g=>g).map(g=>encloseFontFamily(g));p.length>0&&(e["font-family"]=[...new Set(p)].join(", "))}parseIndentation(t,e){var r=globalXmlParser.lengthAttr(t,"firstLine"),s=globalXmlParser.lengthAttr(t,"hanging"),i=globalXmlParser.lengthAttr(t,"left"),p=globalXmlParser.lengthAttr(t,"start"),g=globalXmlParser.lengthAttr(t,"right"),m=globalXmlParser.lengthAttr(t,"end");r&&(e["text-indent"]=r),s&&(e["text-indent"]=`-${s}`),(i||p)&&(e["margin-left"]=i||p),(g||m)&&(e["margin-right"]=g||m)}parseSpacing(t,e){var r=globalXmlParser.lengthAttr(t,"before"),s=globalXmlParser.lengthAttr(t,"after"),i=globalXmlParser.intAttr(t,"line",null),p=globalXmlParser.attr(t,"lineRule");if(r&&(e["margin-top"]=r),s&&(e["margin-bottom"]=s),i!==null)switch(p){case"auto":e["line-height"]=`${(i/240).toFixed(2)}`;break;case"atLeast":e["line-height"]=`calc(100% + ${i/20}pt)`;break;default:e["line-height"]=e["min-height"]=`${i/20}pt`;break}}parseMarginProperties(t,e){xmlUtil.foreach(t,r=>{switch(r.localName){case"left":e["padding-left"]=values.valueOfMargin(r);break;case"right":e["padding-right"]=values.valueOfMargin(r);break;case"top":e["padding-top"]=values.valueOfMargin(r);break;case"bottom":e["padding-bottom"]=values.valueOfMargin(r);break}})}parseTrHeight(t,e){switch(globalXmlParser.attr(t,"hRule")){case"exact":e.height=globalXmlParser.lengthAttr(t,"val");break;case"atLeast":default:e.height=globalXmlParser.lengthAttr(t,"val");break}}parseBorderProperties(t,e){xmlUtil.foreach(t,r=>{switch(r.localName){case"start":case"left":e["border-left"]=values.valueOfBorder(r);break;case"end":case"right":e["border-right"]=values.valueOfBorder(r);break;case"top":e["border-top"]=values.valueOfBorder(r);break;case"bottom":e["border-bottom"]=values.valueOfBorder(r);break}})}}const knownColors=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class xmlUtil{static foreach(t,e){for(var r=0;r<t.childNodes.length;r++){let s=t.childNodes[r];s.nodeType==Node.ELEMENT_NODE&&e(s)}}static colorAttr(t,e,r=null,s="black"){var i=globalXmlParser.attr(t,e);if(i)return i=="auto"?s:knownColors.includes(i)?i:`#${i}`;var p=globalXmlParser.attr(t,"themeColor");return p?`var(--docx-${p}-color)`:r}static sizeValue(t,e=LengthUsage.Dxa){return convertLength(t.textContent,e)}}class values{static themeValue(t,e){var r=globalXmlParser.attr(t,e);return r?`var(--docx-${r}-font)`:null}static valueOfSize(t,e){var r=LengthUsage.Dxa;switch(globalXmlParser.attr(t,"type")){case"dxa":break;case"pct":r=LengthUsage.Percent;break;case"auto":return"auto"}return globalXmlParser.lengthAttr(t,e,r)}static valueOfMargin(t){return globalXmlParser.lengthAttr(t,"w")}static valueOfBorder(t){var e=globalXmlParser.attr(t,"val");if(e=="nil")return"none";var r=xmlUtil.colorAttr(t,"color"),s=globalXmlParser.lengthAttr(t,"sz",LengthUsage.Border);return`${s} solid ${r=="auto"?autos.borderColor:r}`}static valueOfTblLayout(t){var e=globalXmlParser.attr(t,"val");return e=="fixed"?"fixed":"auto"}static classNameOfCnfStyle(t){const e=globalXmlParser.attr(t,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((s,i)=>e[i]=="1").join(" ")}static valueOfJc(t){var e=globalXmlParser.attr(t,"val");switch(e){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return e}static valueOfVertAlign(t,e=!1){var r=globalXmlParser.attr(t,"val");switch(r){case"subscript":return"sub";case"superscript":return e?"sup":"super"}return e?null:r}static valueOfTextAlignment(t){var e=globalXmlParser.attr(t,"val");switch(e){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return e}static addSize(t,e){return t==null?e:e==null?t:`calc(${t} + ${e})`}static classNameOftblLook(t){const e=globalXmlParser.hexAttr(t,"val",0);let r="";return(globalXmlParser.boolAttr(t,"firstRow")||e&32)&&(r+=" first-row"),(globalXmlParser.boolAttr(t,"lastRow")||e&64)&&(r+=" last-row"),(globalXmlParser.boolAttr(t,"firstColumn")||e&128)&&(r+=" first-col"),(globalXmlParser.boolAttr(t,"lastColumn")||e&256)&&(r+=" last-col"),(globalXmlParser.boolAttr(t,"noHBand")||e&512)&&(r+=" no-hband"),(globalXmlParser.boolAttr(t,"noVBand")||e&1024)&&(r+=" no-vband"),r.trim()}}const defaultTab={pos:0,leader:"none",style:"left"},maxTabs=50;function computePixelToPoint(x=document.body){const t=document.createElement("div");t.style.width="100pt",x.appendChild(t);const e=100/t.offsetWidth;return x.removeChild(t),e}function updateTabStop(x,t,e,r=72/96){const s=x.closest("p"),i=x.getBoundingClientRect(),p=s.getBoundingClientRect(),g=getComputedStyle(s),m=(t==null?void 0:t.length)>0?t.map(R=>({pos:lengthToPoint(R.position),leader:R.leader,style:R.style})).sort((R,L)=>R.pos-L.pos):[defaultTab],C=m[m.length-1],b=p.width*r,M=lengthToPoint(e);let S=C.pos+M;if(S<b)for(;S<b&&m.length<maxTabs;S+=M)m.push({...defaultTab,pos:S});const d=parseFloat(g.marginLeft),f=p.left+d,c=(i.left-f)*r,a=m.find(R=>R.style!="clear"&&R.pos>c);if(a==null)return;let o=1;if(a.style=="right"||a.style=="center"){const R=Array.from(s.querySelectorAll(`.${x.className}`)),L=R.indexOf(x)+1,F=document.createRange();F.setStart(x,1),L<R.length?F.setEndBefore(R[L]):F.setEndAfter(s);const u=a.style=="center"?.5:1,w=F.getBoundingClientRect(),y=w.left+u*w.width-(p.left-d);o=a.pos-y*r}else o=a.pos-c;switch(x.innerHTML="&nbsp;",x.style.textDecoration="inherit",x.style.wordSpacing=`${o.toFixed(0)}pt`,a.leader){case"dot":case"middleDot":x.style.textDecoration="underline",x.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":x.style.textDecoration="underline";break}}function lengthToPoint(x){return parseFloat(x)}const ns={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class HtmlRenderer{constructor(t){this.htmlDocument=t,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(t,e,r=null,s){var p;this.document=t,this.options=s,this.className=s.className,this.rootSelector=s.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),r=r||e,removeAllElements(r),removeAllElements(e),r.appendChild(this.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),t.themePart&&(r.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(t.themePart,r)),t.stylesPart!=null&&(this.styleMap=this.processStyles(t.stylesPart.styles),r.appendChild(this.createComment("docxjs document styles")),r.appendChild(this.renderStyles(t.stylesPart.styles))),t.numberingPart&&(this.prodessNumberings(t.numberingPart.domNumberings),r.appendChild(this.createComment("docxjs document numbering styles")),r.appendChild(this.renderNumbering(t.numberingPart.domNumberings,r))),t.footnotesPart&&(this.footnoteMap=keyBy(t.footnotesPart.notes,g=>g.id)),t.endnotesPart&&(this.endnoteMap=keyBy(t.endnotesPart.notes,g=>g.id)),t.settingsPart&&(this.defaultTabSize=(p=t.settingsPart.settings)==null?void 0:p.defaultTabStop),!s.ignoreFonts&&t.fontTablePart&&this.renderFontTable(t.fontTablePart,r);var i=this.renderSections(t.documentPart.body);this.options.inWrapper?e.appendChild(this.renderWrapper(i)):appendChildren(e,i),this.commentHighlight&&s.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(g=>g()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(t,e){var g,m;const r={},s=(g=t.theme)==null?void 0:g.fontScheme;s&&(s.majorFont&&(r["--docx-majorHAnsi-font"]=s.majorFont.latinTypeface),s.minorFont&&(r["--docx-minorHAnsi-font"]=s.minorFont.latinTypeface));const i=(m=t.theme)==null?void 0:m.colorScheme;if(i)for(let[C,b]of Object.entries(i.colors))r[`--docx-${C}-color`]=`#${b}`;const p=this.styleToString(`.${this.className}`,r);e.appendChild(this.createStyleElement(p))}renderFontTable(t,e){for(let r of t.fonts)for(let s of r.embedFontRefs)this.tasks.push(this.document.loadFont(s.id,s.key).then(i=>{const p={"font-family":encloseFontFamily(r.name),src:`url(${i})`};(s.type=="bold"||s.type=="boldItalic")&&(p["font-weight"]="bold"),(s.type=="italic"||s.type=="boldItalic")&&(p["font-style"]="italic");const g=this.styleToString("@font-face",p);e.appendChild(this.createComment(`docxjs ${r.name} font`)),e.appendChild(this.createStyleElement(g))}))}processStyleName(t){return t?`${this.className}_${escapeClassName(t)}`:this.className}processStyles(t){const e=keyBy(t.filter(s=>s.id!=null),s=>s.id);for(const s of t.filter(i=>i.basedOn)){var r=e[s.basedOn];if(r){s.paragraphProps=mergeDeep(s.paragraphProps,r.paragraphProps),s.runProps=mergeDeep(s.runProps,r.runProps);for(const i of r.styles){const p=s.styles.find(g=>g.target==i.target);p?this.copyStyleProperties(i.values,p.values):s.styles.push({...i,values:{...i.values}})}}else this.options.debug&&console.warn(`Can't find base style ${s.basedOn}`)}for(let s of t)s.cssName=this.processStyleName(s.id);return e}prodessNumberings(t){var e;for(let r of t.filter(s=>s.pStyleName)){const s=this.findStyle(r.pStyleName);(e=s==null?void 0:s.paragraphProps)!=null&&e.numbering&&(s.paragraphProps.numbering.level=r.level)}}processElement(t){if(t.children)for(var e of t.children)e.parent=t,e.type==DomType.Table?this.processTable(e):this.processElement(e)}processTable(t){for(var e of t.children)for(var r of e.children)r.cssStyle=this.copyStyleProperties(t.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(t,e,r=null){if(!t)return e;e==null&&(e={}),r==null&&(r=Object.getOwnPropertyNames(t));for(var s of r)t.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(e[s]=t[s]);return e}createPageElement(t,e){var r=this.createElement("section",{className:t});return e&&(e.pageMargins&&(r.style.paddingLeft=e.pageMargins.left,r.style.paddingRight=e.pageMargins.right,r.style.paddingTop=e.pageMargins.top,r.style.paddingBottom=e.pageMargins.bottom),e.pageSize&&(this.options.ignoreWidth||(r.style.width=e.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=e.pageSize.height))),r}createSectionContent(t){var e=this.createElement("article");return t.columns&&t.columns.numberOfColumns&&(e.style.columnCount=`${t.columns.numberOfColumns}`,e.style.columnGap=t.columns.space,t.columns.separator&&(e.style.columnRule="1px solid black")),e}renderSections(t){const e=[];this.processElement(t);const r=this.splitBySection(t.children,t.props),s=this.groupByPageBreaks(r);let i=null;for(let g=0,m=s.length;g<m;g++){this.currentFootnoteIds=[];let b=s[g][0].sectProps;const M=this.createPageElement(this.className,b);this.renderStyleValues(t.cssStyle,M),this.options.renderHeaders&&this.renderHeaderFooter(b.headerRefs,b,e.length,i!=b,M);for(const S of s[g]){var p=this.createSectionContent(S.sectProps);this.renderElements(S.elements,p),M.appendChild(p),b=S.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,M),this.options.renderEndnotes&&g==m-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,M),this.options.renderFooters&&this.renderHeaderFooter(b.footerRefs,b,e.length,i!=b,M),e.push(M),i=b}return e}renderHeaderFooter(t,e,r,s,i){if(t){var p=(e.titlePage&&s?t.find(m=>m.type=="first"):null)??(r%2==1?t.find(m=>m.type=="even"):null)??t.find(m=>m.type=="default"),g=p&&this.document.findPartByRelId(p.id,this.document.documentPart);if(g){this.currentPart=g,this.usedHederFooterParts.includes(g.path)||(this.processElement(g.rootElement),this.usedHederFooterParts.push(g.path));const[m]=this.renderElements([g.rootElement],i);e!=null&&e.pageMargins&&(g.rootElement.type===DomType.Header?(m.style.marginTop=`calc(${e.pageMargins.header} - ${e.pageMargins.top})`,m.style.minHeight=`calc(${e.pageMargins.top} - ${e.pageMargins.header})`):g.rootElement.type===DomType.Footer&&(m.style.marginBottom=`calc(${e.pageMargins.footer} - ${e.pageMargins.bottom})`,m.style.minHeight=`calc(${e.pageMargins.bottom} - ${e.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(t){return t.type!=DomType.Break?!1:t.break=="lastRenderedPageBreak"?!this.options.ignoreLastRenderedPageBreak:t.break=="page"}isPageBreakSection(t,e){var r,s,i,p,g,m;return!t||!e?!1:((r=t.pageSize)==null?void 0:r.orientation)!=((s=e.pageSize)==null?void 0:s.orientation)||((i=t.pageSize)==null?void 0:i.width)!=((p=e.pageSize)==null?void 0:p.width)||((g=t.pageSize)==null?void 0:g.height)!=((m=e.pageSize)==null?void 0:m.height)}splitBySection(t,e){var M;var r={sectProps:null,elements:[],pageBreak:!1},s=[r];for(let S of t){if(S.type==DomType.Paragraph){const d=this.findStyle(S.styleName);(M=d==null?void 0:d.paragraphProps)!=null&&M.pageBreakBefore&&(r.sectProps=i,r.pageBreak=!0,r={sectProps:null,elements:[],pageBreak:!1},s.push(r))}if(r.elements.push(S),S.type==DomType.Paragraph){const d=S;var i=d.sectionProps,p=-1,g=-1;if(this.options.breakPages&&d.children&&(p=d.children.findIndex(f=>{var c;return g=((c=f.children)==null?void 0:c.findIndex(this.isPageBreakElement.bind(this)))??-1,g!=-1})),(i||p!=-1)&&(r.sectProps=i,r.pageBreak=p!=-1,r={sectProps:null,elements:[],pageBreak:!1},s.push(r)),p!=-1){let f=d.children[p],c=g<f.children.length-1;if(p<d.children.length-1||c){var m=S.children,C={...S,children:m.slice(p)};if(S.children=m.slice(0,p),r.elements.push(C),c){let a=f.children,o={...f,children:a.slice(0,g)};S.children.push(o),f.children=a.slice(g)}}}}}let b=null;for(let S=s.length-1;S>=0;S--)s[S].sectProps==null?s[S].sectProps=b??e:b=s[S].sectProps;return s}groupByPageBreaks(t){let e=[],r;const s=[e];for(let i of t)e.push(i),(this.options.ignoreLastRenderedPageBreak||i.pageBreak||this.isPageBreakSection(r,i.sectProps))&&s.push(e=[]),r=i.sectProps;return s.filter(i=>i.length>0)}renderWrapper(t){return this.createElement("div",{className:`${this.className}-wrapper`},t)}renderDefaultStyle(){var t=this.className,e=`
.${t}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } 
.${t}-wrapper>section.${t} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }
.${t} { color: black; hyphens: auto; text-underline-position: from-font; }
section.${t} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }
section.${t}>article { margin-bottom: auto; z-index: 1; }
section.${t}>footer { z-index: 1; }
.${t} table { border-collapse: collapse; }
.${t} table td, .${t} table th { vertical-align: top; }
.${t} p { margin: 0pt; min-height: 1em; }
.${t} span { white-space: pre-wrap; overflow-wrap: break-word; }
.${t} a { color: inherit; text-decoration: inherit; }
.${t} svg { fill: transparent; }
`;return this.options.renderComments&&(e+=`
.${t}-comment-ref { cursor: default; }
.${t}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }
.${t}-comment-ref:hover~.${t}-comment-popover { display: block; }
.${t}-comment-author,.${t}-comment-date { font-size: 0.875rem; color: #888; }
`),this.createStyleElement(e)}renderNumbering(t,e){var r="",s=[];for(var i of t){var p=`p.${this.numberingClass(i.id,i.level)}`,g="none";if(i.bullet){let m=`--${this.className}-${i.bullet.src}`.toLowerCase();r+=this.styleToString(`${p}:before`,{content:"' '",display:"inline-block",background:`var(${m})`},i.bullet.style),this.tasks.push(this.document.loadNumberingImage(i.bullet.src).then(C=>{var b=`${this.rootSelector} { ${m}: url(${C}) }`;e.appendChild(this.createStyleElement(b))}))}else if(i.levelText){let m=this.numberingCounter(i.id,i.level);const C=m+" "+(i.start-1);i.level>0&&(r+=this.styleToString(`p.${this.numberingClass(i.id,i.level-1)}`,{"counter-reset":C})),s.push(C),r+=this.styleToString(`${p}:before`,{content:this.levelTextToContent(i.levelText,i.suff,i.id,this.numFormatToCssValue(i.format)),"counter-increment":m,...i.rStyle})}else g=this.numFormatToCssValue(i.format);r+=this.styleToString(p,{display:"list-item","list-style-position":"inside","list-style-type":g,...i.pStyle})}return s.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":s.join(" ")})),this.createStyleElement(r)}renderStyles(t){var e="";const r=this.styleMap,s=keyBy(t.filter(m=>m.isDefault),m=>m.target);for(const m of t){var i=m.styles;if(m.linked){var p=m.linked&&r[m.linked];p?i=i.concat(p.styles):this.options.debug&&console.warn(`Can't find linked style ${m.linked}`)}for(const C of i){var g=`${m.target??""}.${m.cssName}`;m.target!=C.target&&(g+=` ${C.target}`),s[m.target]==m&&(g=`.${this.className} ${m.target}, `+g),e+=this.styleToString(g,C.values)}}return this.createStyleElement(e)}renderNotes(t,e,r){var s=t.map(p=>e[p]).filter(p=>p);if(s.length>0){var i=this.createElement("ol",null,this.renderElements(s));r.appendChild(i)}}renderElement(t){switch(t.type){case DomType.Paragraph:return this.renderParagraph(t);case DomType.BookmarkStart:return this.renderBookmarkStart(t);case DomType.BookmarkEnd:return null;case DomType.Run:return this.renderRun(t);case DomType.Table:return this.renderTable(t);case DomType.Row:return this.renderTableRow(t);case DomType.Cell:return this.renderTableCell(t);case DomType.Hyperlink:return this.renderHyperlink(t);case DomType.SmartTag:return this.renderSmartTag(t);case DomType.Drawing:return this.renderDrawing(t);case DomType.Image:return this.renderImage(t);case DomType.Text:return this.renderText(t);case DomType.Text:return this.renderText(t);case DomType.DeletedText:return this.renderDeletedText(t);case DomType.Tab:return this.renderTab(t);case DomType.Symbol:return this.renderSymbol(t);case DomType.Break:return this.renderBreak(t);case DomType.Footer:return this.renderContainer(t,"footer");case DomType.Header:return this.renderContainer(t,"header");case DomType.Footnote:case DomType.Endnote:return this.renderContainer(t,"li");case DomType.FootnoteReference:return this.renderFootnoteReference(t);case DomType.EndnoteReference:return this.renderEndnoteReference(t);case DomType.NoBreakHyphen:return this.createElement("wbr");case DomType.VmlPicture:return this.renderVmlPicture(t);case DomType.VmlElement:return this.renderVmlElement(t);case DomType.MmlMath:return this.renderContainerNS(t,ns.mathML,"math",{xmlns:ns.mathML});case DomType.MmlMathParagraph:return this.renderContainer(t,"span");case DomType.MmlFraction:return this.renderContainerNS(t,ns.mathML,"mfrac");case DomType.MmlBase:return this.renderContainerNS(t,ns.mathML,t.parent.type==DomType.MmlMatrixRow?"mtd":"mrow");case DomType.MmlNumerator:case DomType.MmlDenominator:case DomType.MmlFunction:case DomType.MmlLimit:case DomType.MmlBox:return this.renderContainerNS(t,ns.mathML,"mrow");case DomType.MmlGroupChar:return this.renderMmlGroupChar(t);case DomType.MmlLimitLower:return this.renderContainerNS(t,ns.mathML,"munder");case DomType.MmlMatrix:return this.renderContainerNS(t,ns.mathML,"mtable");case DomType.MmlMatrixRow:return this.renderContainerNS(t,ns.mathML,"mtr");case DomType.MmlRadical:return this.renderMmlRadical(t);case DomType.MmlSuperscript:return this.renderContainerNS(t,ns.mathML,"msup");case DomType.MmlSubscript:return this.renderContainerNS(t,ns.mathML,"msub");case DomType.MmlDegree:case DomType.MmlSuperArgument:case DomType.MmlSubArgument:return this.renderContainerNS(t,ns.mathML,"mn");case DomType.MmlFunctionName:return this.renderContainerNS(t,ns.mathML,"ms");case DomType.MmlDelimiter:return this.renderMmlDelimiter(t);case DomType.MmlRun:return this.renderMmlRun(t);case DomType.MmlNary:return this.renderMmlNary(t);case DomType.MmlPreSubSuper:return this.renderMmlPreSubSuper(t);case DomType.MmlBar:return this.renderMmlBar(t);case DomType.MmlEquationArray:return this.renderMllList(t);case DomType.Inserted:return this.renderInserted(t);case DomType.Deleted:return this.renderDeleted(t);case DomType.CommentRangeStart:return this.renderCommentRangeStart(t);case DomType.CommentRangeEnd:return this.renderCommentRangeEnd(t);case DomType.CommentReference:return this.renderCommentReference(t)}return null}renderElements(t,e){if(t==null)return null;var r=t.flatMap(s=>this.renderElement(s)).filter(s=>s!=null);return e&&appendChildren(e,r),r}renderContainer(t,e,r){return this.createElement(e,r,this.renderElements(t.children))}renderContainerNS(t,e,r,s){return this.createElementNS(e,r,s,this.renderElements(t.children))}renderParagraph(t){var i,p;var e=this.renderContainer(t,"p");const r=this.findStyle(t.styleName);t.tabs??(t.tabs=(i=r==null?void 0:r.paragraphProps)==null?void 0:i.tabs),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),this.renderCommonProperties(e.style,t);const s=t.numbering??((p=r==null?void 0:r.paragraphProps)==null?void 0:p.numbering);return s&&e.classList.add(this.numberingClass(s.id,s.level)),e}renderRunProperties(t,e){this.renderCommonProperties(t,e)}renderCommonProperties(t,e){e!=null&&(e.color&&(t.color=e.color),e.fontSize&&(t["font-size"]=e.fontSize))}renderHyperlink(t){var e=this.renderContainer(t,"a");if(this.renderStyleValues(t.cssStyle,e),t.href)e.href=t.href;else if(t.id){const r=this.document.documentPart.rels.find(s=>s.id==t.id&&s.targetMode==="External");e.href=r==null?void 0:r.target}return e}renderSmartTag(t){return this.renderContainer(t,"span")}renderCommentRangeStart(t){var s;if(!this.options.renderComments)return null;const e=new Range;(s=this.commentHighlight)==null||s.add(e);const r=this.htmlDocument.createComment(`start of comment #${t.id}`);return this.later(()=>e.setStart(r,0)),this.commentMap[t.id]=e,r}renderCommentRangeEnd(t){if(!this.options.renderComments)return null;const e=this.commentMap[t.id],r=this.htmlDocument.createComment(`end of comment #${t.id}`);return this.later(()=>e==null?void 0:e.setEnd(r,0)),r}renderCommentReference(t){var p;if(!this.options.renderComments)return null;var e=(p=this.document.commentsPart)==null?void 0:p.commentMap[t.id];if(!e)return null;const r=new DocumentFragment,s=this.createElement("span",{className:`${this.className}-comment-ref`},["💬"]),i=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(e,i),r.appendChild(this.htmlDocument.createComment(`comment #${e.id} by ${e.author} on ${e.date}`)),r.appendChild(s),r.appendChild(i),r}renderCommentContent(t,e){e.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[t.author])),e.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(t.date).toLocaleString()])),this.renderElements(t.children,e)}renderDrawing(t){var e=this.renderContainer(t,"div");return e.style.display="inline-block",e.style.position="relative",e.style.textIndent="0px",this.renderStyleValues(t.cssStyle,e),e}renderImage(t){let e=this.createElement("img");return this.renderStyleValues(t.cssStyle,e),this.document&&this.tasks.push(this.document.loadDocumentImage(t.src,this.currentPart).then(r=>{e.src=r})),e}renderText(t){return this.htmlDocument.createTextNode(t.text)}renderDeletedText(t){return this.options.renderEndnotes?this.htmlDocument.createTextNode(t.text):null}renderBreak(t){return t.break=="textWrapping"?this.createElement("br"):null}renderInserted(t){return this.options.renderChanges?this.renderContainer(t,"ins"):this.renderElements(t.children)}renderDeleted(t){return this.options.renderChanges?this.renderContainer(t,"del"):null}renderSymbol(t){var e=this.createElement("span");return e.style.fontFamily=t.font,e.innerHTML=`&#x${t.char};`,e}renderFootnoteReference(t){var e=this.createElement("sup");return this.currentFootnoteIds.push(t.id),e.textContent=`${this.currentFootnoteIds.length}`,e}renderEndnoteReference(t){var e=this.createElement("sup");return this.currentEndnoteIds.push(t.id),e.textContent=`${this.currentEndnoteIds.length}`,e}renderTab(t){var s;var e=this.createElement("span");if(e.innerHTML="&emsp;",this.options.experimental){e.className=this.tabStopClass();var r=(s=findParent(t,DomType.Paragraph))==null?void 0:s.tabs;this.currentTabs.push({stops:r,span:e})}return e}renderBookmarkStart(t){return this.createElement("span",{id:t.name})}renderRun(t){if(t.fieldRun)return null;const e=this.createElement("span");if(t.id&&(e.id=t.id),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.verticalAlign){const r=this.createElement(t.verticalAlign);this.renderElements(t.children,r),e.appendChild(r)}else this.renderElements(t.children,e);return e}renderTable(t){let e=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},t.columns&&e.appendChild(this.renderTableColumns(t.columns)),this.renderClass(t,e),this.renderElements(t.children,e),this.renderStyleValues(t.cssStyle,e),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),e}renderTableColumns(t){let e=this.createElement("colgroup");for(let r of t){let s=this.createElement("col");r.width&&(s.style.width=r.width),e.appendChild(s)}return e}renderTableRow(t){let e=this.renderContainer(t,"tr");return this.currentCellPosition.col=0,this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),this.currentCellPosition.row++,e}renderTableCell(t){let e=this.renderContainer(t,"td");const r=this.currentCellPosition.col;return t.verticalMerge?t.verticalMerge=="restart"?(this.currentVerticalMerge[r]=e,e.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,e.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.span&&(e.colSpan=t.span),this.currentCellPosition.col+=e.colSpan,e}renderVmlPicture(t){return this.renderContainer(t,"div")}renderVmlElement(t){var s,i;var e=this.createSvgElement("svg");e.setAttribute("style",t.cssStyleText);const r=this.renderVmlChildElement(t);return(s=t.imageHref)!=null&&s.id&&this.tasks.push((i=this.document)==null?void 0:i.loadDocumentImage(t.imageHref.id,this.currentPart).then(p=>r.setAttribute("href",p))),e.appendChild(r),requestAnimationFrame(()=>{const p=e.firstElementChild.getBBox();e.setAttribute("width",`${Math.ceil(p.x+p.width)}`),e.setAttribute("height",`${Math.ceil(p.y+p.height)}`)}),e}renderVmlChildElement(t){const e=this.createSvgElement(t.tagName);Object.entries(t.attrs).forEach(([r,s])=>e.setAttribute(r,s));for(let r of t.children)r.type==DomType.VmlElement?e.appendChild(this.renderVmlChildElement(r)):e.appendChild(...asArray(this.renderElement(r)));return e}renderMmlRadical(t){var s;const e=t.children.find(i=>i.type==DomType.MmlBase);if((s=t.props)!=null&&s.hideDegree)return this.createElementNS(ns.mathML,"msqrt",null,this.renderElements([e]));const r=t.children.find(i=>i.type==DomType.MmlDegree);return this.createElementNS(ns.mathML,"mroot",null,this.renderElements([e,r]))}renderMmlDelimiter(t){const e=[];return e.push(this.createElementNS(ns.mathML,"mo",null,[t.props.beginChar??"("])),e.push(...this.renderElements(t.children)),e.push(this.createElementNS(ns.mathML,"mo",null,[t.props.endChar??")"])),this.createElementNS(ns.mathML,"mrow",null,e)}renderMmlNary(t){var C;const e=[],r=keyBy(t.children,b=>b.type),s=r[DomType.MmlSuperArgument],i=r[DomType.MmlSubArgument],p=s?this.createElementNS(ns.mathML,"mo",null,asArray(this.renderElement(s))):null,g=i?this.createElementNS(ns.mathML,"mo",null,asArray(this.renderElement(i))):null,m=this.createElementNS(ns.mathML,"mo",null,[((C=t.props)==null?void 0:C.char)??"∫"]);return p||g?e.push(this.createElementNS(ns.mathML,"munderover",null,[m,g,p])):p?e.push(this.createElementNS(ns.mathML,"mover",null,[m,p])):g?e.push(this.createElementNS(ns.mathML,"munder",null,[m,g])):e.push(m),e.push(...this.renderElements(r[DomType.MmlBase].children)),this.createElementNS(ns.mathML,"mrow",null,e)}renderMmlPreSubSuper(t){const e=[],r=keyBy(t.children,C=>C.type),s=r[DomType.MmlSuperArgument],i=r[DomType.MmlSubArgument],p=s?this.createElementNS(ns.mathML,"mo",null,asArray(this.renderElement(s))):null,g=i?this.createElementNS(ns.mathML,"mo",null,asArray(this.renderElement(i))):null,m=this.createElementNS(ns.mathML,"mo",null);return e.push(this.createElementNS(ns.mathML,"msubsup",null,[m,g,p])),e.push(...this.renderElements(r[DomType.MmlBase].children)),this.createElementNS(ns.mathML,"mrow",null,e)}renderMmlGroupChar(t){const e=t.props.verticalJustification==="bot"?"mover":"munder",r=this.renderContainerNS(t,ns.mathML,e);return t.props.char&&r.appendChild(this.createElementNS(ns.mathML,"mo",null,[t.props.char])),r}renderMmlBar(t){const e=this.renderContainerNS(t,ns.mathML,"mrow");switch(t.props.position){case"top":e.style.textDecoration="overline";break;case"bottom":e.style.textDecoration="underline";break}return e}renderMmlRun(t){const e=this.createElementNS(ns.mathML,"ms",null,this.renderElements(t.children));return this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),e}renderMllList(t){const e=this.createElementNS(ns.mathML,"mtable");this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e);for(let r of this.renderElements(t.children))e.appendChild(this.createElementNS(ns.mathML,"mtr",null,[this.createElementNS(ns.mathML,"mtd",null,[r])]));return e}renderStyleValues(t,e){for(let r in t)r.startsWith("$")?e.setAttribute(r.slice(1),t[r]):e.style[r]=t[r]}renderClass(t,e){t.className&&(e.className=t.className),t.styleName&&e.classList.add(this.processStyleName(t.styleName))}findStyle(t){var e;return t&&((e=this.styleMap)==null?void 0:e[t])}numberingClass(t,e){return`${this.className}-num-${t}-${e}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(t,e,r=null){let s=`${t} {\r
`;for(const i in e)i.startsWith("$")||(s+=`  ${i}: ${e[i]};\r
`);return r&&(s+=r),s+`}\r
`}numberingCounter(t,e){return`${this.className}-num-${t}-${e}`}levelTextToContent(t,e,r,s){const i={tab:"\\9",space:"\\a0"};var p=t.replace(/%\d*/g,g=>{let m=parseInt(g.substring(1),10)-1;return`"counter(${this.numberingCounter(r,m)}, ${s})"`});return`"${p}${i[e]??""}"`}numFormatToCssValue(t){var e={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"};return e[t]??t}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const t=computePixelToPoint();for(let e of this.currentTabs)updateTabStop(e.span,e.stops,this.defaultTabSize,t)},500)}createElementNS(t,e,r,s){var i=t?this.htmlDocument.createElementNS(t,e):this.htmlDocument.createElement(e);return Object.assign(i,r),s&&appendChildren(i,s),i}createElement(t,e,r){return this.createElementNS(void 0,t,e,r)}createSvgElement(t,e,r){return this.createElementNS(ns.svg,t,e,r)}createStyleElement(t){return this.createElement("style",{innerHTML:t})}createComment(t){return this.htmlDocument.createComment(t)}later(t){this.postRenderTasks.push(t)}}function removeAllElements(x){x.innerHTML=""}function appendChildren(x,t){t.forEach(e=>x.appendChild(isString(e)?document.createTextNode(e):e))}function findParent(x,t){for(var e=x.parent;e!=null&&e.type!=t;)e=e.parent;return e}const defaultOptions={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1};function parseAsync(x,t){const e={...defaultOptions,...t};return WordDocument.load(x,new DocumentParser(e),e)}async function renderDocument(x,t,e,r){const s={...defaultOptions,...r};return await new HtmlRenderer(window.document).render(x,t,e,s)}async function renderAsync(x,t,e,r){const s=await parseAsync(x,r);return await renderDocument(s,t,e,r),s}const DocxViewer_svelte_svelte_type_style_lang="";function create_fragment$3(x){let t,e;return{c(){t=element("div"),e=element("div"),this.h()},l(r){t=claim_element(r,"DIV",{class:!0});var s=children(t);e=claim_element(s,"DIV",{class:!0}),children(e).forEach(detach),s.forEach(detach),this.h()},h(){attr(e,"class","doc-wrapper svelte-7cvbjd"),attr(t,"class","doc-container svelte-7cvbjd")},m(r,s){insert_hydration(r,t,s),append_hydration(t,e),x[2](e)},p:noop,i:noop,o:noop,d(r){r&&detach(t),x[2](null)}}}function instance$3(x,t,e){let{url:r=""}=t,s;async function i(g){const C=await(await fetch(g)).arrayBuffer();await renderAsync(C,s)}onMount(()=>{i(r)});function p(g){binding_callbacks[g?"unshift":"push"](()=>{s=g,e(0,s)})}return x.$$set=g=>{"url"in g&&e(1,r=g.url)},[s,r,p]}class DocxViewer extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$3,safe_not_equal,{url:1})}}var papaparse_min={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(x,t){(function(e,r){x.exports=r()})(commonjsGlobal,function e(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,p={},g=0,m={parse:function(l,h){var I=(h=h||{}).dynamicTyping||!1;if(y(I)&&(h.dynamicTypingFunction=I,I={}),h.dynamicTyping=I,h.transform=!!y(h.transform)&&h.transform,h.worker&&m.WORKERS_SUPPORTED){var k=function(){if(!m.WORKERS_SUPPORTED)return!1;var U=(V=r.URL||r.webkitURL||null,lt=e.toString(),m.BLOB_URL||(m.BLOB_URL=V.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",lt,")();"],{type:"text/javascript"})))),_=new r.Worker(U),V,lt;return _.onmessage=R,_.id=g++,p[_.id]=_}();return k.userStep=h.step,k.userChunk=h.chunk,k.userComplete=h.complete,k.userError=h.error,h.step=y(h.step),h.chunk=y(h.chunk),h.complete=y(h.complete),h.error=y(h.error),delete h.worker,void k.postMessage({input:l,config:h,workerId:k.id})}var T=null;return m.NODE_STREAM_INPUT,typeof l=="string"?(l=function(U){return U.charCodeAt(0)===65279?U.slice(1):U}(l),T=h.download?new M(h):new d(h)):l.readable===!0&&y(l.read)&&y(l.on)?T=new f(h):(r.File&&l instanceof File||l instanceof Object)&&(T=new S(h)),T.stream(l)},unparse:function(l,h){var I=!1,k=!0,T=",",U=`\r
`,_='"',V=_+_,lt=!1,J=null,ct=!1;(function(){if(typeof h=="object"){if(typeof h.delimiter!="string"||m.BAD_DELIMITERS.filter(function(B){return h.delimiter.indexOf(B)!==-1}).length||(T=h.delimiter),(typeof h.quotes=="boolean"||typeof h.quotes=="function"||Array.isArray(h.quotes))&&(I=h.quotes),typeof h.skipEmptyLines!="boolean"&&typeof h.skipEmptyLines!="string"||(lt=h.skipEmptyLines),typeof h.newline=="string"&&(U=h.newline),typeof h.quoteChar=="string"&&(_=h.quoteChar),typeof h.header=="boolean"&&(k=h.header),Array.isArray(h.columns)){if(h.columns.length===0)throw new Error("Option columns is empty");J=h.columns}h.escapeChar!==void 0&&(V=h.escapeChar+_),(typeof h.escapeFormulae=="boolean"||h.escapeFormulae instanceof RegExp)&&(ct=h.escapeFormulae instanceof RegExp?h.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var et=new RegExp(a(_),"g");if(typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(l)){if(!l.length||Array.isArray(l[0]))return pt(null,l,lt);if(typeof l[0]=="object")return pt(J||Object.keys(l[0]),l,lt)}else if(typeof l=="object")return typeof l.data=="string"&&(l.data=JSON.parse(l.data)),Array.isArray(l.data)&&(l.fields||(l.fields=l.meta&&l.meta.fields||J),l.fields||(l.fields=Array.isArray(l.data[0])?l.fields:typeof l.data[0]=="object"?Object.keys(l.data[0]):[]),Array.isArray(l.data[0])||typeof l.data[0]=="object"||(l.data=[l.data])),pt(l.fields||[],l.data||[],lt);throw new Error("Unable to serialize unrecognized input");function pt(B,O,D){var N="";typeof B=="string"&&(B=JSON.parse(B)),typeof O=="string"&&(O=JSON.parse(O));var G=Array.isArray(B)&&0<B.length,H=!Array.isArray(O[0]);if(G&&k){for(var Z=0;Z<B.length;Z++)0<Z&&(N+=T),N+=at(B[Z],Z);0<O.length&&(N+=U)}for(var $=0;$<O.length;$++){var ot=G?B.length:O[$].length,it=!1,Y=G?Object.keys(O[$]).length===0:O[$].length===0;if(D&&!G&&(it=D==="greedy"?O[$].join("").trim()==="":O[$].length===1&&O[$][0].length===0),D==="greedy"&&G){for(var W=[],n=0;n<ot;n++){var v=H?B[n]:n;W.push(O[$][v])}it=W.join("").trim()===""}if(!it){for(var P=0;P<ot;P++){0<P&&!Y&&(N+=T);var A=G&&H?B[P]:P;N+=at(O[$][A],P)}$<O.length-1&&(!D||0<ot&&!Y)&&(N+=U)}}return N}function at(B,O){if(B==null)return"";if(B.constructor===Date)return JSON.stringify(B).slice(1,25);var D=!1;ct&&typeof B=="string"&&ct.test(B)&&(B="'"+B,D=!0);var N=B.toString().replace(et,V);return(D=D||I===!0||typeof I=="function"&&I(B,O)||Array.isArray(I)&&I[O]||function(G,H){for(var Z=0;Z<H.length;Z++)if(-1<G.indexOf(H[Z]))return!0;return!1}(N,m.BAD_DELIMITERS)||-1<N.indexOf(T)||N.charAt(0)===" "||N.charAt(N.length-1)===" ")?_+N+_:N}}};if(m.RECORD_SEP=String.fromCharCode(30),m.UNIT_SEP=String.fromCharCode(31),m.BYTE_ORDER_MARK="\uFEFF",m.BAD_DELIMITERS=["\r",`
`,'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!s&&!!r.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=o,m.ParserHandle=c,m.NetworkStreamer=M,m.FileStreamer=S,m.StringStreamer=d,m.ReadableStreamStreamer=f,r.jQuery){var C=r.jQuery;C.fn.parse=function(l){var h=l.config||{},I=[];return this.each(function(U){if(!(C(this).prop("tagName").toUpperCase()==="INPUT"&&C(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var _=0;_<this.files.length;_++)I.push({file:this.files[_],inputElem:this,instanceConfig:C.extend({},h)})}),k(),this;function k(){if(I.length!==0){var U,_,V,lt,J=I[0];if(y(l.before)){var ct=l.before(J.file,J.inputElem);if(typeof ct=="object"){if(ct.action==="abort")return U="AbortError",_=J.file,V=J.inputElem,lt=ct.reason,void(y(l.error)&&l.error({name:U},_,V,lt));if(ct.action==="skip")return void T();typeof ct.config=="object"&&(J.instanceConfig=C.extend(J.instanceConfig,ct.config))}else if(ct==="skip")return void T()}var et=J.instanceConfig.complete;J.instanceConfig.complete=function(pt){y(et)&&et(pt,J.file,J.inputElem),T()},m.parse(J.file,J.instanceConfig)}else y(l.complete)&&l.complete()}function T(){I.splice(0,1),k()}}}function b(l){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(h){var I=u(h);I.chunkSize=parseInt(I.chunkSize),h.step||h.chunk||(I.chunkSize=null),this._handle=new c(I),(this._handle.streamer=this)._config=I}.call(this,l),this.parseChunk=function(h,I){if(this.isFirstChunk&&y(this._config.beforeFirstChunk)){var k=this._config.beforeFirstChunk(h);k!==void 0&&(h=k)}this.isFirstChunk=!1,this._halted=!1;var T=this._partialLine+h;this._partialLine="";var U=this._handle.parse(T,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var _=U.meta.cursor;this._finished||(this._partialLine=T.substring(_-this._baseIndex),this._baseIndex=_),U&&U.data&&(this._rowCount+=U.data.length);var V=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)r.postMessage({results:U,workerId:m.WORKER_ID,finished:V});else if(y(this._config.chunk)&&!I){if(this._config.chunk(U,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);U=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(U.data),this._completeResults.errors=this._completeResults.errors.concat(U.errors),this._completeResults.meta=U.meta),this._completed||!V||!y(this._config.complete)||U&&U.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),V||U&&U.meta.paused||this._nextChunk(),U}this._halted=!0},this._sendError=function(h){y(this._config.error)?this._config.error(h):i&&this._config.error&&r.postMessage({workerId:m.WORKER_ID,error:h,finished:!1})}}function M(l){var h;(l=l||{}).chunkSize||(l.chunkSize=m.RemoteChunkSize),b.call(this,l),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(h=new XMLHttpRequest,this._config.withCredentials&&(h.withCredentials=this._config.withCredentials),s||(h.onload=w(this._chunkLoaded,this),h.onerror=w(this._chunkError,this)),h.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var I=this._config.downloadRequestHeaders;for(var k in I)h.setRequestHeader(k,I[k])}if(this._config.chunkSize){var T=this._start+this._config.chunkSize-1;h.setRequestHeader("Range","bytes="+this._start+"-"+T)}try{h.send(this._config.downloadRequestBody)}catch(U){this._chunkError(U.message)}s&&h.status===0&&this._chunkError()}},this._chunkLoaded=function(){h.readyState===4&&(h.status<200||400<=h.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:h.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(I){var k=I.getResponseHeader("Content-Range");return k===null?-1:parseInt(k.substring(k.lastIndexOf("/")+1))}(h),this.parseChunk(h.responseText)))},this._chunkError=function(I){var k=h.statusText||I;this._sendError(new Error(k))}}function S(l){var h,I;(l=l||{}).chunkSize||(l.chunkSize=m.LocalChunkSize),b.call(this,l);var k=typeof FileReader<"u";this.stream=function(T){this._input=T,I=T.slice||T.webkitSlice||T.mozSlice,k?((h=new FileReader).onload=w(this._chunkLoaded,this),h.onerror=w(this._chunkError,this)):h=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input;if(this._config.chunkSize){var U=Math.min(this._start+this._config.chunkSize,this._input.size);T=I.call(T,this._start,U)}var _=h.readAsText(T,this._config.encoding);k||this._chunkLoaded({target:{result:_}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(h.error)}}function d(l){var h;b.call(this,l=l||{}),this.stream=function(I){return h=I,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var I,k=this._config.chunkSize;return k?(I=h.substring(0,k),h=h.substring(k)):(I=h,h=""),this._finished=!h,this.parseChunk(I)}}}function f(l){b.call(this,l=l||{});var h=[],I=!0,k=!1;this.pause=function(){b.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){b.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&h.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),h.length?this.parseChunk(h.shift()):I=!0},this._streamData=w(function(T){try{h.push(typeof T=="string"?T:T.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(h.shift()))}catch(U){this._streamError(U)}},this),this._streamError=w(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=w(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function c(l){var h,I,k,T=Math.pow(2,53),U=-T,_=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,V=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,lt=this,J=0,ct=0,et=!1,pt=!1,at=[],B={data:[],errors:[],meta:{}};if(y(l.step)){var O=l.step;l.step=function($){if(B=$,G())N();else{if(N(),B.data.length===0)return;J+=$.data.length,l.preview&&J>l.preview?I.abort():(B.data=B.data[0],O(B,lt))}}}function D($){return l.skipEmptyLines==="greedy"?$.join("").trim()==="":$.length===1&&$[0].length===0}function N(){return B&&k&&(Z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),k=!1),l.skipEmptyLines&&(B.data=B.data.filter(function($){return!D($)})),G()&&function(){if(!B)return;function $(it,Y){y(l.transformHeader)&&(it=l.transformHeader(it,Y)),at.push(it)}if(Array.isArray(B.data[0])){for(var ot=0;G()&&ot<B.data.length;ot++)B.data[ot].forEach($);B.data.splice(0,1)}else B.data.forEach($)}(),function(){if(!B||!l.header&&!l.dynamicTyping&&!l.transform)return B;function $(it,Y){var W,n=l.header?{}:[];for(W=0;W<it.length;W++){var v=W,P=it[W];l.header&&(v=W>=at.length?"__parsed_extra":at[W]),l.transform&&(P=l.transform(P,v)),P=H(v,P),v==="__parsed_extra"?(n[v]=n[v]||[],n[v].push(P)):n[v]=P}return l.header&&(W>at.length?Z("FieldMismatch","TooManyFields","Too many fields: expected "+at.length+" fields but parsed "+W,ct+Y):W<at.length&&Z("FieldMismatch","TooFewFields","Too few fields: expected "+at.length+" fields but parsed "+W,ct+Y)),n}var ot=1;return!B.data.length||Array.isArray(B.data[0])?(B.data=B.data.map($),ot=B.data.length):B.data=$(B.data,0),l.header&&B.meta&&(B.meta.fields=at),ct+=ot,B}()}function G(){return l.header&&at.length===0}function H($,ot){return it=$,l.dynamicTypingFunction&&l.dynamicTyping[it]===void 0&&(l.dynamicTyping[it]=l.dynamicTypingFunction(it)),(l.dynamicTyping[it]||l.dynamicTyping)===!0?ot==="true"||ot==="TRUE"||ot!=="false"&&ot!=="FALSE"&&(function(Y){if(_.test(Y)){var W=parseFloat(Y);if(U<W&&W<T)return!0}return!1}(ot)?parseFloat(ot):V.test(ot)?new Date(ot):ot===""?null:ot):ot;var it}function Z($,ot,it,Y){var W={type:$,code:ot,message:it};Y!==void 0&&(W.row=Y),B.errors.push(W)}this.parse=function($,ot,it){var Y=l.quoteChar||'"';if(l.newline||(l.newline=function(v,P){v=v.substring(0,1048576);var A=new RegExp(a(P)+"([^]*?)"+a(P),"gm"),E=(v=v.replace(A,"")).split("\r"),j=v.split(`
`),Q=1<j.length&&j[0].length<E[0].length;if(E.length===1||Q)return`
`;for(var K=0,X=0;X<E.length;X++)E[X][0]===`
`&&K++;return K>=E.length/2?`\r
`:"\r"}($,Y)),k=!1,l.delimiter)y(l.delimiter)&&(l.delimiter=l.delimiter($),B.meta.delimiter=l.delimiter);else{var W=function(v,P,A,E,j){var Q,K,X,rt;j=j||[",","	","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var ht=0;ht<j.length;ht++){var st=j[ht],dt=0,mt=0,At=0;X=void 0;for(var yt=new o({comments:E,delimiter:st,newline:P,preview:10}).parse(v),wt=0;wt<yt.data.length;wt++)if(A&&D(yt.data[wt]))At++;else{var q=yt.data[wt].length;mt+=q,X!==void 0?0<q&&(dt+=Math.abs(q-X),X=q):X=q}0<yt.data.length&&(mt/=yt.data.length-At),(K===void 0||dt<=K)&&(rt===void 0||rt<mt)&&1.99<mt&&(K=dt,Q=st,rt=mt)}return{successful:!!(l.delimiter=Q),bestDelimiter:Q}}($,l.newline,l.skipEmptyLines,l.comments,l.delimitersToGuess);W.successful?l.delimiter=W.bestDelimiter:(k=!0,l.delimiter=m.DefaultDelimiter),B.meta.delimiter=l.delimiter}var n=u(l);return l.preview&&l.header&&n.preview++,h=$,I=new o(n),B=I.parse(h,ot,it),N(),et?{meta:{paused:!0}}:B||{meta:{paused:!1}}},this.paused=function(){return et},this.pause=function(){et=!0,I.abort(),h=y(l.chunk)?"":h.substring(I.getCharIndex())},this.resume=function(){lt.streamer._halted?(et=!1,lt.streamer.parseChunk(h,!0)):setTimeout(lt.resume,3)},this.aborted=function(){return pt},this.abort=function(){pt=!0,I.abort(),B.meta.aborted=!0,y(l.complete)&&l.complete(B),h=""}}function a(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(l){var h,I=(l=l||{}).delimiter,k=l.newline,T=l.comments,U=l.step,_=l.preview,V=l.fastMode,lt=h=l.quoteChar===void 0||l.quoteChar===null?'"':l.quoteChar;if(l.escapeChar!==void 0&&(lt=l.escapeChar),(typeof I!="string"||-1<m.BAD_DELIMITERS.indexOf(I))&&(I=","),T===I)throw new Error("Comment character same as delimiter");T===!0?T="#":(typeof T!="string"||-1<m.BAD_DELIMITERS.indexOf(T))&&(T=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var J=0,ct=!1;this.parse=function(et,pt,at){if(typeof et!="string")throw new Error("Input must be a string");var B=et.length,O=I.length,D=k.length,N=T.length,G=y(U),H=[],Z=[],$=[],ot=J=0;if(!et)return nt();if(l.header&&!pt){var it=et.split(k)[0].split(I),Y=[],W={},n=!1;for(var v in it){var P=it[v];y(l.transformHeader)&&(P=l.transformHeader(P,v));var A=P,E=W[P]||0;for(0<E&&(n=!0,A=P+"_"+E),W[P]=E+1;Y.includes(A);)A=A+"_"+E;Y.push(A)}if(n){var j=et.split(k);j[0]=Y.join(I),et=j.join(k)}}if(V||V!==!1&&et.indexOf(h)===-1){for(var Q=et.split(k),K=0;K<Q.length;K++){if($=Q[K],J+=$.length,K!==Q.length-1)J+=k.length;else if(at)return nt();if(!T||$.substring(0,N)!==T){if(G){if(H=[],At($.split(I)),tt(),ct)return nt()}else At($.split(I));if(_&&_<=K)return H=H.slice(0,_),nt(!0)}}return nt()}for(var X=et.indexOf(I,J),rt=et.indexOf(k,J),ht=new RegExp(a(lt)+a(h),"g"),st=et.indexOf(h,J);;)if(et[J]!==h)if(T&&$.length===0&&et.substring(J,J+N)===T){if(rt===-1)return nt();J=rt+D,rt=et.indexOf(k,J),X=et.indexOf(I,J)}else if(X!==-1&&(X<rt||rt===-1))$.push(et.substring(J,X)),J=X+O,X=et.indexOf(I,J);else{if(rt===-1)break;if($.push(et.substring(J,rt)),q(rt+D),G&&(tt(),ct))return nt();if(_&&H.length>=_)return nt(!0)}else for(st=J,J++;;){if((st=et.indexOf(h,st+1))===-1)return at||Z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:H.length,index:J}),wt();if(st===B-1)return wt(et.substring(J,st).replace(ht,h));if(h!==lt||et[st+1]!==lt){if(h===lt||st===0||et[st-1]!==lt){X!==-1&&X<st+1&&(X=et.indexOf(I,st+1)),rt!==-1&&rt<st+1&&(rt=et.indexOf(k,st+1));var dt=yt(rt===-1?X:Math.min(X,rt));if(et.substr(st+1+dt,O)===I){$.push(et.substring(J,st).replace(ht,h)),et[J=st+1+dt+O]!==h&&(st=et.indexOf(h,J)),X=et.indexOf(I,J),rt=et.indexOf(k,J);break}var mt=yt(rt);if(et.substring(st+1+mt,st+1+mt+D)===k){if($.push(et.substring(J,st).replace(ht,h)),q(st+1+mt+D),X=et.indexOf(I,J),st=et.indexOf(h,J),G&&(tt(),ct))return nt();if(_&&H.length>=_)return nt(!0);break}Z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:H.length,index:J}),st++}}else st++}return wt();function At(_t){H.push(_t),ot=J}function yt(_t){var Et=0;if(_t!==-1){var ut=et.substring(st+1,_t);ut&&ut.trim()===""&&(Et=ut.length)}return Et}function wt(_t){return at||(_t===void 0&&(_t=et.substring(J)),$.push(_t),J=B,At($),G&&tt()),nt()}function q(_t){J=_t,At($),$=[],rt=et.indexOf(k,J)}function nt(_t){return{data:H,errors:Z,meta:{delimiter:I,linebreak:k,aborted:ct,truncated:!!_t,cursor:ot+(pt||0)}}}function tt(){U(nt()),H=[],Z=[]}},this.abort=function(){ct=!0},this.getCharIndex=function(){return J}}function R(l){var h=l.data,I=p[h.workerId],k=!1;if(h.error)I.userError(h.error,h.file);else if(h.results&&h.results.data){var T={abort:function(){k=!0,L(h.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(y(I.userStep)){for(var U=0;U<h.results.data.length&&(I.userStep({data:h.results.data[U],errors:h.results.errors,meta:h.results.meta},T),!k);U++);delete h.results}else y(I.userChunk)&&(I.userChunk(h.results,T,h.file),delete h.results)}h.finished&&!k&&L(h.workerId,h.results)}function L(l,h){var I=p[l];y(I.userComplete)&&I.userComplete(h),I.terminate(),delete p[l]}function F(){throw new Error("Not implemented.")}function u(l){if(typeof l!="object"||l===null)return l;var h=Array.isArray(l)?[]:{};for(var I in l)h[I]=u(l[I]);return h}function w(l,h){return function(){l.apply(h,arguments)}}function y(l){return typeof l=="function"}return i&&(r.onmessage=function(l){var h=l.data;if(m.WORKER_ID===void 0&&h&&(m.WORKER_ID=h.workerId),typeof h.input=="string")r.postMessage({workerId:m.WORKER_ID,results:m.parse(h.input,h.config),finished:!0});else if(r.File&&h.input instanceof File||h.input instanceof Object){var I=m.parse(h.input,h.config);I&&r.postMessage({workerId:m.WORKER_ID,results:I,finished:!0})}}),(M.prototype=Object.create(b.prototype)).constructor=M,(S.prototype=Object.create(b.prototype)).constructor=S,(d.prototype=Object.create(d.prototype)).constructor=d,(f.prototype=Object.create(b.prototype)).constructor=f,m})})(papaparse_min);var papaparse_minExports=papaparse_min.exports;const Papa=getDefaultExportFromCjs(papaparse_minExports),CsvViewer_svelte_svelte_type_style_lang="";function get_each_context(x,t,e){const r=x.slice();return r[3]=t[e],r}function get_each_context_1(x,t,e){const r=x.slice();return r[6]=t[e],r}function create_each_block_1(x){let t,e=x[6]+"",r;return{c(){t=element("td"),r=text(e),this.h()},l(s){t=claim_element(s,"TD",{class:!0});var i=children(t);r=claim_text(i,e),i.forEach(detach),this.h()},h(){attr(t,"class","svelte-jrjmna")},m(s,i){insert_hydration(s,t,i),append_hydration(t,r)},p(s,i){i&1&&e!==(e=s[6]+"")&&set_data(r,e)},d(s){s&&detach(t)}}}function create_each_block(x){let t,e,r=x[3],s=[];for(let i=0;i<r.length;i+=1)s[i]=create_each_block_1(get_each_context_1(x,r,i));return{c(){t=element("tr");for(let i=0;i<s.length;i+=1)s[i].c();e=space(),this.h()},l(i){t=claim_element(i,"TR",{class:!0});var p=children(t);for(let g=0;g<s.length;g+=1)s[g].l(p);e=claim_space(p),p.forEach(detach),this.h()},h(){attr(t,"class","svelte-jrjmna")},m(i,p){insert_hydration(i,t,p);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(t,null);append_hydration(t,e)},p(i,p){if(p&1){r=i[3];let g;for(g=0;g<r.length;g+=1){const m=get_each_context_1(i,r,g);s[g]?s[g].p(m,p):(s[g]=create_each_block_1(m),s[g].c(),s[g].m(t,e))}for(;g<s.length;g+=1)s[g].d(1);s.length=r.length}},d(i){i&&detach(t),destroy_each(s,i)}}}function create_fragment$2(x){let t,e,r=x[0],s=[];for(let i=0;i<r.length;i+=1)s[i]=create_each_block(get_each_context(x,r,i));return{c(){t=element("div"),e=element("table");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){t=claim_element(i,"DIV",{class:!0});var p=children(t);e=claim_element(p,"TABLE",{class:!0});var g=children(e);for(let m=0;m<s.length;m+=1)s[m].l(g);g.forEach(detach),p.forEach(detach),this.h()},h(){attr(e,"class","csv-wrapper svelte-jrjmna"),attr(t,"class","csv-container svelte-jrjmna")},m(i,p){insert_hydration(i,t,p),append_hydration(t,e);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(e,null)},p(i,[p]){if(p&1){r=i[0];let g;for(g=0;g<r.length;g+=1){const m=get_each_context(i,r,g);s[g]?s[g].p(m,p):(s[g]=create_each_block(m),s[g].c(),s[g].m(e,null))}for(;g<s.length;g+=1)s[g].d(1);s.length=r.length}},i:noop,o:noop,d(i){i&&detach(t),destroy_each(s,i)}}}function instance$2(x,t,e){let{url:r=""}=t,s=[];async function i(p){const m=await(await fetch(p)).text(),C=Papa.parse(m,{header:!1});e(0,s=C.data)}return onMount(()=>{i(r)}),x.$$set=p=>{"url"in p&&e(1,r=p.url)},[s,r]}class CsvViewer extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$2,safe_not_equal,{url:1})}}const TxtViewer_svelte_svelte_type_style_lang="";function create_fragment$1(x){let t,e,r;return{c(){t=element("div"),e=element("pre"),r=text(x[0]),this.h()},l(s){t=claim_element(s,"DIV",{class:!0});var i=children(t);e=claim_element(i,"PRE",{class:!0});var p=children(e);r=claim_text(p,x[0]),p.forEach(detach),i.forEach(detach),this.h()},h(){attr(e,"class","txt-wrapper svelte-18317ie"),attr(t,"class","txt-container svelte-18317ie")},m(s,i){insert_hydration(s,t,i),append_hydration(t,e),append_hydration(e,r)},p(s,[i]){i&1&&set_data(r,s[0])},i:noop,o:noop,d(s){s&&detach(t)}}}function instance$1(x,t,e){let{url:r=""}=t,s="";async function i(p){const g=await fetch(p);e(0,s=await g.text())}return onMount(()=>{i(r)}),x.$$set=p=>{"url"in p&&e(1,r=p.url)},[s,r]}class TxtViewer extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{url:1})}}function create_if_block_5(x){let t=x[0].error+"",e;return{c(){e=text(t)},l(r){e=claim_text(r,t)},m(r,s){insert_hydration(r,e,s)},p(r,s){s&1&&t!==(t=r[0].error+"")&&set_data(e,t)},d(r){r&&detach(e)}}}function create_if_block(x){let t,e,r,s,i,p,g,m;r=new ChatPanel({props:{documentId:x[1].id,onSubmit:x[4]}});const C=[create_if_block_1,create_if_block_2,create_if_block_3,create_if_block_4,create_else_block],b=[];function M(S,d){return S[3]==="pdf"?0:S[3]==="docx"?1:S[3]==="csv"?2:S[3]==="txt"?3:4}return p=M(x),g=b[p]=C[p](x),{c(){t=element("div"),e=element("div"),create_component(r.$$.fragment),s=space(),i=element("div"),g.c(),this.h()},l(S){t=claim_element(S,"DIV",{class:!0,style:!0});var d=children(t);e=claim_element(d,"DIV",{class:!0});var f=children(e);claim_component(r.$$.fragment,f),f.forEach(detach),s=claim_space(d),i=claim_element(d,"DIV",{class:!0});var c=children(i);g.l(c),c.forEach(detach),d.forEach(detach),this.h()},h(){attr(e,"class","col-span-1"),attr(i,"class","col-span-2"),attr(t,"class","grid grid-cols-3 gap-2"),set_style(t,"height","calc(100vh - 80px)")},m(S,d){insert_hydration(S,t,d),append_hydration(t,e),mount_component(r,e,null),append_hydration(t,s),append_hydration(t,i),b[p].m(i,null),m=!0},p(S,d){g.p(S,d)},i(S){m||(transition_in(r.$$.fragment,S),transition_in(g),m=!0)},o(S){transition_out(r.$$.fragment,S),transition_out(g),m=!1},d(S){S&&detach(t),destroy_component(r),b[p].d()}}}function create_else_block(x){let t,e,r;return{c(){t=element("p"),e=text("Unsupported file type: "),r=text(x[3])},l(s){t=claim_element(s,"P",{});var i=children(t);e=claim_text(i,"Unsupported file type: "),r=claim_text(i,x[3]),i.forEach(detach)},m(s,i){insert_hydration(s,t,i),append_hydration(t,e),append_hydration(t,r)},p:noop,i:noop,o:noop,d(s){s&&detach(t)}}}function create_if_block_4(x){let t,e;return t=new TxtViewer({props:{url:x[2]}}),{c(){create_component(t.$$.fragment)},l(r){claim_component(t.$$.fragment,r)},m(r,s){mount_component(t,r,s),e=!0},p:noop,i(r){e||(transition_in(t.$$.fragment,r),e=!0)},o(r){transition_out(t.$$.fragment,r),e=!1},d(r){destroy_component(t,r)}}}function create_if_block_3(x){let t,e;return t=new CsvViewer({props:{url:x[2]}}),{c(){create_component(t.$$.fragment)},l(r){claim_component(t.$$.fragment,r)},m(r,s){mount_component(t,r,s),e=!0},p:noop,i(r){e||(transition_in(t.$$.fragment,r),e=!0)},o(r){transition_out(t.$$.fragment,r),e=!1},d(r){destroy_component(t,r)}}}function create_if_block_2(x){let t,e;return t=new DocxViewer({props:{url:x[2]}}),{c(){create_component(t.$$.fragment)},l(r){claim_component(t.$$.fragment,r)},m(r,s){mount_component(t,r,s),e=!0},p:noop,i(r){e||(transition_in(t.$$.fragment,r),e=!0)},o(r){transition_out(t.$$.fragment,r),e=!1},d(r){destroy_component(t,r)}}}function create_if_block_1(x){let t,e;return t=new PdfViewer({props:{url:x[2]}}),{c(){create_component(t.$$.fragment)},l(r){claim_component(t.$$.fragment,r)},m(r,s){mount_component(t,r,s),e=!0},p:noop,i(r){e||(transition_in(t.$$.fragment,r),e=!0)},o(r){transition_out(t.$$.fragment,r),e=!1},d(r){destroy_component(t,r)}}}function create_fragment(x){let t,e,r,s=x[0].error&&create_if_block_5(x),i=x[1]&&create_if_block(x);return{c(){s&&s.c(),t=space(),i&&i.c(),e=empty()},l(p){s&&s.l(p),t=claim_space(p),i&&i.l(p),e=empty()},m(p,g){s&&s.m(p,g),insert_hydration(p,t,g),i&&i.m(p,g),insert_hydration(p,e,g),r=!0},p(p,[g]){p[0].error?s?s.p(p,g):(s=create_if_block_5(p),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null),p[1]&&i.p(p,g)},i(p){r||(transition_in(i),r=!0)},o(p){transition_out(i),r=!1},d(p){s&&s.d(p),p&&detach(t),i&&i.d(p),p&&detach(e)}}}function instance(x,t,e){let{data:r}=t;const s=r.document,i=r.documentUrl,p=r.documentType;console.log("Document Type:",p);function g(m,C){sendMessage({role:"user",content:m},{useStreaming:C,documentId:s.id})}return beforeNavigate(resetAll),x.$$set=m=>{"data"in m&&e(0,r=m.data)},[r,s,i,p,g]}class Page extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{data:0})}}export{Page as default};
